<!DOCTYPE html>
<html lang="zh-CN"><head>

    <!-- Socket.IO - 使用本地缓存，后端自动获取最新版本 -->
    <script src="/api/cdn/socketio" onerror="this.src='https://cdn.socket.io/4.8.1/socket.io.min.js'"></script>
    <meta charset="UTF-8">
    <title>跑步助手</title>
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- TailwindCSS - 使用本地缓存 -->
    <script src="/api/cdn/tailwindcss" onerror="this.src='https://cdn.tailwindcss.com'"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <!-- Google Fonts - 使用本地缓存 -->
    <link href="/api/cdn/google-fonts" rel="stylesheet" onerror="this.href='https://fonts.googleapis.com/css2?family=Zilla+Slab:wght@600;700&amp;family=Noto+Sans+SC:wght@400;600;700&amp;display=swap'">

    <!-- 高德地图 loader.js - 使用本地缓存 -->
    <script src="/api/cdn/amap-loader" onerror="this.src='https://webapi.amap.com/loader.js'"></script>
    <!-- 使用本地缓存的CDN文件，后端每小时自动从CDN更新 -->
    <script src="/api/cdn/sweetalert2" onerror="this.src='https://cdn.jsdelivr.net/npm/sweetalert2@11'"></script>
    <script src="/api/cdn/qrcode" onerror="this.src='https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js'"></script>
    <link rel="stylesheet" href="/api/cdn/cropperjs-css" onerror="this.href='https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.css'">
    <script src="/api/cdn/cropperjs" onerror="this.src='https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.js'"></script>
      
      <!-- Extracted Style -->
      <link rel="stylesheet" href="styles/style.css">
  </head>

  <body class="text-slate-800 font-sans h-screen overflow-hidden antialiased">
    <div id="admin-return-overlay" class="fixed top-4 left-4 z-[10000] hidden" style="touch-action: none; user-select: none">
      <button id="admin-return-btn" class="flex items-center gap-2 px-4 py-2 bg-slate-800/90 text-white rounded-full shadow-xl border border-slate-600 backdrop-blur-sm hover:bg-slate-700 transition-colors font-bold text-sm cursor-move">
        <!-- <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
            </svg> -->
        <span>返回管理员会话</span>
      </button>
    </div>

    <button id="exit-app-btn" class="fixed bottom-4 right-4 z-[9999] btn btn-ghost !py-2 !px-4 bg-white/80 backdrop-blur-sm shadow-lg hover:bg-red-50 hover:text-red-600 transition-all duration-300 rounded-xl border border-slate-200 touch-none select-none" title="退出应用">
      <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
      </svg>
      退出应用
    </button>

    <div id="cdn-error-overlay" class="fixed inset-0 z-9999 hidden flex-col items-center justify-center bg-[#f8fafc] p-8 text-center text-[#475569]" style="font-family: sans-serif">
      <div style="max-width: 500px">
        <h1 style="
            font-size: 1.875rem;
            font-weight: bold;
            color: #be123c;
            margin-bottom: 1rem;
          ">
          界面资源加载失败
        </h1>
        <p style="font-size: 1.125rem; margin-bottom: 1.5rem">
          应用程序无法连接到外部网络服务器（CDN）来下载必要的界面文件（如样式和地图库）。
        </p>
        <div style="
            background-color: #f1f5f9;
            border-radius: 0.5rem;
            padding: 1rem;
            text-align: left;
            font-size: 0.875rem;
            line-height: 1.5;
          ">
          <h2 style="
              font-weight: 600;
              color: #1e293b;
              margin-top: 0;
              margin-bottom: 0.75rem;
            ">
            可能的原因及解决方法：
          </h2>
          <ul style="list-style-type: disc; padding-left: 1.25rem; margin: 0">
            <li style="margin-bottom: 0.5rem">
              <strong>检查您的网络连接</strong>：请确保您的设备已连接到互联网。
            </li>
            <li style="margin-bottom: 0.5rem">
              <strong>检查防火墙或代理</strong>：系统防火墙、杀毒软件或网络代理可能阻止了程序访问网络。
            </li>
            <li>
              <strong>网络环境问题</strong>：您当前的网络环境可能无法稳定访问所需的外部资源。
            </li>
          </ul>
        </div>
        <p style="margin-top: 1.5rem; font-size: 0.875rem; color: #64748b">
          请检查网络后，完全关闭并重启本程序。如果问题持续存在，您可能需要更换网络环境。
        </p>
      </div>
    </div>

    <div id="guest_warning_overlay" class="fixed inset-0 bg-black bg-opacity-50 z-[20000] hidden"></div>

    <div id="guest-warning-toast" class="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-11/12 max-w-2xl p-5 z-[20001] rounded-2xl hidden shadow-2xl transition-all duration-300 ease-out border-4 border-red-500" style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)">
      <button id="guest-warning-close-btn" class="absolute top-2 right-2 z-10 flex items-center justify-center text-slate-600 hover:text-red-600 hover:bg-white/80 rounded-full transition-colors duration-200 font-bold text-xl">
        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
        </svg>
      </button>

      <div class="flex items-start gap-4" id="guest_warning">
        <div class="flex-shrink-0 w-10 h-10 text-red-600 mt-1 animate-pulse">
          <svg fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
          </svg>
        </div>
        <div class="flex-1 pr-6">
          <h3 class="text-xl font-bold text-red-700 mb-2">
            ⚠️ 游客模式重要提示
          </h3>
          <div class="text-base text-slate-800 space-y-2 font-medium">
            <p class="bg-white/60 px-3 py-2 rounded-lg">
              <strong class="text-red-600">⚠️ 请立即保存当前网址！</strong>
              丢失URL将无法恢复您的数据！
            </p>
            <p class="bg-white/60 px-3 py-2 rounded-lg">
              <strong>功能限制：</strong>无法标记通知已读、无法使用签到功能、无法执行多账号任务
            </p>
            <p class="bg-white/60 px-3 py-2 rounded-lg">
              <strong class="text-amber-700">⏰ 自动清理：</strong>5分钟不活跃会话将被自动清理
            </p>
            <p class="mt-3 text-sm text-slate-600">
              💡 建议：<span class="text-blue-600 font-semibold">请注册账号以获得完整功能和永久数据保存</span>
            </p>
          </div>
        </div>
      </div>
    </div>
    <div id="newUserModal" class="modal">
      <div class="panel rounded-2xl w-full max-w-md p-6 space-y-4 relative bg-white/95 shadow-xl">
        <button id="newUserClose" class="absolute top-3 right-3 w-8 h-8 flex items-center justify-center text-slate-500 hover:text-red-600 hover:bg-slate-100 rounded-full transition-all">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
          </svg>
        </button>

        <h3 class="text-xl font-bold text-sky-700 text-center card-title">
          添加新用户
        </h3>

        <div>
          <label for="newUsername" class="block text-sm font-semibold leading-6 text-slate-700">账号</label>
          <input type="text" id="newUsername" placeholder="请输入账号（3-20字符，不含中文）" class="input-field mt-1">
        </div>

        <div>
          <label for="newUserPhone" class="block text-sm font-semibold leading-6 text-slate-700">手机号（可选）</label>
          <input type="tel" id="newUserPhone" placeholder="请输入手机号" inputmode="numeric" pattern="[0-9]*" class="input-field mt-1" maxlength="11">
        </div>

        <div id="newUserSmsGroup" style="display: none">
          <label for="newUserSmsCode" class="block text-sm font-semibold leading-6 text-slate-700">验证码（可选）</label>
          <div class="flex gap-2 mt-1">
            <input type="text" id="newUserSmsCode" placeholder="请输入验证码" maxlength="6" inputmode="numeric" pattern="[0-9]{6}" class="input-field flex-1">
            <button type="button" id="newUserSendCode" class="btn btn-primary whitespace-nowrap" style="min-height: 44px">
              发送验证码
            </button>
          </div>
        </div>

        <div>
          <label for="newUserNickname" class="block text-sm font-semibold leading-6 text-slate-700">昵称</label>
          <input type="text" id="newUserNickname" placeholder="请输入昵称（可含中文）" class="input-field mt-1">
        </div>

        <div>
          <label for="newPassword" class="block text-sm font-semibold leading-6 text-slate-700">密码</label>
          <input type="password" id="newPassword" placeholder="请输入密码（至少6字符）" class="input-field mt-1">
        </div>

        <div>
          <label for="newPasswordConfirm" class="block text-sm font-semibold leading-6 text-slate-700">确认密码</label>
          <input type="password" id="newPasswordConfirm" placeholder="请再次输入密码" class="input-field mt-1">
        </div>

        <div class="flex justify-end gap-3 pt-4 border-t border-slate-200">
          <button id="newUserCancel" class="btn btn-ghost">取消</button>
          <button id="newUserConfirm" class="btn btn-primary">确认</button>
        </div>
      </div>
    </div>

    <div id="multi-add-user-modal" class="modal">
      <div class="panel rounded-2xl w-full max-w-md p-6 space-y-4 relative bg-white/95 shadow-xl">
        <button id="multi-add-user-close" class="absolute top-3 right-3 w-8 h-8 flex items-center justify-center text-slate-500 hover:text-red-600 hover:bg-slate-100 rounded-full transition-all">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
          </svg>
        </button>
        <h3 class="text-xl font-bold text-sky-700 text-center card-title">
          添加新账号
        </h3>

        <div>
          <label for="multi-add-username" class="block text-sm font-semibold leading-6 text-slate-700">账号 (必填)</label>
          <input type="text" id="multi-add-username" placeholder="请输入账号（例如学号）" class="input-field mt-1">
        </div>
        <div>
          <label for="multi-add-password" class="block text-sm font-semibold leading-6 text-slate-700">密码 (必填)</label>
          <input type="password" id="multi-add-password" placeholder="请输入密码 (至少6字符)" class="input-field mt-1">
        </div>
        <div>
          <label for="multi-add-tag" class="block text-sm font-semibold leading-6 text-slate-700">标记 (可选)</label>
          <input type="text" id="multi-add-tag" placeholder="可选，用于分组 (例如: 'A组')" class="input-field mt-1">
        </div>
        <div class="flex justify-end gap-3 pt-4 border-t border-slate-200">
          <button id="multi-add-user-cancel" class="btn btn-ghost">取消</button>
          <button id="multi-add-user-confirm" class="btn btn-primary">
            确认添加
          </button>
        </div>
      </div>
    </div>

    <div id="school-accounts-modal" class="modal">
      <div class="panel rounded-2xl w-full max-w-4xl p-6 space-y-4 relative bg-white/95 shadow-xl">
        <button id="school-accounts-close" class="absolute top-3 right-3 w-8 h-8 flex items-center justify-center text-slate-500 hover:text-red-600 hover:bg-slate-100 rounded-full transition-all">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
          </svg>
        </button>
        <h3 class="text-xl font-bold text-sky-700 text-center card-title">
          School Accounts 管理
        </h3>
        <p class="text-sm text-slate-500 text-center -mt-2">
          查看所有认证用户的学校账户密码
        </p>

        <div id="school-accounts-content" class="space-y-4 max-h-[60vh] overflow-y-auto">
          <p class="text-slate-400 text-center py-10">加载中...</p>
        </div>

        <div class="flex justify-end gap-3 pt-4 border-t border-slate-200">
          <button id="school-accounts-refresh" class="btn btn-ghost">
            刷新
          </button>
          <button id="school-accounts-ok" class="btn btn-primary">确定</button>
        </div>
      </div>
    </div>

    <div id="edit-school-account-modal" class="fixed inset-0 hidden z-[1055] flex items-center justify-center p-4" style="background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(4px)">
      <div class="bg-gradient-to-br from-slate-50 to-white rounded-3xl shadow-2xl max-w-[560px] w-full transform transition-all" style="
          box-shadow: 12px 12px 24px rgba(0, 0, 0, 0.1),
            -12px -12px 24px rgba(255, 255, 255, 0.9);
        " onclick="event.stopPropagation()">
        <div class="p-6 pb-4 border-b border-slate-200">
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-3">
              <div class="w-12 h-12 rounded-full bg-gradient-to-br from-sky-400 to-blue-500 flex items-center justify-center flex-shrink-0" style="
                  box-shadow: 4px 4px 8px rgba(56, 189, 248, 0.3),
                    -2px -2px 8px rgba(255, 255, 255, 0.8);
                ">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                </svg>
              </div>
              <h3 class="text-xl font-bold text-slate-800" id="edit-school-account-modal-title">
                编辑 School Account
              </h3>
            </div>
            <button onclick="closeEditSchoolAccountModal()" class="text-slate-400 hover:text-slate-600 transition">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
        </div>

        <div class="p-6 space-y-4">
          <form id="edit-school-account-form" class="space-y-4">
            <div class="space-y-2">
              <label for="edit-school-account-auth-username" class="block text-sm font-medium text-slate-700">
                认证用户 (Auth Username)
              </label>
              <input type="text" id="edit-school-account-auth-username" name="auth_username" class="w-full px-4 py-2.5 text-slate-700 bg-slate-100 border border-slate-300 rounded-lg cursor-not-allowed" readonly="" placeholder="认证用户名" style="box-shadow: inset 2px 2px 4px rgba(0, 0, 0, 0.1)">
            </div>

            <div class="space-y-2">
              <label for="edit-school-account-school-username" class="block text-sm font-medium text-slate-700">
                学校账号用户名 (School Username)
                <span class="text-red-500">*</span>
              </label>
              <input type="text" id="edit-school-account-school-username" name="school_username" class="w-full px-4 py-2.5 text-slate-700 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-400 focus:border-transparent transition" placeholder="请输入学校账号用户名" required="" style="box-shadow: inset 1px 1px 2px rgba(0, 0, 0, 0.05)">
            </div>

            <div class="space-y-2">
              <label for="edit-school-account-password" class="block text-sm font-medium text-slate-700">
                密码 (Password) <span class="text-red-500">*</span>
              </label>
              <input type="text" id="edit-school-account-password" name="password" class="w-full px-4 py-2.5 text-slate-700 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-400 focus:border-transparent transition font-mono" placeholder="请输入密码" required="" style="box-shadow: inset 1px 1px 2px rgba(0, 0, 0, 0.05)">
            </div>

            <div class="space-y-2">
              <div class="flex items-center justify-between">
                <label for="edit-school-account-ua" class="block text-sm font-medium text-slate-700">
                  User Agent (UA)
                </label>
                <button type="button" onclick="generateRandomUAForSchoolAccount()" class="px-3 py-1 text-xs font-medium text-sky-600 bg-sky-50 border border-sky-200 rounded-lg hover:bg-sky-100 transition-all flex items-center gap-1" title="点击生成随机User-Agent">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                  </svg>
                  随机UA
                </button>
              </div>
              <textarea id="edit-school-account-ua" name="ua" rows="3" class="w-full px-4 py-2.5 text-slate-700 bg-white border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-400 focus:border-transparent transition font-mono text-sm resize-none" placeholder="（可选）请输入 User Agent" style="box-shadow: inset 1px 1px 2px rgba(0, 0, 0, 0.05)"></textarea>
              <p class="text-xs text-slate-500">
                如果不填写，将使用系统默认 User
                Agent。点击"随机UA"按钮可自动生成。
              </p>
            </div>

            <input type="hidden" id="edit-school-account-original-username" name="original_username">
          </form>
        </div>

        <div class="px-6 pb-6 flex gap-3 justify-end">
          <button type="button" onclick="closeEditSchoolAccountModal()" class="px-6 py-2.5 rounded-lg font-medium text-slate-600 bg-white border border-slate-300 hover:bg-slate-50 transition-all" style="
              box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1),
                -1px -1px 2px rgba(255, 255, 255, 0.8);
            ">
            取消
          </button>
          <button type="button" onclick="submitSchoolAccount()" class="px-6 py-2.5 rounded-lg font-medium text-white bg-gradient-to-br from-sky-400 to-blue-500 hover:from-sky-500 hover:to-blue-600 transition-all" style="
              box-shadow: 2px 2px 4px rgba(56, 189, 248, 0.4),
                -1px -1px 2px rgba(255, 255, 255, 0.6);
            ">
            保存
          </button>
        </div>
      </div>
    </div>

    <div id="loading-overlay" class="absolute inset-0 z-50 flex flex-col items-center justify-center gap-6 bg-white/80">
      <div class="loader"></div>
      <p class="text-base font-bold text-sky-600">正在加载资源中...</p>
    </div>

    <div id="captcha-verification-modal" class="fixed inset-0 hidden z-[10001] flex items-center justify-center p-4" style="background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(4px)">
      <div class="bg-gradient-to-br from-slate-50 to-white rounded-3xl shadow-2xl max-w-[560px] w-full transform transition-all" style="
          box-shadow: 12px 12px 24px rgba(0, 0, 0, 0.1),
            -12px -12px 24px rgba(255, 255, 255, 0.9);
        " onclick="event.stopPropagation()">
        <div class="p-6 pb-4 border-b border-slate-200">
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-3">
              <div class="w-12 h-12 rounded-full bg-gradient-to-br from-sky-400 to-blue-500 flex items-center justify-center flex-shrink-0" style="
                  box-shadow: 4px 4px 8px rgba(56, 189, 248, 0.3),
                    -2px -2px 8px rgba(255, 255, 255, 0.8);
                ">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                </svg>
              </div>
              <h3 class="text-xl font-bold text-slate-800">安全验证</h3>
            </div>
            <button onclick="closeCaptchaModal()" class="text-slate-400 hover:text-slate-600 transition">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
        </div>

        <div class="p-6 space-y-4">
          <p class="text-slate-600 text-sm">
            为保护您的账号安全，请完成以下验证
          </p>

          <div class="space-y-2">
            <label class="block text-sm font-semibold text-slate-700">图形验证码</label>
            <div class="relative w-full">
              <div id="captcha-modal-display" class="w-auto h-auto flex items-center justify-center border-2 border-slate-300 rounded-lg bg-white cursor-pointer hover:border-sky-400 transition-colors" onclick="refreshCaptchaModal()" title="点击刷新验证码" style="min-height: 64px">
                <span class="text-slate-400 text-xs">加载中...</span>
              </div>
              <button onclick="refreshCaptchaModal()" class="absolute top-2 right-2 btn btn-ghost !p-2 text-slate-500 hover:text-sky-600 transition-colors" title="刷新验证码">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                </svg>
              </button>
            </div>
          </div>

          <div class="space-y-2">
            <label class="block text-sm font-semibold text-slate-700">请输入验证码</label>
            <input type="text" id="captcha-modal-input" class="w-full px-4 py-3 border-2 border-slate-300 rounded-lg focus:border-sky-400 focus:outline-none transition-colors" placeholder="请输入图形验证码" maxlength="6" autocomplete="off">
          </div>
        </div>

        <div class="p-6 pt-0 flex gap-3">
          <button onclick="closeCaptchaModal()" class="flex-1 py-3 px-4 rounded-xl font-semibold text-slate-600 bg-slate-100 hover:bg-slate-200 transition-all" style="
              box-shadow: 4px 4px 8px rgba(0, 0, 0, 0.08),
                -2px -2px 8px rgba(255, 255, 255, 0.9);
            ">
            取消
          </button>
          <button id="captcha-modal-confirm-btn" onclick="confirmCaptchaAndSendSMS()" class="flex-1 py-3 px-4 rounded-xl font-semibold text-white bg-gradient-to-br from-sky-500 to-blue-600 hover:from-sky-600 hover:to-blue-700 transition-all" style="
              box-shadow: 4px 4px 12px rgba(56, 189, 248, 0.3),
                -2px -2px 8px rgba(255, 255, 255, 0.1);
            ">
            确认发送
          </button>
        </div>
      </div>
    </div>

    <div id="auth-login-container" class="hidden w-full h-full flex items-center justify-center">
      <div class="panel rounded-2xl w-full max-w-[600px] p-6 space-y-6">
        <div class="text-center">
          <h2 class="text-3xl font-bold text-sky-700 card-title mb-2">
            跑步助手
          </h2>
          <p class="text-sm text-slate-500">请登录或注册以继续使用</p>
        </div>

        <div class="flex border-b border-slate-200">
          <button id="auth-tab-login" class="flex-1 py-3 font-semibold text-sky-600 border-b-2 border-sky-600 transition">
            登录
          </button>
          <button id="auth-tab-register" class="flex-1 py-3 font-semibold text-slate-400 border-b-2 border-transparent transition hover:text-slate-600">
            注册
          </button>
        </div>

        <div id="auth-login-form" class="space-y-4 overflow-y-auto max-h-[60vh] p-1">
          <div id="auth-login-type-toggle" class="flex justify-center gap-2 pb-2">
            <button id="auth-login-username-btn" class="px-4 py-2 rounded-lg bg-sky-100 text-sky-700 font-semibold text-sm">
              用户名登录
            </button>
            <button id="auth-login-phone-btn" class="px-4 py-2 rounded-lg bg-slate-100 text-slate-600 text-sm">
              手机号登录
            </button>
          </div>

          <div>
            <label class="block text-sm font-semibold leading-6 text-slate-700" id="auth-login-label">用户名</label>
            <div id="auth-username-container">
              <input type="text" id="auth-username" class="input-field mt-1" placeholder="请输入用户名" autocomplete="username">
            </div>
          </div>

          <div id="auth-password-section">
            <div class="flex justify-between items-center">
              <label class="block text-sm font-semibold leading-6 text-slate-700">密码</label>
              <button type="button" id="auth-switch-to-sms" class="text-xs text-sky-600 hover:text-sky-700 hidden">
                使用验证码登录
              </button>
            </div>
            <input type="password" id="auth-password" class="input-field mt-1" placeholder="请输入密码" autocomplete="current-password">
          </div>

          <div id="auth-sms-section" class="hidden">
            <div class="flex justify-between items-center">
              <label class="block text-sm font-semibold leading-6 text-slate-700">验证码</label>
              <button type="button" id="auth-switch-to-password" class="text-xs text-sky-600 hover:text-sky-700">
                使用密码登录
              </button>
            </div>
            <div class="flex gap-2 mt-1">
              <input type="text" id="auth-sms-code" class="input-field flex-1" placeholder="请输入验证码" maxlength="6" inputmode="numeric" pattern="[0-9]{6}">
              <button type="button" id="auth-send-login-code" class="btn btn-primary whitespace-nowrap" style="min-height: 44px">
                发送验证码
              </button>
            </div>
          </div>

          <div>
            <label class="block text-sm font-semibold leading-6 text-slate-700">验证码</label>
            <div class="flex gap-2 mt-1 items-center">
              <div id="auth-login-captcha-display" class="flex-shrink-0 w-auto h-auto flex items-center justify-center border border-slate-300 rounded bg-white cursor-pointer hover:border-sky-400 transition-colors" title="点击刷新验证码" style="min-height: 64px">
                <span class="text-slate-400 text-xs">加载中...</span>
              </div>
              <button type="button" id="auth-login-captcha-refresh" class="btn btn-ghost !p-2" title="刷新验证码">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                </svg>
              </button>
            </div>
            <div class="mt-2">
              <input type="text" id="auth-login-captcha" class="input-field w-full" placeholder="请输入验证码" maxlength="6" autocomplete="off">
            </div>
          </div>

          <button id="auth-login-btn" class="btn btn-primary w-full py-3" style="min-height: 44px">
            登录
          </button>
          <div id="guest-login-section" class="text-center hidden">
            <div class="relative flex py-2 items-center">
              <div class="flex-grow border-t border-slate-200"></div>
              <span class="flex-shrink mx-4 text-slate-400 text-xs">或</span>
              <div class="flex-grow border-t border-slate-200"></div>
            </div>
            <button id="auth-guest-btn" class="btn btn-ghost w-full">
              以游客身份继续
            </button>
            <div class="mt-4 p-3 rounded-lg bg-amber-50 border border-amber-200 text-left">
              <div class="flex items-start gap-2">
                <svg class="w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z"></path>
                </svg>
                <div class="text-xs text-amber-800">
                  <p class="font-semibold mb-1">⚠️ 游客模式提示</p>
                  <ul class="space-y-1">
                    <li>• 游客使用UUID恢复状态，请务必保存地址</li>
                    <li>• 丢失URL将无法恢复您的数据和进度</li>
                    <li>• 5分钟不活跃会话将被自动清理</li>
                    <li>• 建议注册账号以获得更好的体验</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div id="auth-register-form" class="hidden space-y-4 overflow-y-auto max-h-[60vh] p-1">
          <div>
            <label class="block text-sm font-semibold leading-6 text-slate-700">用户名</label>
            <input type="text" id="auth-reg-username" class="input-field mt-1" placeholder="请输入用户名（3-20字符，不含中文）" autocomplete="username">
          </div>

          <div id="auth-reg-phone-wrapper">
            <label class="block text-sm font-semibold leading-6 text-slate-700">手机号</label>
            <div class="phone-input-wrapper mt-1">
              <span class="phone-prefix">+86 </span>
              <input type="tel" id="auth-reg-phone" class="input-field" placeholder="请输入手机号" autocomplete="tel" inputmode="numeric" pattern="[0-9]*" maxlength="11">
            </div>
          </div>

          <div id="auth-reg-sms-wrapper">
            <label class="block text-sm font-semibold leading-6 text-slate-700">验证码</label>
            <div class="flex gap-2">
              <input type="text" id="auth-reg-sms-code" class="input-field mt-1 flex-1" placeholder="请输入验证码" maxlength="6" inputmode="numeric" pattern="[0-9]{6}">
              <button id="auth-reg-send-code-btn" class="btn btn-primary mt-1 whitespace-nowrap" style="min-height: 44px">
                发送验证码
              </button>
            </div>
          </div>

          <div>
            <label class="block text-sm font-semibold leading-6 text-slate-700">昵称</label>
            <input type="text" id="auth-reg-nickname" class="input-field mt-1" placeholder="请输入昵称（可含中文）">
          </div>

          <div>
            <label class="block text-sm font-semibold leading-6 text-slate-700">头像</label>
            <div class="flex items-center gap-3 mt-1">
              <img id="auth-reg-avatar-preview" src="/static/default_avatar.png" class="w-16 h-16 rounded-full object-cover border-2 border-slate-200">
              <input type="file" id="auth-reg-avatar" accept="image/*" class="hidden">
              <button class="btn btn-ghost border border-slate-300 !py-1.5 !px-3 text-sm" onclick="document.getElementById('auth-reg-avatar').click(); return false;">
                <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path>
                </svg>
                上传头像
              </button>
            </div>
          </div>

          <div>
            <label class="block text-sm font-semibold leading-6 text-slate-700">密码</label>
            <input type="password" id="auth-reg-password" class="input-field mt-1" placeholder="请输入密码（至少6字符）" autocomplete="new-password">
          </div>
          <div>
            <label class="block text-sm font-semibold leading-6 text-slate-700">确认密码</label>
            <input type="password" id="auth-reg-password-confirm" class="input-field mt-1" placeholder="请再次输入密码" autocomplete="new-password">
          </div>

          <div>
            <label class="block text-sm font-semibold leading-6 text-slate-700">验证码</label>
            <div class="flex gap-2 mt-1 items-center">
              <div id="auth-register-captcha-display" class="flex-shrink-0 w-auto h-auto flex items-center justify-center border border-slate-300 rounded bg-white cursor-pointer hover:border-sky-400 transition-colors" title="点击刷新验证码" style="min-height: 64px">
                <span class="text-slate-400 text-xs">加载中...</span>
              </div>
              <button type="button" id="auth-register-captcha-refresh" class="btn btn-ghost !p-2" title="刷新验证码">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                </svg>
              </button>
            </div>
            <div class="mt-2">
              <input type="text" id="auth-register-captcha" class="input-field w-full" placeholder="请输入验证码" maxlength="6" autocomplete="off">
            </div>
          </div>

          <button id="auth-register-btn" class="btn btn-success w-full py-3" style="min-height: 44px">
            注册
          </button>
        </div>

        <div id="auth-2fa-form" class="hidden space-y-4">
          <div class="text-center mb-4">
            <h3 class="text-xl font-bold text-sky-700 mb-2">双因素认证</h3>
            <p class="text-sm text-slate-500">
              请输入您的验证器应用中的6位验证码
            </p>
          </div>
          <div id="auth-reg-sms-wrapper">
            <label class="block text-sm font-semibold leading-6 text-slate-700">验证码</label>
            <input type="text" id="auth-2fa-code" class="input-field mt-1" placeholder="输入6位验证码" maxlength="6" inputmode="numeric" pattern="[0-9]{6}" autocomplete="one-time-code">
          </div>
          <button id="auth-2fa-verify-btn" class="btn btn-primary w-full py-3">
            验证
          </button>
          <button id="auth-2fa-back-btn" class="btn btn-ghost w-full">
            返回登录
          </button>
        </div>

        <div id="auth-error-msg" class="hidden text-sm text-center p-3 rounded-lg bg-red-50 border border-red-200 text-red-600"></div>
        <div id="auth-success-msg" class="hidden text-sm text-center p-3 rounded-lg bg-green-50 border border-green-200 text-green-600"></div>
      </div>
    </div>

    <!-- ========================================
       【桌面端容器】Desktop Container
       ======================================== -->
    <div id="desktop-container">
      <!-- 登录界面 -->
      <div id="login-container" class="w-full h-full grid grid-cols-1 lg:grid-cols-3">
        <div class="flex flex-col items-center justify-center p-8 lg:p-12 bg-gradient-to-br from-purple-50 via-violet-50 to-purple-100 relative overflow-hidden">
          <div class="absolute top-0 right-0 w-64 h-64 bg-violet-200 rounded-full opacity-20 blur-3xl -translate-y-1/2 translate-x-1/2"></div>
          <div class="absolute bottom-0 left-0 w-48 h-48 bg-purple-300 rounded-full opacity-20 blur-2xl translate-y-1/2 -translate-x-1/2"></div>

          <div class="relative text-center w-full max-w-sm space-y-7 panel rounded-3xl p-10 bg-white/60 backdrop-blur-xl shadow-2xl border border-white/50 hover:shadow-violet-200/50 transition-all duration-500 hover:scale-[1.02]">
            <div class="relative inline-block">
              <div class="absolute inset-0 bg-violet-400 rounded-full blur-2xl opacity-30 animate-pulse"></div>

              <svg xmlns="http://www.w3.org/2000/svg" class="relative w-20 h-20 mx-auto text-violet-600 drop-shadow-lg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05c1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"></path>
              </svg>
            </div>

            <h2 class="text-3xl lg:text-4xl font-bold bg-gradient-to-r from-violet-600 to-purple-600 bg-clip-text text-transparent card-title leading-tight">
              掌上莲峰<br>多账号模式
            </h2>

            <div class="space-y-3">
              <p class="text-slate-600 text-base leading-relaxed">
                ✨ 支持批量导入账号<br>
                🎯 统一管理所有任务<br>
                ⚡ 一键执行全部流程
              </p>
            </div>

            <button id="multi-account-btn" class="btn btn-secondary w-full py-3.5 text-lg font-bold shadow-xl shadow-violet-300/40 hover:shadow-2xl hover:shadow-violet-400/50 transition-all duration-300">
              <span>进入多账号控制台</span>
              <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"></path>
              </svg>
            </button>
          </div>
        </div>

        <div class="flex items-center justify-center p-6 lg:p-8 bg-gradient-to-br from-white via-sky-50/30 to-cyan-50/40 relative overflow-hidden">
          <div class="absolute top-0 right-0 w-64 h-64 bg-sky-300 rounded-full opacity-10 blur-3xl translate-x-1/3 -translate-y-1/3"></div>
          <div class="absolute bottom-0 left-0 w-48 h-48 bg-cyan-200 rounded-full opacity-15 blur-2xl -translate-x-1/4 translate-y-1/4"></div>

          <div class="relative panel rounded-3xl w-full max-w-md p-10 space-y-7 shadow-2xl border border-white/60 hover:shadow-sky-200/40 transition-all duration-300">
            <div class="flex items-center justify-center gap-3 pb-2">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 text-sky-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
              </svg>
              <h2 class="text-3xl lg:text-4xl font-bold text-sky-700 card-title">
                单账号登录
              </h2>
            </div>

            <div class="text-center">
              <p class="text-slate-500 text-sm">掌上莲峰跑步助手</p>
            </div>

            <div class="space-y-5 w-full">
              <div class="space-y-2">
                <label class="block text-sm font-bold leading-6 text-slate-700 flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-slate-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                  </svg>
                  选择账号
                </label>
                <select id="user-combo" class="select-field hover:border-sky-400 focus:border-sky-600 cursor-pointer transition-all duration-200" title="选择已保存的账号或创建新账号" aria-label="选择账号"></select>
              </div>

              <div class="space-y-2">
                <label class="block text-sm font-bold leading-6 text-slate-700 flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-slate-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                  </svg>
                  用户名
                </label>
                <input type="text" id="username-entry" class="input-field hover:border-sky-400 focus:border-sky-600 transition-all duration-200" placeholder="请输入学号或工号" autocomplete="username">
              </div>

              <div class="space-y-2">
                <label class="block text-sm font-bold leading-6 text-slate-700 flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-slate-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                  </svg>
                  密码
                </label>
                <input type="password" id="password-entry" class="input-field hover:border-sky-400 focus:border-sky-600 transition-all duration-200" placeholder="请输入密码，一般为身份证后六位" autocomplete="current-password">
              </div>
            </div>

            <button id="login-button" class="btn btn-primary w-full py-3.5 text-lg font-bold shadow-xl shadow-sky-300/40 hover:shadow-2xl hover:shadow-sky-400/50 transition-all duration-300">
              <span>立即登录</span>
              <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd"></path>
              </svg>
            </button>

            <div class="relative flex py-3 items-center">
              <div class="flex-grow border-t border-slate-300"></div>
              <span class="flex-shrink mx-5 text-slate-400 text-sm font-medium">或者</span>
              <div class="flex-grow border-t border-slate-300"></div>
            </div>

            <button id="import-button" class="btn btn-success w-full py-3 font-bold shadow-lg shadow-green-300/30 hover:shadow-xl hover:shadow-green-400/40 transition-all duration-300">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
              </svg>
              <span>导入离线文件</span>
            </button>

            <div class="pt-4 space-y-3 border-t border-slate-200">
              <div class="flex justify-between items-center">
                <span class="text-sm font-semibold text-slate-600 flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                  User-Agent 标识
                </span>

                <button id="random-ua-btn" title="随机生成新的User-Agent，用于模拟不同设备和浏览器" class="btn btn-ghost !py-1.5 !px-3 text-xs hover:bg-sky-100 transition-colors">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                  </svg>
                  <span>随机</span>
                </button>
              </div>

              <p id="ua-label" class="text-xs text-slate-600 break-all bg-gradient-to-br from-white to-slate-50 border border-slate-300 p-3 rounded-xl leading-relaxed shadow-inner">
                (未加载)
              </p>
            </div>
          </div>
        </div>

        <div class="flex flex-col items-center justify-center p-6 md:p-10 lg:p-12 bg-gradient-to-br from-sky-50 via-white to-cyan-50 relative overflow-hidden" id="admin-panel-modal-Inline">
          <div class="absolute top-0 left-0 w-72 h-72 bg-sky-200 rounded-full opacity-10 blur-3xl -translate-y-1/3 -translate-x-1/3"></div>
          <div class="absolute bottom-0 right-0 w-56 h-56 bg-cyan-300 rounded-full opacity-10 blur-2xl translate-y-1/3 translate-x-1/3"></div>

          <div class="relative panel rounded-3xl w-full max-w-2xl p-8 space-y-5 bg-white/80 backdrop-blur-xl flex flex-col overflow-x-hidden shadow-2xl border border-white/60 hover:shadow-sky-200/50 transition-shadow duration-300" style="max-height: calc(100vh - 12rem)">
            <div class="flex items-center justify-center gap-2 pb-2 border-b border-sky-100">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-sky-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
              </svg>
              <h3 class="text-2xl font-bold text-sky-700 text-center">
                会话管理
              </h3>
            </div>

            <div id="admin-sessions-panel" class="space-y-4 overflow-y-auto overflow-x-hidden flex-grow min-h-0 pr-2">
              <div class="flex justify-between items-center bg-gradient-to-r from-sky-50 to-transparent p-4 rounded-xl">
                <h4 class="font-bold text-slate-700 text-lg">会话列表</h4>

                <div class="flex items-center gap-4">
                  <label id="god-mode-toggle" class="flex items-center gap-2 cursor-pointer bg-red-50 px-3 py-1.5 rounded-full hover:bg-red-100 transition-colors" style="display: none">
                    <input type="checkbox" id="god-mode-checkbox" class="w-4 h-4 accent-red-600 rounded cursor-pointer">
                    <span class="text-sm font-bold text-red-600">⚠️ 上帝模式</span>
                  </label>

                  <div id="admin-session-count-display-inline" class="text-sm font-medium text-slate-600 bg-white/70 px-3 py-1.5 rounded-full border border-slate-200"></div>

                  <button id="admin-refresh-sessions-inline" class="btn btn-ghost !py-1.5 !px-3 hover:bg-sky-100 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                    </svg>
                    <span>刷新</span>
                  </button>
                </div>
              </div>

              <div id="admin-sessions-list-inline" class="space-y-3 max-h-[50vh] overflow-y-auto pr-1">
                <p class="text-slate-400 text-center py-12 text-base">
                  <svg class="animate-spin h-8 w-8 mx-auto mb-3 text-sky-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                  </svg>
                  正在加载会话数据...
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <main id="main-app" class="hidden h-screen w-screen grid grid-cols-1 lg:grid-cols-3 xl:grid-cols-4 gap-4 p-4">
        <div class="lg:col-span-1 xl:col-span-1 flex flex-col gap-4 h-full min-h-0 min-w-[320px]">
          <div class="panel rounded-xl p-4 flex items-center gap-4">
            <div class="flex-1">
              <p id="user-name-label" class="font-bold text-slate-800 truncate">
                姓名: NULL
              </p>
              <p id="user-id-label" class="text-sm text-slate-500">
                学号: NULL
              </p>
            </div>

            <button id="show-notifications-btn" class="btn btn-ghost !py-2 !px-3 relative" title="查看通知">
              <span>通知</span>
              <span id="notification-badge" class="hidden absolute -top-1 -right-1 w-4 h-4 rounded-full bg-red-500 text-white text-[10px] font-bold flex items-center justify-center">0</span>
            </button>
            <button id="show-user-details" class="btn btn-ghost !py-2 !px-3" title="查看用户详情">
              详情
            </button>
            <button id="show-admin-panel" class="btn btn-ghost !py-2 !px-3 hidden" title="管理面板">
              管理
            </button>
            <button id="logout-button" class="btn btn-ghost !py-2 !px-3 !text-red-600" title="注销">
              退出
            </button>
          </div>
          <div class="panel rounded-xl p-4 flex-grow flex flex-col min-h-0">
            <div class="flex justify-between items-center mb-3">
              <h2 class="text-lg font-bold text-slate-800">任务列表</h2>
              <div class="flex gap-2">
                <button id="show-task-details" class="btn btn-ghost !py-1 !px-3">
                  任务详情
                </button>
                <button id="refresh-button" class="btn btn-ghost !py-1 !px-3">
                  刷新
                </button>
              </div>
            </div>
            <div id="task-list" class="flex-grow overflow-y-auto -mr-2 pr-2"></div>
          </div>
          <div class="panel rounded-xl p-4">
            <div class="flex border-b border-slate-200 -mx-4 px-2 space-x-2">
              <button class="tab-button active" onclick="showTab('run-control', this)">
                执行
              </button>
              <button class="tab-button" onclick="showTab('path-tools', this)">
                路径
              </button>
              <button class="tab-button" onclick="showTab('checkpoints', this)">
                打卡点
              </button>
              <button class="tab-button" onclick="showTab('attendance', this)">
                签到
              </button>
              <button class="tab-button" onclick="showTab('history', this)">
                历史
              </button>
              <button class="tab-button" onclick="showTab('params', this)">
                参数
              </button>
              <button class="tab-button" onclick="showTab('log', this)">
                日志
              </button>
            </div>
            <div class="h-56 overflow-y-auto">
              <div id="run-control-tab" class="pt-4 space-y-3">
                <div id="run-stats-block" class="text-center p-3 rounded-lg border border-slate-200 bg-white/80">
                  <p class="text-sm text-slate-500">已选任务总览</p>
                  <p id="run-stats-label" class="font-bold text-2xl text-sky-600">
                    -- km / --:--
                  </p>
                </div>

                <div id="single-progress-block" class="mt-2">
                  <div class="h-2 bg-slate-200 rounded-full overflow-hidden">
                    <div id="single-progress-fill" class="h-2 bg-sky-500" style="width: 0%"></div>
                  </div>
                  <div class="flex justify-between text-xs mt-1">
                    <span id="single-progress-text" class="text-slate-600">未开始</span>
                    <span id="single-progress-extra" class="text-slate-400"></span>
                  </div>
                </div>

                <div class="grid grid-cols-2 gap-3">
                  <button id="start-run-button" class="btn btn-primary">
                    开始执行
                  </button>
                  <button id="start-all-button" class="btn btn-secondary">
                    执行所有
                  </button>
                </div>

                <div class="flex items-center justify-center space-x-4 pt-1">
                  <label class="flex items-center gap-1.5 text-xs text-slate-700 cursor-pointer"><input type="checkbox" id="run-completed-check" class="w-4 h-4 accent-sky-600 rounded"><span class="font-semibold">忽略已完成状态</span></label>
                  <label class="flex items-center gap-1.5 text-xs text-slate-700 cursor-pointer"><input type="checkbox" id="auto-gen-all-check" class="w-4 h-4 accent-sky-600 rounded"><span class="font-semibold">自动生成路径</span></label>
                </div>
              </div>
              <div id="path-tools-tab" class="hidden pt-4 space-y-3">
                <div class="grid grid-cols-2 gap-3">
                  <button id="record-button" class="btn btn-success">
                    录制路径
                  </button>
                  <button id="auto-gen-button" class="btn btn-secondary">
                    自动生成
                  </button>
                  <button id="process-button" class="btn btn-primary">
                    处理路径
                  </button>
                  <button id="clear-button" class="btn btn-warning">
                    清除路径
                  </button>
                </div>
                <div class="grid grid-cols-2 gap-3">
                  <button id="export-button" class="btn btn-ghost border border-slate-300 col-span-1">
                    导出
                  </button>
                  <div class="col-span-1"></div>
                </div>
              </div>
              <div id="checkpoints-tab" class="hidden pt-2">
                <div id="target-points-text" class="h-48 overflow-y-auto"></div>
              </div>

              <div id="attendance-tab" class="hidden pt-2 space-y-2 h-56 flex flex-col">
                <div class="flex-shrink-0 space-y-2 border-b pb-2">
                  <label class="flex items-center gap-2 cursor-pointer" title="开启后，将在后台自动刷新通知并尝试签到">
                    <input type="checkbox" id="param-auto_attendance_enabled" data-key="auto_attendance_enabled" class="w-5 h-5 accent-sky-600 rounded cursor-pointer flex-shrink-0">
                    <span class="text-slate-700 font-semibold">开启自动签到</span>
                  </label>

                  <div class="flex items-center gap-2">
                    <label class="text-sm text-slate-700 font-semibold flex-shrink-0">刷新间隔(秒)</label>
                    <input type="number" step="30" id="param-auto_attendance_refresh_s" data-key="auto_attendance_refresh_s" class="input-field !py-1 w-full" title="自动刷新通知的间隔时间（秒），建议不低于60">
                  </div>
                  <div class="flex items-center gap-2">
                    <label class="text-sm text-slate-700 font-semibold flex-shrink-0">随机半径(米)</label>
                    <input type="number" step="1" id="param-attendance_user_radius_m" data-key="attendance_user_radius_m" class="input-field !py-1 w-full" title="自动签到时，在服务器允许范围内的最大随机偏移半径。设为0为精确签到。">
                  </div>
                </div>
                <div class="flex justify-between items-center border-t pt-2 mt-2">
                  <h4 class="text-sm font-semibold text-slate-700">
                    签到任务列表
                  </h4>
                  <button id="refresh-attendance-list-btn" class="btn btn-ghost !py-0 !px-2 !text-xs text-sky-600" onclick="refreshNotificationsUI(true, true)">
                    刷新
                  </button>
                </div>

                <div id="attendance-list" class="flex-grow overflow-y-auto pr-1">
                  <p class="text-slate-400 text-center py-10 text-xs">
                    点击“刷新”按钮查看签到任务
                  </p>
                </div>
              </div>

              <div id="history-tab" class="hidden pt-2">
                <div id="history-list-container">
                  <p id="history-placeholder" class="text-slate-400 text-center py-16">
                    选择任务后显示历史记录
                  </p>
                  <div id="history-list"></div>
                </div>
              </div>
              <div id="params-tab" class="hidden space-y-3">
                <div id="params-container"></div>
              </div>
              <div id="log-tab" class="hidden pt-2">
                <div class="h-48">
                  <textarea id="log-text" readonly="" class="w-full h-full bg-white/80 border border-slate-200 rounded-md p-2 text-xs text-slate-700 resize-none focus:outline-none leading-snug"></textarea>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="lg:col-span-2 xl:col-span-3 flex flex-col gap-4 h-full min-h-0">
          <div id="map-container" class="flex-grow bg-slate-200 rounded-xl relative overflow-hidden border border-slate-200">
            <div class="absolute top-4 right-3 z-10 bg-white/80 backdrop-blur-sm rounded-full shadow-md flex items-center space-x-1 p-1 border border-slate-200">
              <button id="zoom-in" class="w-9 h-9 font-bold text-xl text-center hover:bg-slate-100 rounded-full text-slate-700">
                +
              </button>
              <span id="zoom-level" class="text-xs font-mono select-none w-8 text-center">17</span>
              <button id="zoom-out" class="w-9 h-9 font-bold text-xl text-center hover:bg-slate-100 rounded-full text-slate-700">
                -
              </button>
              <button id="reset-view-btn" class="w-9 h-9 font-bold text-lg flex items-center justify-center hover:bg-slate-100 rounded-full text-slate-700" title="复位视角">
                🎯
              </button>
            </div>
          </div>
          <div class="grid grid-cols-1 gap-4">
            <div class="panel rounded-xl p-4 flex flex-col gap-3">
              <div class="flex items-center justify-between">
                <h3 class="font-bold text-slate-800">实时状态</h3>
                <p class="text-sm font-mono text-slate-500" id="current-location-label">
                  当前位置GPS坐标: --, --
                </p>
              </div>
              <div class="grid grid-cols-4 divide-x divide-slate-200 text-center pt-2">
                <div>
                  <p class="text-sm text-slate-500">已跑距离</p>
                  <p id="live-dist-label" class="font-bold text-xl text-slate-700">
                    0.00 km
                  </p>
                </div>
                <div>
                  <p class="text-sm text-slate-500">总距离</p>
                  <p id="total-dist-label" class="font-bold text-xl text-slate-700">
                    0.00 km
                  </p>
                </div>
                <div>
                  <p class="text-sm text-slate-500">已用时间</p>
                  <p id="live-time-label" class="font-bold text-xl text-slate-700">
                    00:00
                  </p>
                </div>
                <div>
                  <p class="text-sm text-slate-500">预计时间</p>
                  <p id="total-time-label" class="font-bold text-xl text-slate-700">
                    00:00
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>

      <main id="multi-account-app" class="hidden h-screen w-screen grid grid-cols-1 lg:grid-cols-[530px,1fr] xl:grid-cols-[530px,1fr] gap-4 p-4">
        <div class="flex flex-col gap-4 h-full min-h-0">
          <div class="panel rounded-xl p-4 flex-shrink-0">
            <div class="flex justify-between items-center mb-3">
              <h2 class="text-lg font-bold text-slate-800 card-title">
                多账号控制台
              </h2>
              <div class="flex gap-2">
                <button id="show-admin-panel-multi" class="btn btn-ghost !py-1 !px-3" title="管理面板">
                  管理面板
                </button>
                <button id="exit-multi-mode-btn" class="btn btn-ghost !py-1 !px-3">
                  返回登录页
                </button>
              </div>
            </div>
            <div class="grid grid-cols-2 gap-3">
              <button id="multi-start-all-btn" class="btn btn-primary">
                全部开始
              </button>
              <button id="multi-stop-all-btn" class="btn btn-danger">
                全部停止
              </button>
            </div>
            <div class="mt-4 space-y-2 text-sm border-t pt-3">
              <label class="flex items-center gap-2 cursor-pointer font-semibold text-slate-700">
                <input type="checkbox" id="multi-use-delay-check" checked="" class="w-4 h-4 accent-sky-600 rounded">
                启用随机启动延迟
                <div class="flex items-center gap-2 pl-6">
                  <input type="number" id="multi-min-delay-input" value="0" class="input-field !py-1 w-20 text-center">
                  <span>-</span>
                  <input type="number" id="multi-max-delay-input" value="300" class="input-field !py-1 w-20 text-center">
                  <span>秒</span>
                </div>
              </label>
              <label class="flex items-center gap-2 cursor-pointer font-semibold text-slate-700 mt-2">
                <input type="checkbox" id="multi-run-only-incomplete-check" checked="" class="w-4 h-4 accent-sky-600 rounded">
                仅执行未完成的任务
              </label>
            </div>
          </div>
          <div class="panel rounded-xl p-4 flex-grow flex flex-col min-h-0">
            <div class="flex justify-between items-center mb-1">
              <div class="flex items-center gap-2">
                <h2 class="text-lg font-bold text-slate-800">
                  账号列表 (<span id="multi-account-count">0</span>)
                </h2>
                <input type="checkbox" id="multi-select-all-check" class="w-4 h-4 accent-sky-600 rounded" title="全选/取消全选" style="display: none">
              </div>
              <div class="flex gap-2">
                <button id="multi-import-excel-btn" class="btn btn-ghost !py-1 !px-3" title="从文件导入">
                  导入
                </button>
                <button id="multi-export-excel-btn" class="btn btn-ghost !py-1 !px-3" title="导出汇总">
                  导出
                </button>
                <button id="multi-download-template-btn" class="btn btn-ghost !py-1 !px-3" title="下载导入模板">
                  下载模板
                </button>
              </div>
            </div>

            <div class="flex items-center justify-between mb-3 text-xs border-b pb-2">
              <!-- 左侧：刷新 -->
              <div class="flex items-center gap-2">
                <button id="multi-refresh-selected-btn" class="btn btn-ghost !py-0.5 !px-2 text-sm text-blue-600">
                  刷新选中
                </button>
                <button id="multi-refresh-all-btn" class="btn btn-ghost !py-0.5 !px-2 text-sm text-blue-600">
                  刷新全部
                </button>
              </div>

              <!-- 中央：控制 -->
              <div class="flex items-center gap-2">
                <button id="multi-start-selected-btn" class="btn btn-ghost !py-0.5 !px-2 text-sm text-green-600">
                  开始选中
                </button>
                <button id="multi-stop-selected-btn" class="btn btn-ghost !py-0.5 !px-2 text-sm text-green-600">
                  停止选中
                </button>
              </div>

              <!-- 右侧：移除 -->
              <div class="flex items-center gap-2">
                <button id="multi-remove-selected-btn" class="btn btn-ghost !py-0.5 !px-2 text-sm text-red-600">
                  移除选中
                </button>
                <button id="multi-remove-all-btn" class="btn btn-ghost !py-0.5 !px-2 text-sm text-red-600">
                  移除全部
                </button>
              </div>
            </div>

            <div id="multi-account-list" class="flex-grow overflow-y-auto -mr-2 pr-2" style="max-height: 42vh">
              <p class="text-slate-400 text-center py-10">请先添加或导入账号</p>
            </div>
            <div class="mt-2 border-t pt-3 flex items-center gap-2">
              <select id="multi-config-user-select" class="select-field !py-1 flex-grow"></select>
              <button id="multi-add-from-config-btn" class="btn btn-ghost !py-1 !px-2 flex-shrink-0">
                添加
              </button>
              <button id="multi-load-all-from-config-btn" class="btn btn-ghost !py-1 !px-2 flex-shrink-0">
                添加全部
              </button>
            </div>
          </div>
          <div class="panel rounded-xl p-4 flex-shrink-0">
            <h3 class="font-bold text-slate-800 mb-2">全局参数</h3>
            <div id="multi-global-params-container" class="h-40 overflow-y-auto pr-1"></div>
          </div>
        </div>
        <div class="flex flex-col gap-4 h-full min-h-0">
          <div id="multi-map-container" class="flex-grow bg-slate-200 rounded-xl relative overflow-hidden border border-slate-200">
            <div class="absolute top-4 right-3 z-10 bg-white/80 backdrop-blur-sm rounded-full shadow-md flex items-center space-x-1 p-1 border border-slate-200">
              <button id="multi-zoom-in" class="w-9 h-9 font-bold text-xl text-center hover:bg-slate-100 rounded-full text-slate-700">
                +
              </button>
              <span id="multi-zoom-level" class="text-xs font-mono select-none w-8 text-center">17</span>
              <button id="multi-zoom-out" class="w-9 h-9 font-bold text-xl text-center hover:bg-slate-100 rounded-full text-slate-700">
                -
              </button>
              <button id="multi-reset-view-btn" class="w-9 h-9 font-bold text-lg flex items-center justify-center hover:bg-slate-100 rounded-full text-slate-700" title="复位视角">
                🎯
              </button>
            </div>
          </div>
          <div class="panel rounded-xl p-4 h-48 flex flex-col">
            <h3 class="font-bold text-slate-800 mb-2">全局日志</h3>
            <textarea id="multi-log-text" readonly="" class="w-full flex-grow bg-white/80 border border-slate-200 rounded-md p-2 text-xs text-slate-700 resize-none focus:outline-none leading-snug"></textarea>
          </div>
        </div>
      </main>

      <div id="amap-key-modal" class="fixed inset-0 flex items-center justify-center hidden z-50">
        <div class="absolute inset-0 bg-black/60"></div>
        <div class="panel rounded-2xl p-6 w-96 space-y-6 relative">
          <h3 class="text-xl font-bold text-red-600 text-center">
            缺少地图API Key
          </h3>
          <p class="text-sm text-slate-600 text-center">
            程序需要一个有效的高德地图JS API Key才能使用地图功能。请前往
            <a href="https://console.amap.com/dev/key/app" target="_blank" class="text-sky-600 hover:underline">高德开放平台</a>
            申请一个Key（类型选择“Web端(JS API)”），然后粘贴到下方。
          </p>
          <div class="space-y-2">
            <label class="w-full text-slate-700 font-semibold">API Key:</label>
            <input id="amap-key-input" type="text" class="input-field w-full" placeholder="请在此处粘贴你的API Key">
          </div>
          <div class="flex justify-end gap-3 pt-4">
            <button id="confirm-amap-key-btn" class="btn btn-primary">
              确认并保存
            </button>
          </div>
        </div>
      </div>

      <div id="auto-gen-modal" class="fixed inset-0 flex items-center justify-center hidden z-50">
        <div class="absolute inset-0 bg-black/40"></div>
        <div class="panel rounded-2xl p-6 w-96 space-y-6 relative">
          <h3 class="text-xl font-bold text-sky-600 text-center">
            自动生成路线配置
          </h3>
          <div class="space-y-4">
            <div class="flex items-center">
              <label class="w-32 text-slate-700 font-semibold">最短时间(分钟)</label>
              <input id="min-time-input" type="number" value="20" class="input-field w-full">
            </div>
            <div class="flex items-center">
              <label class="w-32 text-slate-700 font-semibold">最长时间(分钟)</label>
              <input id="max-time-input" type="number" value="30" class="input-field w-full">
            </div>
            <div class="flex items-center">
              <label class="w-32 text-slate-700 font-semibold">最短距离(米)</label>
              <input id="min-dist-input" type="number" value="2000" class="input-field w-full">
            </div>
          </div>
          <div class="flex justify-end gap-3 pt-4">
            <button id="cancel-gen-button" class="btn btn-ghost border border-slate-300">
              取消
            </button>
            <button id="confirm-gen-button" class="btn btn-primary">
              生成
            </button>
          </div>
        </div>
      </div>
      <div id="user-details-modal" class="fixed inset-0 hidden items-center justify-center z-50">
        <div class="absolute inset-0 bg-black/40" onclick="toggleUserDetails(false)"></div>
        <div class="panel rounded-2xl p-6 w-[32rem] space-y-4 relative">
          <div class="flex items-center justify-center gap-2">
            <h3 class="text-xl font-bold text-sky-600 text-center">用户详情</h3>
          </div>
          <div id="user-details-content" class="text-sm space-y-1 max-h-[70vh] overflow-y-auto"></div>
          <div class="flex justify-end pt-2">
            <button class="btn btn-ghost border border-slate-300" onclick="toggleUserDetails(false)">
              关闭
            </button>
          </div>
        </div>
      </div>
      <div id="task-details-modal" class="fixed inset-0 hidden items-center justify-center z-50">
        <div class="absolute inset-0 bg-black/40" onclick="toggleTaskDetails(false)"></div>
        <div class="panel rounded-2xl p-6 w-[36rem] space-y-4 relative">
          <div class="flex items-center justify-center gap-2">
            <h3 class="text-xl font-bold text-sky-600 text-center">任务详情</h3>
          </div>
          <div id="task-details-content" class="text-sm space-y-1 max-h-[70vh] overflow-y-auto"></div>
          <div class="flex justify-end pt-2">
            <button class="btn btn-ghost border border-slate-300" onclick="toggleTaskDetails(false)">
              关闭
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- ========================================
       【移动端容器】Mobile Container
       ======================================== -->
    <div id="mobile-container">
      <header class="mobile-header hidden relative flex items-center w-full h-14 px-2 bg-white shadow-sm" id="mobile-header" style="display: none">
        <button id="mobile-menu-btn" class="p-2 -ml-5 text-slate-700 hover:bg-slate-100 rounded-md" aria-label="菜单" style="display: none" onclick="toggleMobileSidebar()">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>

        <div class="absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 flex items-center whitespace-nowrap">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-sky-600" viewBox="0 0 24 24" fill="currentColor">
            <path d="M13.49 5.48c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm-3.6 13.9l1-4.4 2.1 2v6h2v-7.5l-2.1-2 .6-3c1.3 1.5 3.3 2.5 5.5 2.5v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1l-5.2 2.2v4.7h2v-3.4l1.8-.7-1.6 8.1-4.9-1-.4 2 7 1.4z"></path>
          </svg>
          <span class="ml-2 text-lg font-bold text-slate-800">跑步助手</span>
        </div>
      </header>
      <main class="mobile-content">
        <div id="mobile-auth-login-container" class="space-y-4">
          <div class="mobile-card">
            <div class="text-center mb-6">
              <h1 class="mobile-title">欢迎使用跑步助手</h1>
              <p class="mobile-subtitle">请登录或注册以继续使用</p>
            </div>

            <div class="flex border-b border-slate-200 mb-4">
              <button id="mobile-auth-tab-login" class="flex-1 py-3 font-semibold text-sky-600 border-b-2 border-sky-600 transition">
                登录
              </button>
              <button id="mobile-auth-tab-register" class="flex-1 py-3 font-semibold text-slate-400 border-b-2 border-transparent transition">
                注册
              </button>
            </div>

            <div id="mobile-login-form" class="space-y-4">
              <div class="flex justify-center gap-2 pb-2">
                <button id="mobile-login-username-btn" class="px-4 py-2 rounded-lg bg-sky-100 text-sky-700 font-semibold text-sm">
                  用户名登录
                </button>
                <button id="mobile-login-phone-btn" class="px-4 py-2 rounded-lg bg-slate-100 text-slate-600 text-sm">
                  手机号登录
                </button>
              </div>

              <div class="mobile-form-group">
                <label class="mobile-form-label" id="mobile-login-label">用户名</label>
                <div id="mobile-username-container" class="mt-1">
                  <input type="text" id="mobile-auth-username" class="w-full" placeholder="请输入用户名" autocomplete="username">
                </div>
              </div>

              <div id="mobile-password-section" class="mobile-form-group">
                <div class="flex justify-between items-center mb-2">
                  <label class="mobile-form-label !mb-0">密码</label>
                  <button type="button" id="mobile-switch-to-sms" class="text-sm text-sky-600 hover:text-sky-700 hidden">
                    使用验证码
                  </button>
                </div>
                <input type="password" id="mobile-auth-password" class="w-full" placeholder="请输入密码" autocomplete="current-password">
              </div>

              <div id="mobile-sms-section" class="mobile-form-group hidden">
                <div class="flex justify-between items-center mb-2">
                  <label class="mobile-form-label !mb-0">验证码</label>
                  <button type="button" id="mobile-switch-to-password" class="text-sm text-sky-600 hover:text-sky-700">
                    使用密码
                  </button>
                </div>
                <div class="flex gap-2">
                  <input type="text" id="mobile-auth-sms-code" class="w-full flex-1" placeholder="6位验证码" maxlength="6" inputmode="numeric">
                  <button type="button" id="mobile-auth-send-login-code" class="btn btn-primary whitespace-nowrap !py-0 !px-4 !text-base">
                    发送
                  </button>
                </div>
              </div>

              <!-- ========================================
                 【验证码区域】移动端登录表单验证码
                 ======================================== -->
              <div class="mobile-form-group">
                <label class="mobile-form-label">验证码</label>
                <div class="mt-1">
                  <div id="mobile-login-captcha-display" class="w-full h-auto flex items-center justify-center border border-slate-300 rounded bg-white cursor-pointer hover:border-sky-400 transition-colors" title="点击刷新验证码" style="min-height: 64px" onclick="refreshCaptcha('mobile-login')">
                    <span class="text-slate-400 text-xs">加载中...</span>
                  </div>
                </div>
                <div class="mt-2">
                  <button type="button" id="mobile-login-captcha-refresh" class="w-full py-2 px-4 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg transition-colors text-sm font-medium" title="刷新验证码" onclick="refreshCaptcha('mobile-login')">
                    刷新验证码
                  </button>
                </div>
                <div class="mt-2">
                  <input type="text" id="mobile-login-captcha" class="w-full" placeholder="请输入验证码" maxlength="6" autocomplete="off">
                </div>
              </div>

              <button id="mobile-login-btn" class="mobile-primary-btn">
                登录
              </button>

              <div id="mobile-guest-login-section" class="text-center hidden">
                <div class="relative flex py-2 items-center">
                  <div class="flex-grow border-t border-slate-200"></div>
                  <span class="flex-shrink mx-4 text-slate-400 text-xs">或</span>
                  <div class="flex-grow border-t border-slate-200"></div>
                </div>
                <button id="mobile-guest-btn" class="mobile-secondary-btn">
                  以游客身份继续
                </button>
                <div class="mt-4 p-3 rounded-lg bg-amber-50 border border-amber-200 text-left">
                  <div class="flex items-start gap-2">
                    <svg class="w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z"></path>
                    </svg>
                    <div class="text-xs text-amber-800">
                      <p class="font-semibold mb-1">⚠️ 游客模式提示</p>
                      <ul class="space-y-1">
                        <li>• 游客使用UUID恢复状态，请务必保存地址</li>
                        <li>• 丢失URL将无法恢复您的数据和进度</li>
                        <li>• 5分钟不活跃会话将被自动清理</li>
                        <li>• 建议注册账号以获得更好的体验</li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div id="mobile-register-form" class="space-y-4 hidden">
              <div class="mobile-form-group">
                <label class="mobile-form-label">用户名</label>
                <input type="text" id="mobile-reg-username" class="w-full" placeholder="3-20字符，不含中文" autocomplete="username">
              </div>

              <div class="mobile-form-group">
                <label class="mobile-form-label">手机号</label>
                <div class="phone-input-wrapper mt-1">
                  <span class="phone-prefix">+86 </span>
                  <input type="tel" id="mobile-reg-phone" class="input-field" placeholder="请输入手机号" autocomplete="tel" inputmode="numeric" maxlength="11" pattern="[0-9]*">
                </div>
              </div>

              <div class="mobile-form-group">
                <label class="mobile-form-label">验证码</label>
                <div class="flex gap-2">
                  <input type="text" id="mobile-reg-sms-code" class="w-full flex-1" placeholder="6位验证码" maxlength="6" inputmode="numeric">
                  <button id="mobile-reg-send-code-btn" class="btn btn-primary whitespace-nowrap !py-0 !px-4 !text-base">
                    发送
                  </button>
                </div>
              </div>

              <div class="mobile-form-group">
                <label class="mobile-form-label">昵称</label>
                <input type="text" id="mobile-reg-nickname" class="w-full" placeholder="请输入昵称（可含中文）">
              </div>

              <div class="mobile-form-group" id="mobile-reg-avatar-group">
                <label class="mobile-form-label">头像</label>
                <div class="flex items-center gap-3 mt-1">
                  <img id="mobile-reg-avatar-preview" src="/static/default_avatar.png" class="w-16 h-16 rounded-full object-cover border-2 border-slate-200">
                  <input type="file" id="mobile-reg-avatar" accept="image/*" class="hidden">
                  <button class="btn btn-ghost border border-slate-300 !py-1.5 !px-3 text-sm" id="mobile-reg-upload-avatar-btn" onclick="document.getElementById('mobile-reg-avatar').click(); return false;">
                    <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path>
                    </svg>
                    上传头像
                  </button>
                </div>
              </div>

              <div class="mobile-form-group">
                <label class="mobile-form-label">密码</label>
                <input type="password" id="mobile-reg-password" class="w-full" placeholder="请输入密码（至少6字符）" autocomplete="new-password">
              </div>

              <div class="mobile-form-group">
                <label class="mobile-form-label">确认密码</label>
                <input type="password" id="mobile-reg-password-confirm" class="w-full" placeholder="请再次输入密码" autocomplete="new-password">
              </div>

              <!-- ========================================
                 【验证码区域】移动端注册表单验证码
                 ======================================== -->
              <div class="mobile-form-group">
                <label class="mobile-form-label">验证码</label>
                <div class="mt-1">
                  <div id="mobile-register-captcha-display" class="w-full h-auto flex items-center justify-center border border-slate-300 rounded bg-white cursor-pointer hover:border-sky-400 transition-colors" title="点击刷新验证码" style="min-height: 64px" onclick="refreshCaptcha('mobile-register')">
                    <span class="text-slate-400 text-xs">加载中...</span>
                  </div>
                </div>
                <div class="mt-2">
                  <button type="button" id="mobile-register-captcha-refresh" class="w-full py-2 px-4 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg transition-colors text-sm font-medium" title="刷新验证码" onclick="refreshCaptcha('mobile-register')">
                    刷新验证码
                  </button>
                </div>
                <div class="mt-2">
                  <input type="text" id="mobile-register-captcha" class="w-full" placeholder="请输入验证码" maxlength="6" autocomplete="off">
                </div>
              </div>

              <button id="mobile-register-btn" class="mobile-primary-btn" style="
                  background: linear-gradient(135deg, #10b981 0%, #059669 100%);
                  box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
                ">
                注册
              </button>
            </div>

            <div id="mobile-auth-2fa-form" class="space-y-4 hidden">
              <div class="text-center mb-4">
                <h3 class="font-bold text-lg text-slate-800">两步验证</h3>
                <p class="text-sm text-slate-600 mt-2">请输入您的验证码</p>
              </div>

              <div class="mobile-form-group">
                <label class="mobile-form-label">验证码</label>
                <input type="text" id="mobile-2fa-code" class="w-full" placeholder="请输入6位验证码" maxlength="6" inputmode="numeric" autocomplete="one-time-code">
              </div>

              <button id="mobile-2fa-submit-btn" class="mobile-primary-btn">
                验证
              </button>

              <div class="text-center">
                <button id="mobile-2fa-back-btn" class="text-sky-600 text-sm font-medium">
                  返回登录
                </button>
              </div>
            </div>

            <div id="mobile-auth-error" class="hidden mt-4 p-3 rounded-lg bg-red-50 border border-red-200 text-red-600 text-sm text-center"></div>

            <div id="mobile-auth-success" class="hidden mt-4 p-3 rounded-lg bg-green-50 border border-green-200 text-green-600 text-sm text-center"></div>
          </div>
        </div>

        <!-- ========================================
           【容器2】移动端登录容器（三栏布局）
           ======================================== -->
        <div id="mobile-login-container" class="space-y-4 hidden">
          <!-- ========================================
             【区域1】单账号登录面板卡片（已调整顺序，原为区域3）
             ======================================== -->
          <div class="mobile-card" id="mobile-single-login-card">
            <h3 class="text-lg font-bold text-slate-800 mb-4">单账号登录</h3>
            <p class="text-slate-500 text-sm">掌上莲峰跑步助手</p>

            <div class="mobile-form-group">
              <label class="mobile-form-label">选择用户</label>
              <select id="mobile-user-combo" class="w-full">
                <option value="">请选择用户</option>
              </select>
            </div>

            <div class="mobile-form-group">
              <label class="mobile-form-label">用户名</label>
              <input type="text" id="mobile-username-entry" class="w-full" placeholder="请输入学号或工号" autocomplete="username">
            </div>

            <div class="mobile-form-group">
              <label class="mobile-form-label">密码</label>
              <input type="password" id="mobile-password-entry" class="w-full" placeholder="请输入密码，一般为身份证后六位" autocomplete="current-password">
            </div>

            <button id="mobile-single-login-btn" class="mobile-primary-btn">
              登录
            </button>

            <!-- ========================================
               【分隔线】用于视觉区分主要操作和次要操作
               ======================================== -->
            <div class="relative flex py-2 items-center">
              <div class="flex-grow border-t border-slate-300"></div>
            </div>

            <!-- ========================================
               【导入离线文件按钮】移动端版本
               ======================================== -->
            <button id="mobile-import-button" class="w-full py-3 px-4 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white rounded-lg font-bold shadow-lg transition-all duration-300 flex items-center justify-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
              </svg>
              <span>导入离线文件</span>
            </button>

            <!-- ========================================
               【User-Agent 显示区域】移动端版本
               ======================================== -->
            <div class="pt-4 space-y-3 border-t border-slate-200">
              <div class="flex justify-between items-center">
                <span class="text-sm font-semibold text-slate-600 flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                  User-Agent 标识
                </span>

                <button id="mobile-random-ua-btn" title="随机生成新的User-Agent，用于模拟不同设备和浏览器" class="py-1.5 px-3 text-xs bg-slate-100 hover:bg-sky-100 text-slate-700 rounded-lg transition-colors flex items-center gap-1">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                  </svg>
                  <span>随机</span>
                </button>
              </div>

              <p id="mobile-ua-label" class="text-xs text-slate-600 break-all bg-gradient-to-br from-white to-slate-50 border border-slate-300 p-3 rounded-xl leading-relaxed shadow-inner">
                (未加载)
              </p>
            </div>
          </div>

          <!-- ========================================
             【区域2】多账号模式入口卡片
             ======================================== -->
          <div class="mobile-card" id="mobile-multi-account-card">
            <div class="text-center mb-4">
              <div class="inline-block p-4 bg-violet-100 rounded-full">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-12 h-12 text-violet-600" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05c1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"></path>
                </svg>
              </div>
            </div>

            <h2 class="mobile-title text-center">多账号模式</h2>
            <p class="mobile-subtitle text-center">
              批量管理多个账号，一键执行任务
            </p>

            <div class="space-y-3 mb-6">
              <div class="flex items-center">
                <span class="text-2xl mr-3">✨</span>
                <span class="text-slate-700">支持批量导入账号</span>
              </div>
              <div class="flex items-center">
                <span class="text-2xl mr-3">🎯</span>
                <span class="text-slate-700">统一管理所有任务</span>
              </div>
              <div class="flex items-center">
                <span class="text-2xl mr-3">⚡</span>
                <span class="text-slate-700">一键执行全部流程</span>
              </div>
            </div>

            <button id="mobile-multi-account-btn" class="mobile-primary-btn" style="
                background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
                box-shadow: 0 4px 12px rgba(139, 92, 246, 0.4);
              ">
              进入多账号控制台
            </button>
          </div>

          <!-- ========================================
             【区域3】会话管理面板卡片
             ======================================== -->
          <div class="mobile-card relative overflow-hidden !p-5" id="mobile-session-panel-card" style="min-height: 400px">
            <div class="absolute -top-10 -right-10 w-40 h-40 bg-gradient-to-br from-sky-100/50 to-blue-100/50 rounded-full blur-3xl pointer-events-none"></div>
            <div class="absolute -bottom-10 -left-10 w-32 h-32 bg-gradient-to-tr from-indigo-100/50 to-purple-100/50 rounded-full blur-3xl pointer-events-none"></div>

            <div class="relative flex items-center justify-between mb-6">
              <div class="flex items-center gap-3">
                <div class="w-12 h-12 rounded-2xl bg-white shadow-md border border-slate-100 flex items-center justify-center text-sky-600">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                  </svg>
                </div>
                <div>
                  <h3 class="text-xl font-bold text-slate-800 tracking-tight">
                    会话列表
                  </h3>
                  <div id="mobile-session-count-display" class="text-xs font-medium mt-0.5">
                    统计中...
                  </div>
                </div>
              </div>

              <button id="mobile-refresh-sessions-btn" class="flex items-center justify-center bg-slate-50 hover:bg-sky-50 text-slate-500 hover:text-sky-600 rounded-xl transition-all active:scale-90 border border-transparent hover:border-sky-100" title="刷新列表">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                </svg>
              </button>
            </div>

            <div id="mobile-session-guest-msg" class="hidden mb-6 p-4 bg-blue-50 border border-blue-200 rounded-2xl text-center shadow-sm">
              <div class="flex flex-col items-center gap-2">
                <span class="text-2xl">👋</span>
                <p class="text-sm text-blue-700 font-bold">游客模式</p>
                <p class="text-xs text-blue-600/80 leading-relaxed px-2">
                  当前会话如下。<br>如需使用多个会话或保存数据，请注册账号。
                </p>
              </div>
            </div>

            <button onclick="createNewSessionFromPicker()" id="mobile-create-session-btn" class="group relative w-full py-4 px-4 mb-6 bg-gradient-to-r from-sky-500 to-blue-600 hover:from-sky-600 hover:to-blue-700 text-white rounded-2xl text-sm font-bold shadow-lg shadow-blue-200/50 transition-all active:scale-[0.98] overflow-hidden">
              <div class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></div>
              <div class="relative flex items-center justify-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M12 4v16m8-8H4"></path>
                </svg>
                <span>创建新会话</span>
              </div>
            </button>

            <div id="mobile-sessions-list" class="space-y-3 max-h-[50vh] overflow-y-auto pr-1 pb-2 scrollbar-hide">
              <div class="flex flex-col items-center justify-center py-12 text-slate-400">
                <div class="w-8 h-8 border-4 border-sky-100 border-t-sky-500 rounded-full animate-spin mb-3"></div>
                <span class="text-xs font-medium">正在同步会话数据...</span>
              </div>
            </div>

            <div class="mt-2 pt-3 border-t border-slate-100 text-center">
              <p class="text-[10px] text-slate-400 flex items-center justify-center gap-1">
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                长按会话可删除，点击即可切换
              </p>
            </div>
          </div>

          <!-- ========================================
             【快速操作卡片】
             ======================================== -->
          <div class="mobile-card hidden" id="mobile-quick-actions">
            <h2 class="mobile-title">快速操作</h2>

            <div class="space-y-3">
              <button class="mobile-list-item justify-between">
                <div class="flex items-center">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-sky-600 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                  <span class="font-medium">开始跑步</span>
                </div>
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-slate-400" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                </svg>
              </button>

              <button class="mobile-list-item justify-between">
                <div class="flex items-center">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-green-600 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                  <span class="font-medium">查看任务</span>
                </div>
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-slate-400" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                </svg>
              </button>

              <button class="mobile-list-item justify-between">
                <div class="flex items-center">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-purple-600 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                  <span class="font-medium">历史记录</span>
                </div>
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-slate-400" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                </svg>
              </button>

              <button class="mobile-list-item justify-between">
                <div class="flex items-center">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-orange-600 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                  </svg>
                  <span class="font-medium">设置</span>
                </div>
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-slate-400" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                </svg>
              </button>
            </div>
          </div>
        </div>

        <!-- ========================================
           【容器3】移动端主应用界面
           ======================================== -->

        <div id="mobile-loading-overlay" class="fixed inset-0 z-50 flex flex-col items-center justify-center gap-6 bg-white/90 backdrop-blur-sm hidden">
          <div class="flex flex-col items-center gap-4">
            <div class="w-16 h-16 border-4 border-sky-200 border-t-sky-600 rounded-full animate-spin"></div>
            <p class="text-slate-600 text-sm font-medium">加载中，请稍候...</p>
          </div>
        </div>

        <div id="mobile-main-app" class="space-y-4 hidden">
          <!-- ========================================
             【通知面板】- 显示系统通知和签到任务
             ======================================== -->
          <div class="mobile-card p-0 overflow-hidden h-screen flex flex-col max-h-full" id="mobile-notification-panel">
            <div class="relative flex items-center justify-center mb-5 pb-4 border-b-2 border-sky-200">
              <div class="flex items-center gap-3">
                <div class="flex-shrink-0 w-10 h-10 rounded-full bg-gradient-to-br from-sky-500 to-sky-600 flex items-center justify-center shadow-lg relative">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
                  </svg>
                  <span id="mobile-notification-badge" class="hidden absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center shadow-md animate-pulse">
                  </span>
                </div>
                <h3 class="text-2xl font-bold text-sky-700 tracking-tight">
                  通知中心
                </h3>
              </div>
            </div>

            <div id="mobile-all-notifications-list" class="space-y-3 h-full overflow-y-auto pr-2">
              <div class="text-center py-12">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-20 h-20 mx-auto text-slate-300 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
                </svg>
                <p class="text-slate-400 text-sm font-medium">暂无通知</p>
                <p class="text-slate-300 text-xs mt-1">
                  点击底部刷新按钮获取最新通知
                </p>
              </div>
            </div>

            <div class="flex gap-3 mt-5 pt-4 border-t-2 border-slate-100">
              <button id="mobile-refresh-notifications-btn" type="button" aria-label="刷新通知" class="flex-1 py-3 px-4 bg-gradient-to-r from-sky-500 to-sky-600 text-white rounded-xl text-sm font-bold hover:from-sky-600 hover:to-sky-700 transition-all duration-200 flex items-center justify-center gap-2 shadow-md hover:shadow-lg" onclick="mobileRefreshNotifications()">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                </svg>
                刷新
              </button>

              <button id="mobile-mark-all-read-modal-btn" class="flex-1 py-3 px-4 bg-gradient-to-r from-slate-500 to-slate-600 text-white rounded-xl text-sm font-bold hover:from-slate-600 hover:to-slate-700 transition-all duration-200 flex items-center justify-center gap-2 shadow-md hover:shadow-lg" onclick="mobileMarkAllAsRead()">
                一键已读
              </button>

              <button class="flex-1 py-3 px-4 bg-gradient-to-r from-slate-100 to-slate-200 text-slate-700 rounded-xl text-sm font-bold hover:from-slate-200 hover:to-slate-300 transition-all duration-200 flex items-center justify-center gap-2 shadow-sm" style="display: none" onclick="expandMobileNotifications()">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
                </svg>
                查看更多
              </button>
            </div>
          </div>

          <!-- ========================================
             【任务列表面板】
             ======================================== -->
          <div class="mobile-card p-0 overflow-hidden h-screen flex flex-col" id="mobile-task-panel">
            <div class="flex items-center justify-between mb-4 pb-3 border-b border-green-100 p-4">
              <div class="flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path>
                </svg>
                <h3 class="text-xl font-bold text-green-700">任务列表</h3>
              </div>
              <div class="text-sm text-slate-600 bg-green-50 px-3 py-1 rounded-full" id="mobile-task-count">
                0 个任务
              </div>
            </div>

            <div id="mobile-task-list" class="space-y-2 flex-1 overflow-y-auto px-4">
              <p class="text-slate-400 text-center py-8 text-sm">暂无任务</p>
            </div>

            <div class="grid grid-cols-2 gap-2 mt-auto border-t border-slate-100 p-4">
              <button class="py-2 px-4 bg-green-50 text-green-600 rounded-lg text-sm font-medium hover:bg-green-100 transition flex items-center justify-center gap-1" onclick="mobileRefreshTasks()">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                </svg>
                刷新
              </button>
              <button class="py-2 px-4 bg-blue-50 text-blue-600 rounded-lg text-sm font-medium hover:bg-blue-100 transition flex items-center justify-center gap-1" onclick="mobileAddTask()" style="display: none">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                </svg>
                新增
              </button>
            </div>
          </div>

          <!-- ========================================
             【地图显示面板】
             ======================================== -->
          <div class="mobile-card p-0 overflow-hidden h-screen flex flex-col" id="mobile-map-panel">
            <div id="mobile-map-container" class="w-full flex-1 relative bg-slate-100" style="height: calc(100vh - 60px)">
              <div class="absolute inset-0 flex items-center justify-center text-slate-400">
                <div class="text-center">
                  <svg class="w-12 h-12 mx-auto mb-2 text-slate-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path>
                  </svg>
                  <p class="text-sm">地图加载中...</p>
                </div>
              </div>

              <button id="mobile-map-reset-btn" class="absolute top-4 right-4 p-2 bg-white rounded-lg shadow-lg border border-slate-200 hover:bg-slate-50 transition z-10" style="display: none" onclick="resetMobileMapView()" title="复位视角">
                <svg class="w-5 h-5 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path>
                </svg>
              </button>
            </div>

            <div class="flex gap-2 p-3 bg-slate-50 flex-shrink-0">
              <button class="flex-1 py-2 px-3 bg-white border border-slate-200 text-slate-600 rounded-lg text-xs font-medium hover:bg-slate-50 transition" onclick="mobileZoomIn()">
                放大 +
              </button>
              <button class="flex-1 py-2 px-3 bg-white border border-slate-200 text-slate-600 rounded-lg text-xs font-medium hover:bg-slate-50 transition" onclick="mobileZoomOut()">
                缩小 -
              </button>
              <button class="flex-1 py-2 px-3 bg-white border border-slate-200 text-slate-600 rounded-lg text-xs font-medium hover:bg-slate-50 transition" onclick="mobileFitView()">
                适应 ⊡
              </button>
              <button class="flex-1 py-2 px-3 bg-white border border-slate-200 text-slate-600 rounded-lg text-xs font-medium hover:bg-slate-50 transition" onclick="resetMobileMapView()">
                复位 ⊙
              </button>
            </div>
          </div>

          <!-- ========================================
             【控制面板】- 任务执行控制
             ======================================== -->
          <div class="mobile-card" id="mobile-control-panel">
            <div class="flex items-center gap-2 mb-4 pb-3 border-b border-orange-100">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-orange-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path>
              </svg>
              <h3 class="text-xl font-bold text-orange-700">控制面板</h3>
            </div>

            <div class="mb-4 p-3 bg-slate-50 rounded-lg">
              <div class="flex items-center justify-between mb-2">
                <span class="text-sm font-medium text-slate-600">当前状态</span>
                <span id="mobile-status-indicator" class="text-xs font-semibold px-2 py-1 rounded-full bg-slate-200 text-slate-600">
                  未启动
                </span>
              </div>
              <div class="text-xs text-slate-500" id="mobile-status-detail">
                等待执行任务
              </div>
            </div>

            <div class="grid grid-cols-2 gap-3 mb-4">
              <button id="mobile-start-btn" class="py-3 px-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl text-sm font-bold shadow-lg hover:shadow-xl transition flex items-center justify-center gap-2" onclick="mobileStartTask()">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"></path>
                </svg>
                开始
              </button>

              <button id="mobile-stop-btn" class="py-3 px-4 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl text-sm font-bold shadow-lg hover:shadow-xl transition flex items-center justify-center gap-2" onclick="mobileStopTask()" disabled="">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z" clip-rule="evenodd"></path>
                </svg>
                停止
              </button>
            </div>

            <div class="grid grid-cols-3 gap-2" style="display: none">
              <button class="py-2 px-2 bg-blue-50 text-blue-600 rounded-lg text-xs font-medium hover:bg-blue-100 transition flex flex-col items-center justify-center gap-1" onclick="mobilePauseTask()">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                </svg>
                暂停
              </button>
              <button class="py-2 px-2 bg-purple-50 text-purple-600 rounded-lg text-xs font-medium hover:bg-purple-100 transition flex flex-col items-center justify-center gap-1" onclick="mobileResumeTask()">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"></path>
                </svg>
                继续
              </button>
              <button class="py-2 px-2 bg-slate-100 text-slate-600 rounded-lg text-xs font-medium hover:bg-slate-200 transition flex flex-col items-center justify-center gap-1" onclick="mobileResetTask()">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                </svg>
                重置
              </button>
            </div>

            <div class="mt-4 pt-3 border-t border-slate-100" style="display: none">
              <div class="flex justify-between items-center mb-2">
                <span class="text-xs text-slate-600">任务进度</span>
                <span id="mobile-progress-text" class="text-xs font-semibold text-sky-600">0%</span>
              </div>
              <div class="w-full bg-slate-200 rounded-full h-2 overflow-hidden">
                <div id="mobile-progress-bar" class="bg-gradient-to-r from-sky-500 to-blue-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
              </div>
            </div>

            <!-- ========== 任务统计块 ========== -->
            <div id="mobile-run-stats-block" class="mt-4 p-3 bg-gradient-to-br from-emerald-50 to-teal-50 border border-emerald-200 rounded-xl text-center">
              <p class="text-xs text-slate-600 mb-1">已选任务总览</p>
              <p id="mobile-run-stats-label" class="font-bold text-lg text-emerald-600">
                -- km / --:--
              </p>
            </div>

            <!-- ========== 单任务进度条 ========== -->
            <div id="mobile-single-progress-block" class="mt-3 p-3 bg-slate-50 rounded-xl">
              <div class="h-2 bg-slate-200 rounded-full overflow-hidden mb-2">
                <div id="mobile-single-progress-fill" class="h-2 bg-gradient-to-r from-sky-500 to-blue-500 transition-all duration-300" style="width: 0%"></div>
              </div>
              <div class="flex justify-between text-xs">
                <span id="mobile-single-progress-text" class="text-slate-600">未开始</span>
                <span id="mobile-single-progress-extra" class="text-slate-400"></span>
              </div>
            </div>

            <!-- ========== 执行选项复选框 ========== -->
            <div class="mt-4 pt-3 border-t border-slate-100 flex flex-col gap-2" style="display: none">
              <label class="flex items-center gap-2 cursor-pointer p-2 bg-amber-50 rounded-lg hover:bg-amber-100 transition">
                <input type="checkbox" id="mobile-run-completed-check" class="w-4 h-4 accent-sky-600 rounded flex-shrink-0">
                <span class="text-xs text-slate-700 font-semibold">忽略已完成状态</span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer p-2 bg-blue-50 rounded-lg hover:bg-blue-100 transition" style="display: none">
                <input type="checkbox" id="mobile-auto-gen-all-check" class="w-4 h-4 accent-sky-600 rounded flex-shrink-0" checked="">
                <span class="text-xs text-slate-700 font-semibold">自动生成路径</span>
              </label>
            </div>

            <!-- ========== 实时状态面板 ========== -->
            <div class="mt-4 pt-3 border-t border-slate-100">
              <h4 class="text-xs font-semibold text-slate-700 mb-2 flex items-center gap-1">
                <svg class="w-4 h-4 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                </svg>
                实时状态
              </h4>
              <div class="grid grid-cols-2 gap-2" id="mobile-live-stats-grid">
                <div class="p-2 bg-blue-50 rounded-lg text-center">
                  <p class="text-xs text-slate-500 mb-1">已跑距离</p>
                  <p id="mobile-live-dist-label" class="font-bold text-sm text-blue-600">
                    0.00 km
                  </p>
                </div>
                <div class="p-2 bg-green-50 rounded-lg text-center">
                  <p class="text-xs text-slate-500 mb-1">总距离</p>
                  <p id="mobile-total-dist-label" class="font-bold text-sm text-green-600">
                    0.00 km
                  </p>
                </div>
                <div class="p-2 bg-purple-50 rounded-lg text-center">
                  <p class="text-xs text-slate-500 mb-1">已用时间</p>
                  <p id="mobile-live-time-label" class="font-bold text-sm text-purple-600">
                    00:00
                  </p>
                </div>
                <div class="p-2 bg-orange-50 rounded-lg text-center">
                  <p class="text-xs text-slate-500 mb-1">预计时间</p>
                  <p id="mobile-total-time-label" class="font-bold text-sm text-orange-600">
                    00:00
                  </p>
                </div>
              </div>
              <div class="mt-2 text-center">
                <p id="mobile-current-location-label" class="text-xs font-mono text-slate-500">
                  当前位置: --, --
                </p>
              </div>
            </div>
          </div>

          <!-- ========================================
             【日志面板】
             ======================================== -->
          <div class="mobile-card mobile-card-fullscreen hidden" id="mobile-log-panel">
            <div class="flex items-center gap-2 mb-4 pb-3 border-b border-slate-100">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-slate-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
              </svg>
              <h3 class="text-xl font-bold text-slate-700">运行日志</h3>
            </div>
            <div class="flex-1 overflow-hidden rounded-lg p-3">
              <textarea id="mobile-log-text" readonly="" class="w-full h-full bg-white text-slate-800 font-mono text-xs border border-slate-300 rounded-lg resize-none outline-none p-3" placeholder="等待日志输出..."></textarea>
            </div>

            <div class="flex gap-2 mt-4 pt-3 border-t border-slate-100">
              <button class="flex-1 py-2 px-4 bg-red-50 text-red-600 rounded-lg text-sm font-medium hover:bg-red-100 transition flex items-center justify-center gap-1" onclick="clearMobileMultiLog()">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                </svg>
                清空日志
              </button>
              <button class="flex-1 py-2 px-4 bg-slate-100 text-slate-600 rounded-lg text-sm font-medium hover:bg-slate-200 transition flex items-center justify-center gap-1" onclick="scrollMobileMultiLogToBottom()">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
                </svg>
                滚到底部
              </button>
            </div>
          </div>

          <!-- ========================================
            【打卡点面板】
             ======================================== -->
          <div class="mobile-card flex flex-col h-full" id="mobile-checkpoints-panel">
            <div class="flex-none flex items-center justify-between mb-4 pb-3 border-b border-red-100">
              <div class="flex items-center gap-2">
                <svg class="w-6 h-6 text-red-500" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path>
                </svg>
                <h3 class="text-xl font-bold text-red-700">打卡点</h3>
              </div>
            </div>

            <div class="flex-none mb-4 p-3 bg-blue-50 rounded-lg border border-blue-200">
              <p class="text-xs text-blue-700 font-medium" id="mobile-checkpoints-task-info">
                请先选择一个任务以查看打卡点
              </p>
            </div>

            <div id="mobile-checkpoints-list" class="flex-1 overflow-y-auto space-y-2 min-h-0">
              <p class="text-slate-400 text-center py-8 text-sm">
                开始任务后将显示打卡点
              </p>
            </div>

            <div class="flex-none mt-4 pt-3 border-t border-gray-100">
              <button onclick="renderMobileCheckpointsList(); showModalAlert('打卡点列表已刷新', '成功');" class="w-full py-3 px-4 bg-red-50 text-red-600 rounded-lg text-sm font-medium hover:bg-red-100 transition flex items-center justify-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                </svg>
                刷新列表
              </button>
            </div>
          </div>

          <div class="mobile-card h-full flex flex-col" id="mobile-task-history-panel">
            <div class="flex-none flex items-center gap-2 mb-4 pb-3 border-b border-amber-100">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-amber-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <h3 class="text-xl font-bold text-amber-700">历史记录</h3>
            </div>

            <div class="flex-none mb-4 p-3 bg-amber-50 rounded-lg border border-amber-200">
              <p class="text-xs text-amber-700 font-medium" id="mobile-history-task-info">
                请先选择一个任务以查看历史记录
              </p>
            </div>

            <div id="mobile-task-history-list" class="flex-1 overflow-y-auto space-y-2 min-h-0">
              <p class="text-slate-400 text-center py-8 text-sm">加载中...</p>
            </div>

            <div class="flex-none pt-3 mt-4 border-t border-amber-100">
              <button onclick="loadMobileTaskHistoryPanel()" class="w-full py-3 bg-amber-50 text-amber-600 rounded-lg text-sm font-bold hover:bg-amber-100 transition shadow-sm border border-amber-200 flex items-center justify-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                </svg>
                刷新列表
              </button>
            </div>
          </div>

          <!-- ========================================
             【签到面板】- 单账号签到功能
             ======================================== -->
          <div class="mobile-card" id="mobile-attendance-panel">
            <div class="flex items-center gap-3 mb-5 pb-4 border-b-2 border-blue-200">
              <div class="flex-shrink-0 w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center shadow-lg">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
              </div>
              <h3 class="text-2xl font-bold text-blue-700 tracking-tight">
                自动签到
              </h3>
            </div>

            <div class="bg-white rounded-xl shadow-md p-4 mb-5 border border-blue-100">
              <div class="flex items-center gap-2 mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                </svg>
                <h4 class="text-base font-bold text-slate-800">参数配置</h4>
              </div>

              <div class="space-y-4">
                <label class="flex items-center gap-3 cursor-pointer p-4 bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl hover:from-blue-100 hover:to-blue-150 transition-all duration-200 shadow-sm">
                  <input type="checkbox" id="mobile-param-auto_attendance_enabled" data-key="auto_attendance_enabled" class="w-6 h-6 accent-blue-600 rounded-md cursor-pointer flex-shrink-0 shadow-sm">
                  <div class="flex-1">
                    <span class="text-slate-800 font-bold block text-base">🎯 开启自动签到</span>
                    <span class="text-xs text-slate-600 mt-1 block">后台自动刷新通知并尝试签到</span>
                  </div>
                </label>

                <div class="bg-slate-50 rounded-xl p-4 space-y-2">
                  <div class="flex items-center gap-2 mb-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                    </svg>
                    <label class="text-sm text-slate-700 font-bold">⏰ 刷新间隔</label>
                  </div>
                  <div class="flex items-center gap-3">
                    <input type="number" step="30" id="mobile-param-auto_attendance_refresh_s" data-key="auto_attendance_refresh_s" class="flex-1 px-4 py-3 bg-white border-2 border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all shadow-sm font-semibold text-slate-700" placeholder="60" title="自动刷新通知的间隔时间（秒），建议不低于60">
                    <span class="text-sm text-slate-600 font-semibold flex-shrink-0 bg-white px-3 py-2 rounded-lg border border-slate-200">秒</span>
                  </div>
                </div>

                <div class="bg-slate-50 rounded-xl p-4 space-y-2">
                  <div class="flex items-center gap-2 mb-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    </svg>
                    <label class="text-sm text-slate-700 font-bold">📍 随机半径</label>
                  </div>
                  <div class="flex items-center gap-3">
                    <input type="number" step="1" id="mobile-param-attendance_user_radius_m" data-key="attendance_user_radius_m" class="flex-1 px-4 py-3 bg-white border-2 border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all shadow-sm font-semibold text-slate-700" placeholder="0" title="自动签到时，在服务器允许范围内的最大随机偏移半径。设为0为精确签到。">
                    <span class="text-sm text-slate-600 font-semibold flex-shrink-0 bg-white px-3 py-2 rounded-lg border border-slate-200">米</span>
                  </div>
                </div>
              </div>
              <div class="flex gap-3 mt-4 pt-3 border-t border-slate-100">
                <button onclick="switchMobileSinglePanel('mobile-attendance-panel')" class="flex-1 py-2.5 px-4 bg-slate-100 text-slate-600 rounded-xl text-sm font-bold hover:bg-slate-200 transition flex items-center justify-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                  </svg>
                  重置
                </button>
                <button onclick="saveMobileAttendanceParams()" class="flex-1 py-2.5 px-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl text-sm font-bold hover:from-blue-600 hover:to-blue-700 transition shadow-md flex items-center justify-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                  </svg>
                  保存配置
                </button>
              </div>
            </div>

            <div class="bg-white rounded-xl shadow-md p-4 border border-blue-100">
              <div class="flex justify-between items-center mb-4 pb-3 border-b-2 border-slate-100">
                <div class="flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path>
                  </svg>
                  <h4 class="text-base font-bold text-slate-800">
                    📋 签到任务
                  </h4>
                </div>
                <button id="mobile-refresh-attendance-list-btn" class="py-2 px-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg text-sm font-bold hover:from-blue-600 hover:to-blue-700 transition-all duration-200 flex items-center gap-2 shadow-md hover:shadow-lg" onclick="refreshNotificationsUI(true, true)">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                  </svg>
                  刷新
                </button>
              </div>

              <div id="mobile-attendance-list" class="max-h-[40vh] overflow-y-auto space-y-2">
                <div class="text-center py-10">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-16 h-16 mx-auto text-slate-300 mb-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path>
                  </svg>
                  <p class="text-slate-400 text-sm font-medium">
                    点击"刷新"按钮查看签到任务
                  </p>
                </div>
              </div>
            </div>
          </div>

          <!-- ========================================
             【参数设置面板】- 单账号参数配置
             ======================================== -->
          <div class="mobile-card mobile-card-fullscreen hidden" id="mobile-settings-panel">
            <div class="flex items-center gap-2 mb-4 pb-3 border-b border-indigo-100">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
              </svg>
              <h3 class="text-xl font-bold text-indigo-700">参数设置</h3>
            </div>

            <div id="mobile-params-container" class="space-y-3 overflow-y-auto"></div>

            <div class="flex-shrink-0 pt-3 border-t border-indigo-100 flex gap-3 bg-white">
              <button onclick="refreshMobileSettings()" class="flex-1 py-2.5 px-4 bg-slate-100 text-slate-700 rounded-xl text-sm font-bold hover:bg-slate-200 transition flex items-center justify-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                </svg>
                刷新
              </button>
              <button onclick="saveMobileSettings()" class="flex-1 py-2.5 px-4 bg-indigo-500 text-white rounded-xl text-sm font-bold hover:bg-indigo-600 transition flex items-center justify-center gap-2 shadow-md">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                保存
              </button>
            </div>
          </div>

          <!-- ========================================
             任务详情面板
             ======================================== -->
          <div class="mobile-card h-screen w-full flex flex-col bg-white" id="mobile-task-details-panel">
            <div class="flex-shrink-0 flex items-center justify-between p-4 border-b border-sky-100">
              <div class="flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-sky-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                <h3 class="text-xl font-bold text-sky-700">任务详情</h3>
              </div>
            </div>

            <div id="mobile-task-details-panel-content" class="flex-1 overflow-y-auto space-y-4 p-4">
              <div id="mobile-task-details-empty" class="text-center py-10 h-full flex flex-col justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-16 h-16 mx-auto text-slate-300 mb-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                <p class="text-slate-400 text-sm">请先选择一个任务</p>
              </div>

              <div id="mobile-task-details-basic" class="bg-sky-50 border border-sky-100 rounded-xl p-4 space-y-3 hidden">
                <h5 class="font-semibold text-sky-900 text-sm flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                  基本信息
                </h5>
                <div id="mobile-task-details-basic-list" class="space-y-2 text-sm"></div>
              </div>

              <div id="mobile-task-details-time" class="bg-green-50 border border-green-100 rounded-xl p-4 space-y-3 hidden">
                <h5 class="font-semibold text-green-900 text-sm flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                  时间信息
                </h5>
                <div id="mobile-task-details-time-list" class="space-y-2 text-sm"></div>
              </div>

              <div id="mobile-task-details-points" class="bg-purple-50 border border-purple-100 rounded-xl p-4 space-y-3 hidden">
                <h5 class="font-semibold text-purple-900 text-sm flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                  </svg>
                  打卡点列表
                </h5>
                <div id="mobile-task-details-points-list" class="space-y-2"></div>
              </div>

              <div id="mobile-task-details-history" class="bg-amber-50 border border-amber-100 rounded-xl p-4 space-y-3 hidden" style="display: none">
                <h5 class="font-semibold text-amber-900 text-sm flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                  历史记录
                </h5>
                <div id="mobile-task-details-history-list" class="space-y-2 text-sm"></div>
              </div>
            </div>

            <div class="flex-shrink-0 p-4 border-t border-sky-100 bg-white">
              <button onclick="loadMobileTaskDetails()" class="w-full py-3 px-4 bg-sky-50 text-sky-600 rounded-xl text-sm font-bold hover:bg-sky-100 active:scale-[0.98] transition flex items-center justify-center gap-2 shadow-sm">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                </svg>
                刷新数据
              </button>
            </div>
          </div>
          <!-- ========================================
             【管理面板】单账号模式
             复用 mobile-admin-panel-unified 的设计语言
             ======================================== -->
          <div class="mobile-card mobile-card-fullscreen hidden relative overflow-hidden !p-5" id="mobile-admin-panel">
            <!-- 装饰性渐变背景圆圈：右上角天蓝色渐变 -->
            <div class="absolute -top-10 -right-10 w-40 h-40 bg-gradient-to-br from-sky-100/50 to-blue-100/50 rounded-full blur-3xl pointer-events-none"></div>
            <!-- 装饰性渐变背景圆圈：左下角紫色渐变 -->
            <div class="absolute -bottom-10 -left-10 w-32 h-32 bg-gradient-to-tr from-indigo-100/50 to-purple-100/50 rounded-full blur-3xl pointer-events-none"></div>

            <!-- 面板头部区域：包含图标、标题 -->
            <div class="relative flex items-center justify-between mb-6 flex-shrink-0">
              <!-- 左侧：图标和标题组合 -->
              <div class="flex items-center gap-3">
                <!-- 管理面板图标容器：白色背景圆角方形 -->
                <div class="w-12 h-12 rounded-2xl bg-white shadow-md border border-slate-100 flex items-center justify-center text-sky-600">
                  <!-- 齿轮图标：表示管理/设置功能 -->
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37 1 .608 2.296.07 2.572-1.065z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                  </svg>
                </div>
                <!-- 标题 -->
                <div>
                  <h3 class="text-xl font-bold text-slate-800 tracking-tight">
                    管理面板
                  </h3>
                  <div id="mobile-admin-panel-single-status" class="text-xs font-medium mt-0.5 text-slate-500">
                    单账号管理
                  </div>
                </div>
              </div>
            </div>

            <!-- 标签导航区域：水平滚动的标签按钮 -->
            <div id="mobile-admin-tabs-nav-panel" class="relative flex border-b-2 border-slate-200 overflow-x-auto gap-1 pb-0 mb-4 flex-shrink-0" style="scrollbar-width: none; -webkit-overflow-scrolling: touch"></div>

            <div id="mobile-admin-panel-content-panel" class="relative text-sm flex-1 overflow-y-auto min-h-0 pr-1">
              <div id="mobile-admin-users-panel-panel" class="space-y-3">
                <h4 class="font-semibold text-sm">用户列表</h4>
                <div class="flex justify-between items-center">
                  <div class="flex gap-2">
                    <button id="mobile-admin-create-user-panel" class="btn btn-primary !py-1 !px-2 text-xs">
                      新增
                    </button>
                    <button id="mobile-admin-refresh-users-panel" class="btn btn-ghost !py-1 !px-2 text-xs">
                      刷新
                    </button>
                  </div>
                </div>
                <div id="mobile-admin-users-list-panel" class="space-y-2 max-h-[50vh] overflow-y-auto">
                  <p class="text-slate-400 text-center py-10 text-xs">
                    加载中...
                  </p>
                </div>
              </div>

              <div id="mobile-admin-groups-panel-panel" class="hidden space-y-3">
                <div class="flex justify-between items-center">
                  <h4 class="font-semibold text-sm">权限组列表</h4>
                  <div class="flex gap-2">
                    <button id="mobile-admin-create-group-panel" class="btn btn-primary !py-1 !px-2 text-xs">
                      新增
                    </button>
                    <button id="mobile-admin-refresh-groups-panel" class="btn btn-ghost !py-1 !px-2 text-xs">
                      刷新
                    </button>
                  </div>
                </div>
                <div id="mobile-admin-groups-list-panel" class="space-y-2 max-h-[50vh] overflow-y-auto">
                  <p class="text-slate-400 text-center py-10 text-xs">
                    加载中...
                  </p>
                </div>
              </div>

              <div id="mobile-admin-logs-panel-panel" class="hidden space-y-3">
                <div class="flex justify-between items-center">
                  <h4 class="font-semibold text-sm">系统日志</h4>
                  <div class="flex gap-2">
                    <select id="mobile-log-limit-select-panel" class="text-xs border border-slate-300 rounded px-2 py-1">
                      <option value="100">100行</option>
                      <option value="200">200行</option>
                      <option value="500">500行</option>
                    </select>
                    <button id="mobile-admin-refresh-logs-panel" class="btn btn-ghost !py-1 !px-2 text-xs">
                      刷新
                    </button>
                  </div>
                </div>
                <div class="bg-slate-900 text-green-400 rounded-lg p-3 font-mono text-xs overflow-auto max-h-[45vh]">
                  <pre id="mobile-admin-logs-content-panel" class="whitespace-pre-wrap">加载中...</pre>
                </div>
                <div id="mobile-admin-logs-pagination-panel" class="flex justify-between items-center text-xs text-slate-600 pt-2 border-t border-slate-200">
                  <button id="mobile-log-prev-page-panel" class="btn btn-ghost !py-1 !px-2 text-xs">
                    上一页
                  </button>
                  <div class="flex items-center gap-2">
                    <select id="mobile-log-page-select-panel" class="text-xs border border-slate-300 rounded px-2 py-1">
                      <option value="1">第 1 / 1 页</option>
                    </select>
                    <span id="mobile-log-page-total-panel" class="text-xs text-slate-500">(共 0 行)</span>
                  </div>
                  <button id="mobile-log-next-page-panel" class="btn btn-ghost !py-1 !px-2 text-xs">
                    下一页
                  </button>
                </div>
              </div>

              <div id="mobile-admin-health-panel-panel" class="hidden space-y-3">
                <div class="flex justify-between items-center">
                  <h4 class="font-semibold text-sm">系统状态</h4>
                  <div class="flex items-center gap-2">
                    <label class="flex items-center gap-1 cursor-pointer">
                      <input type="checkbox" id="mobile-health-auto-refresh-toggle-panel" class="w-3 h-3 accent-sky-600 rounded" checked="">
                      <span class="text-xs text-slate-600">自动刷新
                        <span id="mobile-health-countdown-display-panel" class="font-semibold text-sky-600"></span>
                      </span>
                    </label>
                    <button id="mobile-admin-refresh-health-panel" class="btn btn-ghost !py-1 !px-2 text-xs">
                      刷新
                    </button>
                  </div>
                </div>
                <div id="mobile-admin-health-content-panel" class="space-y-3">
                  <p class="text-slate-400 text-center py-10 text-xs">
                    加载中...
                  </p>
                </div>
              </div>

              <div id="mobile-admin-profile-panel-panel" class="hidden space-y-3">
                <div class="flex justify-between items-center">
                  <h4 class="font-semibold text-sm">个人信息</h4>
                  <button id="mobile-admin-refresh-profile-panel" class="btn btn-ghost !py-1 !px-2 text-xs">
                    刷新
                  </button>
                </div>
                <div id="mobile-admin-profile-content-panel" class="space-y-3 text-slate-800">
                  <div class="bg-slate-50 border border-slate-200 rounded-lg p-3 space-y-2">
                    <h5 class="font-semibold text-slate-700 text-xs">头像</h5>
                    <div class="flex items-center gap-3">
                      <img id="mobile-profile-avatar-display-panel" src="" alt="用户头像" class="w-16 h-16 rounded-full border-2 border-slate-200" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22100%22 height=%22100%22%3E%3Crect width=%22100%22 height=%22100%22 fill=%22%23ddd%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 font-size=%2240%22 text-anchor=%22middle%22 dy=%22.3em%22%3E👤%3C/text%3E%3C/svg%3E'">
                      <div class="flex-1">
                        <input type="file" id="mobile-profile-avatar-file-panel" accept="image/*" class="hidden">
                        <button class="btn btn-ghost border border-slate-300 !py-1 !px-2 text-xs" onclick="document.getElementById('mobile-profile-avatar-file-panel').click();">
                          选择图片
                        </button>
                      </div>
                    </div>
                  </div>
                  <div id="mobile-profile-details-panel" class="space-y-2"></div>
                </div>
              </div>

              <div id="mobile-admin-sessions-panel-panel" class="hidden space-y-3">
                <div class="flex justify-between items-center">
                  <h4 class="font-semibold text-sm">会话列表</h4>
                  <div class="flex items-center gap-2">
                    <label id="mobile-god-mode-toggle-panel" class="flex items-center gap-1 cursor-pointer" style="display: none">
                      <input type="checkbox" id="mobile-god-mode-checkbox-panel" class="w-3 h-3 accent-red-600 rounded">
                      <span class="text-xs font-semibold text-red-600">上帝模式</span>
                    </label>
                    <div id="mobile-admin-session-count-display-panel" class="text-xs text-slate-600"></div>
                    <button id="mobile-admin-refresh-sessions-panel" class="btn btn-ghost !py-1 !px-2 text-xs" onclick="loadMobileAdminSessionsList()">
                      刷新
                    </button>
                  </div>
                </div>
                <div id="mobile-admin-sessions-list-panel" class="space-y-2 max-h-[50vh] overflow-y-auto">
                  <p class="text-slate-400 text-center py-10 text-xs">
                    加载中...
                  </p>
                </div>
              </div>

              <div id="mobile-admin-messages-panel-panel" class="hidden space-y-3">
                <div class="flex justify-between items-center">
                  <h4 class="font-semibold text-sm">留言板</h4>
                  <button id="mobile-admin-refresh-messages-panel" class="btn btn-ghost !py-1 !px-2 text-xs">
                    刷新
                  </button>
                </div>
                <div class="bg-slate-50 border border-slate-200 rounded-lg p-3 space-y-2">
                  <h5 class="font-semibold text-slate-700 text-xs">发表留言</h5>
                  <div id="mobile-message-guest-fields-panel" class="space-y-2 hidden">
                    <input type="text" id="mobile-message-nickname-panel" class="input-field text-xs" placeholder="昵称" maxlength="50">
                    <input type="email" id="mobile-message-email-panel" class="input-field text-xs" placeholder="邮箱">
                  </div>
                  <textarea id="mobile-message-content-panel" class="input-field text-xs" rows="3" placeholder="留言内容（最多1000字）" maxlength="1000"></textarea>
                  <div class="text-xs text-slate-500 text-right">
                    <span id="mobile-message-char-count-panel">0</span> / 1000
                  </div>
                  <button id="mobile-post-message-btn-panel" class="btn btn-primary w-full !py-1 text-xs">
                    发表
                  </button>
                </div>
                <div id="mobile-admin-messages-list-panel" class="space-y-2 max-h-[40vh] overflow-y-auto">
                  <p class="text-slate-400 text-center py-10 text-xs">
                    加载中...
                  </p>
                </div>
              </div>

              <div id="mobile-admin-ipban-panel-panel" class="hidden space-y-3">
                <div class="flex justify-between items-center">
                  <h4 class="font-semibold text-sm">IP封禁</h4>
                  <button id="mobile-admin-refresh-ipban-panel" class="btn btn-ghost !py-1 !px-2 text-xs">
                    刷新
                  </button>
                </div>
                <div class="bg-slate-50 border border-slate-200 rounded-lg p-3">
                  <h5 class="font-semibold text-slate-700 text-xs mb-2">
                    现有规则
                  </h5>
                  <div id="mobile-ip-ban-list-panel" class="space-y-2 max-h-[30vh] overflow-y-auto">
                    <p class="text-slate-400 text-center py-6 text-xs">
                      加载中...
                    </p>
                  </div>
                </div>
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                  <h5 class="font-semibold text-blue-900 text-xs mb-2">
                    添加规则
                  </h5>
                  <div class="space-y-2">
                    <select id="mobile-ban-type-panel" class="select-field text-xs">
                      <option value="ip">单个IP</option>
                      <option value="range">IP范围</option>
                    </select>
                    <input type="text" id="mobile-ban-target-panel" class="input-field text-xs" placeholder="IP地址">
                    <select id="mobile-ban-scope-panel" class="select-field text-xs">
                      <option value="all">封禁所有功能</option>
                      <option value="messages_only">仅封禁留言板</option>
                    </select>
                    <button id="mobile-add-ipban-btn-panel" class="btn btn-primary w-full !py-1 text-xs">
                      添加
                    </button>
                  </div>
                </div>
              </div>

              <div id="mobile-admin-sms-panel-panel" class="hidden space-y-3">
                <div class="flex justify-between items-center">
                  <h4 class="font-semibold text-sm">短信配置</h4>
                  <button id="mobile-admin-refresh-sms-panel" class="btn btn-ghost !py-1 !px-2 text-xs">
                    刷新
                  </button>
                </div>
                <div id="mobile-admin-sms-content-panel" class="space-y-3">
                  <p class="text-slate-400 text-center py-10 text-xs">
                    加载中...
                  </p>
                </div>
              </div>

              <div id="mobile-admin-config-panel-panel" class="hidden space-y-3">
                <div class="flex justify-between items-center">
                  <h4 class="font-semibold text-sm">系统配置</h4>
                  <button id="mobile-admin-refresh-config-panel" class="btn btn-ghost !py-1 !px-2 text-xs">
                    刷新
                  </button>
                </div>
                <div id="mobile-admin-config-content-panel" class="space-y-3">
                  <p class="text-slate-400 text-center py-10 text-xs">
                    加载中...
                  </p>
                </div>
              </div>

              <div id="mobile-admin-captcha-panel-panel" class="hidden space-y-3">
                <div class="flex justify-between items-center">
                  <h4 class="font-semibold text-sm">⚙️ 验证码设置</h4>
                </div>
                <p class="text-xs text-slate-500 bg-sky-50 p-2 rounded">
                  💡
                  使用本地验证码生成器，无需第三方API。请在桌面端控制面板中调整详细参数。
                </p>
                <div id="mobile-admin-captcha-list-panel" class="space-y-2">
                  <p class="text-slate-400 text-center py-4 text-xs">
                    请在桌面端查看和修改验证码设置
                  </p>
                </div>
              </div>

              <div id="mobile-admin-reminders-panel-panel" class="hidden space-y-3">
                <div class="flex justify-between items-center">
                  <h4 class="font-semibold text-sm">定时提醒</h4>
                  <button id="mobile-admin-refresh-reminders-panel" class="btn btn-ghost !py-1 !px-2 text-xs">
                    刷新
                  </button>
                </div>
                <div id="mobile-admin-reminders-content-panel" class="space-y-3">
                  <p class="text-slate-400 text-center py-10 text-xs">
                    加载中...
                  </p>
                </div>
              </div>

              <div id="mobile-admin-ssl-panel-panel" class="hidden space-y-3">
                <div class="flex justify-between items-center">
                  <h4 class="font-semibold text-sm">HTTPS设置</h4>
                  <button id="mobile-admin-refresh-ssl-panel" class="btn btn-ghost !py-1 !px-2 text-xs">
                    刷新
                  </button>
                </div>
                <div id="mobile-admin-ssl-content-panel" class="space-y-3">
                  <p class="text-slate-400 text-center py-10 text-xs">
                    加载中...
                  </p>
                </div>
              </div>
            </div>
          </div>

          <!-- ========================================
             我的资料面板
             ======================================== -->
          <div class="mobile-card flex flex-col h-full" id="mobile-profile-panel">
            <div class="flex items-center gap-2 mb-4 pb-3 border-b border-sky-100 flex-shrink-0">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-sky-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
              </svg>
              <h3 class="text-xl font-bold text-sky-700">用户详情</h3>
            </div>

            <div id="mobile-user-details-content" class="space-y-4 flex-1 overflow-y-auto min-h-0 pr-1">
              <div id="mobile-user-details-empty" class="text-center py-10">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-16 h-16 mx-auto text-slate-300 mb-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                </svg>
                <p class="text-slate-400 text-sm">请先登录</p>
              </div>

              <div id="mobile-user-details-avatar" class="bg-sky-50 border border-sky-100 rounded-xl p-4 text-center hidden">
                <img id="mobile-user-details-avatar-img" src="" alt="用户头像" class="w-24 h-24 rounded-full border-4 border-sky-200 object-cover mx-auto mb-2" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22100%22 height=%22100%22%3E%3Crect width=%22100%22 height=%22100%22 fill=%22%23e0f2fe%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 font-size=%2250%22 text-anchor=%22middle%22 dy=%22.3em%22%3E👤%3C/text%3E%3C/svg%3E'">
                <p id="mobile-user-details-name" class="text-lg font-bold text-sky-900"></p>
              </div>

              <div id="mobile-user-details-basic" class="bg-slate-50 border border-slate-200 rounded-xl p-4 space-y-3 hidden">
                <h5 class="font-semibold text-slate-900 text-sm flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                  基本信息
                </h5>
                <div id="mobile-user-details-basic-list" class="space-y-2 text-sm"></div>
              </div>

              <div id="mobile-user-details-school" class="bg-green-50 border border-green-100 rounded-xl p-4 space-y-3 hidden">
                <h5 class="font-semibold text-green-900 text-sm flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                  </svg>
                  学校信息
                </h5>
                <div id="mobile-user-details-school-list" class="space-y-2 text-sm"></div>
              </div>

              <div id="mobile-user-details-login" class="bg-purple-50 border border-purple-100 rounded-xl p-4 space-y-3 hidden">
                <h5 class="font-semibold text-purple-900 text-sm flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                  登录信息
                </h5>
                <div id="mobile-user-details-login-list" class="space-y-2 text-sm"></div>
              </div>

              <div id="mobile-user-details-ua" class="bg-amber-50 border border-amber-100 rounded-xl p-4 space-y-3 hidden">
                <h5 class="font-semibold text-amber-900 text-sm flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                  </svg>
                  User-Agent
                </h5>
                <div id="mobile-user-details-ua-text" class="text-xs text-slate-600 break-all font-mono bg-white p-3 rounded-lg border border-amber-200"></div>
              </div>

              <div class="flex gap-2 pt-2 pb-2">
                <button onclick="mobileLogout()" class="flex-1 py-2 px-4 bg-red-50 text-red-600 rounded-lg text-sm font-medium hover:bg-red-100 transition flex items-center justify-center gap-2" style="display: none">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                  </svg>
                  退出登录
                </button>
              </div>
            </div>

            <div class="mt-auto pt-3 border-t border-sky-100 flex-shrink-0">
              <button onclick="loadMobileUserDetails()" class="w-full py-3 bg-sky-50 text-sky-600 rounded-xl font-medium hover:bg-sky-100 active:bg-sky-200 transition flex items-center justify-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                </svg>
                刷新信息
              </button>
            </div>
          </div>
        </div>

        <!-- ========================================
               【统一移动端管理面板卡片】
               重构后的原生移动端管理面板，采用 mobile-session-panel-card 的设计语言
               ID重命名：mobile-multi-admin-panel -> mobile-admin-panel-unified
               新增装饰性渐变背景圆圈，提升视觉层次感
               应用类: mobile-card relative overflow-hidden !p-5
               ======================================== -->
        <div class="mobile-card relative overflow-hidden !p-5 hidden" id="mobile-admin-panel-unified" style="min-height: 400px">
          <!-- 装饰性渐变背景圆圈：右上角天蓝色渐变 -->
          <div class="absolute -top-10 -right-10 w-40 h-40 bg-gradient-to-br from-sky-100/50 to-blue-100/50 rounded-full blur-3xl pointer-events-none"></div>
          <!-- 装饰性渐变背景圆圈：左下角紫色渐变 -->
          <div class="absolute -bottom-10 -left-10 w-32 h-32 bg-gradient-to-tr from-indigo-100/50 to-purple-100/50 rounded-full blur-3xl pointer-events-none"></div>

          <!-- 面板头部区域：包含图标、标题 -->
          <div class="relative flex items-center justify-between mb-6">
            <!-- 左侧：图标和标题组合 -->
            <div class="flex items-center gap-3">
              <!-- 管理面板图标容器：白色背景圆角方形 -->
              <div class="w-12 h-12 rounded-2xl bg-white shadow-md border border-slate-100 flex items-center justify-center text-sky-600">
                <!-- 齿轮图标：表示管理/设置功能 -->
                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37 1 .608 2.296.07 2.572-1.065z"></path>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                </svg>
              </div>
              <!-- 标题 -->
              <div>
                <h3 class="text-xl font-bold text-slate-800 tracking-tight">
                  管理面板
                </h3>
                <div id="mobile-admin-panel-unified-status" class="text-xs font-medium mt-0.5 text-slate-500">
                  多账号管理
                </div>
              </div>
            </div>
          </div>

          <!-- 标签导航区域：水平滚动的标签按钮 -->
          <div id="mobile-multi-admin-tabs-nav-panel" class="relative flex border-b-2 border-slate-200 overflow-x-auto gap-1 pb-0 mb-4" style="scrollbar-width: none; -webkit-overflow-scrolling: touch"></div>

          <!-- ========================================
                 移动端多账号管理面板内容区域
                 包含13个管理子面板：用户管理、权限组、日志查看、系统状态、
                 个人信息、会话管理、留言板、IP封禁、短信配置、系统配置、
                 验证码管理、定时提醒、HTTPS设置
                 每个面板ID命名规则：mobile-multi-admin-{tabId}-panel
                 内容列表ID命名规则：mobile-multi-admin-{tabId}-list
                 ======================================== -->
          <div id="mobile-multi-admin-content-panel" class="text-sm space-y-2 min-h-[60vh] overflow-y-auto">
            <!-- ========================================
                   用户管理面板 (users)
                   管理员可以在此查看、创建和管理系统用户
                   ======================================== -->
            <div id="mobile-multi-admin-users-panel" class="space-y-3">
              <!-- 面板头部：包含标题和操作按钮 -->
              <div class="flex justify-between items-center">
                <!-- 面板标题 -->
                <h4 class="font-semibold text-sm">用户列表</h4>
                <!-- 操作按钮组 -->
                <div class="flex gap-2">
                  <!-- 新增用户按钮 -->
                  <button id="mobile-multi-admin-create-user" class="btn btn-primary !py-1 !px-2 text-xs">
                    新增
                  </button>
                  <!-- 刷新用户列表按钮 -->
                  <button id="mobile-multi-admin-refresh-users" class="btn btn-ghost !py-1 !px-2 text-xs">
                    刷新
                  </button>
                </div>
              </div>
              <!-- 用户列表容器：限制最大高度并支持滚动 -->
              <div id="mobile-multi-admin-users-list" class="space-y-2 max-h-auto overflow-y-auto">
                <!-- 加载占位提示 -->
                <p class="text-slate-400 text-center py-10 text-xs">
                  加载中...
                </p>
              </div>
            </div>

            <!-- ========================================
                   权限组管理面板 (groups)
                   管理员可以在此查看、创建和管理权限组
                   默认隐藏，通过switchMobileAdminTab切换显示
                   ======================================== -->
            <div id="mobile-multi-admin-groups-panel" class="hidden space-y-3">
              <!-- 面板头部：包含标题和操作按钮 -->
              <div class="flex justify-between items-center">
                <!-- 面板标题 -->
                <h4 class="font-semibold text-sm">权限组列表</h4>
                <!-- 操作按钮组 -->
                <div class="flex gap-2">
                  <!-- 新增权限组按钮 -->
                  <button id="mobile-multi-admin-create-group" class="btn btn-primary !py-1 !px-2 text-xs">
                    新增
                  </button>
                  <!-- 刷新权限组列表按钮 -->
                  <button id="mobile-multi-admin-refresh-groups" class="btn btn-ghost !py-1 !px-2 text-xs">
                    刷新
                  </button>
                </div>
              </div>
              <!-- 权限组列表容器 -->
              <div id="mobile-multi-admin-groups-list" class="space-y-2 max-h-auto overflow-y-auto">
                <!-- 加载占位提示 -->
                <p class="text-slate-400 text-center py-10 text-xs">
                  加载中...
                </p>
              </div>
            </div>

            <!-- ========================================
                   日志查看面板 (logs)
                   查看系统运行日志，支持分页和行数选择
                   默认隐藏，通过switchMobileAdminTab切换显示
                   ======================================== -->
            <div id="mobile-multi-admin-logs-panel" class="hidden space-y-3 overflow-hidden">
              <!-- 面板头部：包含标题和控制选项 -->
              <div class="flex justify-between items-center">
                <!-- 面板标题 -->
                <h4 class="font-semibold text-sm">系统日志</h4>
                <!-- 控制选项组：日志行数选择和刷新按钮 -->
                <div class="flex gap-2">
                  <!-- 日志行数选择下拉框 -->
                  <select id="mobile-multi-log-limit-select" class="text-xs border border-slate-300 rounded px-2 py-1">
                    <option value="100">每页100行</option>
                    <option value="200">每页200行</option>
                    <option value="500">每页500行</option>
                    <option value="1000">每页1000行</option>
                  </select>
                  <!-- 刷新日志按钮 -->
                  <button id="mobile-multi-admin-refresh-logs" class="btn btn-ghost !py-1 !px-2 text-xs">
                    刷新
                  </button>
                </div>
              </div>
              <!-- 日志内容显示区域：深色背景终端风格 -->
              <div class="bg-slate-900 text-green-400 rounded-lg p-3 font-mono text-xs overflow-auto max-h-[100vh]">
                <!-- 日志内容预格式化文本 -->
                <pre id="mobile-multi-admin-logs-content" class="whitespace-pre-wrap">加载中...</pre>
              </div>
              <!-- 分页控制区域 -->
              <div id="mobile-multi-admin-logs-pagination" class="flex justify-between items-center text-xs text-slate-600 pt-2 border-t border-slate-200">
                <!-- 上一页按钮 -->
                <button id="mobile-multi-log-prev-page" class="btn btn-ghost !py-1 !px-2 text-xs">
                  上一页
                </button>
                <!-- 页码选择和总行数显示 -->
                <div class="flex items-center gap-2">
                  <!-- 页码选择下拉框 -->
                  <select id="mobile-multi-log-page-select" class="text-xs border border-slate-300 rounded px-2 py-1">
                    <option value="1">第 1 / 1 页</option>
                  </select>
                  <!-- 总行数显示 -->
                  <span id="mobile-multi-log-page-total" class="text-xs text-slate-500">(共 0 行)</span>
                </div>
                <!-- 下一页按钮 -->
                <button id="mobile-multi-log-next-page" class="btn btn-ghost !py-1 !px-2 text-xs">
                  下一页
                </button>
              </div>
            </div>

            <!-- ========================================
                   系统状态面板 (health)
                   显示系统健康状态，支持自动刷新
                   默认隐藏，通过switchMobileAdminTab切换显示
                   ======================================== -->
            <div id="mobile-multi-admin-health-panel" class="hidden space-y-3">
              <!-- 面板头部：包含标题和自动刷新控制 -->
              <div class="flex justify-between items-center">
                <!-- 面板标题 -->
                <h4 class="font-semibold text-sm">系统状态</h4>
                <!-- 控制选项组：自动刷新开关和手动刷新按钮 -->
                <div class="flex items-center gap-2">
                  <!-- 自动刷新开关标签 -->
                  <label class="flex items-center gap-1 cursor-pointer">
                    <!-- 自动刷新复选框 -->
                    <input type="checkbox" id="mobile-multi-health-auto-refresh-toggle" class="w-3 h-3 accent-sky-600 rounded" checked="">
                    <!-- 自动刷新文本和倒计时显示 -->
                    <span class="text-xs text-slate-600">自动刷新
                      <span id="mobile-multi-health-countdown-display" class="font-semibold text-sky-600"></span>
                    </span>
                  </label>
                  <!-- 手动刷新按钮 -->
                  <button id="mobile-multi-admin-refresh-health" class="btn btn-ghost !py-1 !px-2 text-xs">
                    刷新
                  </button>
                </div>
              </div>
              <!-- 系统状态内容容器 -->
              <div id="mobile-multi-admin-health-content" class="space-y-3">
                <!-- 加载占位提示 -->
                <p class="text-slate-400 text-center py-10 text-xs">
                  加载中...
                </p>
              </div>
            </div>

            <!-- ========================================
                   个人信息面板 (profile)
                   用户可以查看和编辑个人资料
                   默认隐藏，通过switchMobileAdminTab切换显示
                   ======================================== -->
            <div id="mobile-multi-admin-profile-panel" class="hidden space-y-3">
              <!-- 面板头部：包含标题和刷新按钮 -->
              <div class="flex justify-between items-center">
                <!-- 面板标题 -->
                <h4 class="font-semibold text-sm">个人信息</h4>
                <!-- 刷新按钮 -->
                <button id="mobile-unified-refresh-profile" class="btn btn-ghost !py-1 !px-2 text-xs" onclick="loadMobileUnifiedProfile()">
                  刷新
                </button>
              </div>
              <!-- 个人信息内容容器 -->
              <div id="mobile-unified-profile-content" class="space-y-3 text-slate-800">
                <!-- 头像设置区域 -->
                <div class="bg-slate-50 border border-slate-200 rounded-lg p-3 space-y-2">
                  <!-- 头像区块标题 -->
                  <h5 class="font-semibold text-slate-700 text-xs">头像</h5>
                  <!-- 头像显示和更换区域 -->
                  <div class="flex items-center gap-3">
                    <!-- 头像图片显示 -->
                    <img id="mobile-unified-profile-avatar-display" src="" alt="用户头像" class="w-16 h-16 rounded-full border-2 border-slate-200" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22100%22 height=%22100%22%3E%3Crect width=%22100%22 height=%22100%22 fill=%22%23ddd%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 font-size=%2240%22 text-anchor=%22middle%22 dy=%22.3em%22%3E👤%3C/text%3E%3C/svg%3E'">
                    <!-- 头像上传控件区域 -->
                    <div class="flex-1">
                      <!-- 隐藏的文件上传input -->
                      <input type="file" id="mobile-unified-profile-avatar-file" accept="image/*" class="hidden" onchange="handleMobileUnifiedAvatarFile(this.files[0])">
                      <!-- 选择图片按钮 -->
                      <button id="mobile-unified-avatar-upload-btn" class="btn btn-ghost border border-slate-300 !py-1 !px-2 text-xs" onclick="document.getElementById('mobile-unified-profile-avatar-file').click();">
                        选择图片
                      </button>
                    </div>
                  </div>
                </div>
                <!-- 基本信息区域 -->
                <div class="bg-slate-50 border border-slate-200 rounded-lg p-3 space-y-2">
                  <h5 class="font-semibold text-slate-700 text-xs">基本信息</h5>
                  <div class="space-y-2">
                    <div>
                      <label class="block text-xs font-medium text-slate-600 mb-1">昵称</label>
                      <input type="text" id="mobile-unified-profile-nickname" class="input-field !text-xs !py-1.5" placeholder="输入昵称">
                    </div>
                    <div>
                      <label class="block text-xs font-medium text-slate-600 mb-1">手机号</label>
                      <div class="flex gap-2">
                        <div class="phone-input-wrapper flex-1">
                          <span class="phone-prefix">+86 </span>
                          <input type="tel" id="mobile-unified-profile-phone" class="input-field !text-xs !py-1.5" placeholder="未绑定" readonly="" inputmode="numeric">
                        </div>
                        <button id="mobile-unified-modify-phone-btn" onclick="showMobileUnifiedModifyPhoneModal()" class="btn btn-ghost border border-slate-300 !py-1 !px-2 text-xs whitespace-nowrap">
                          修改手机号
                        </button>
                      </div>
                      <p class="text-xs text-slate-500 mt-1">
                        💡 修改手机号需要短信验证
                      </p>
                    </div>
                    <div class="flex justify-end">
                      <button onclick="updateMobileUnifiedBasicInfo()" class="btn btn-primary !py-1 !px-3 text-xs">
                        保存基本信息
                      </button>
                    </div>
                  </div>
                </div>
                <!-- 修改密码区域 -->
                <div class="bg-slate-50 border border-slate-200 rounded-lg p-3 space-y-2">
                  <h5 class="font-semibold text-slate-700 text-xs">修改密码</h5>
                  <div class="space-y-2">
                    <!-- 当前密码输入区域（密码验证模式） -->
                    <div id="mobile-password-verify-section">
                      <label class="block text-xs font-medium text-slate-600 mb-1">当前密码</label>
                      <input type="password" id="mobile-unified-current-password" class="input-field !text-xs !py-1.5" placeholder="输入当前密码">
                      <!-- 提示用户可以使用短信验证 -->
                      <p class="text-xs text-slate-500 mt-1">
                        忘记原密码？<button type="button" onclick="toggleSmsVerifyMode('mobile')" class="text-sky-600 hover:underline" id="mobile-sms-toggle-btn">
                          使用短信验证
                        </button>
                      </p>
                    </div>
                    <!-- 短信验证模式区域（默认隐藏） -->
                    <div id="mobile-sms-verify-section" class="hidden space-y-2 p-2 bg-blue-50 border border-blue-200 rounded-lg">
                      <p class="text-xs text-blue-700">
                        📱 验证码将发送到您绑定的手机号
                      </p>
                      <div>
                        <label class="block text-xs font-medium text-slate-600 mb-1">短信验证码</label>
                        <div class="flex gap-2">
                          <input type="text" id="mobile-password-sms-code" class="input-field !text-xs !py-1.5 flex-1" placeholder="请输入验证码" maxlength="6" inputmode="numeric">
                          <button type="button" onclick="sendPasswordResetSmsCode('mobile')" id="mobile-send-sms-btn" class="btn btn-primary !py-1 !px-2 text-xs whitespace-nowrap">
                            发送验证码
                          </button>
                        </div>
                      </div>
                      <button type="button" onclick="toggleSmsVerifyMode('mobile')" class="text-xs text-slate-500 hover:underline">
                        ← 返回密码验证
                      </button>
                    </div>
                    <div>
                      <label class="block text-xs font-medium text-slate-600 mb-1">新密码</label>
                      <input type="password" id="mobile-unified-new-password" class="input-field !text-xs !py-1.5" placeholder="输入新密码">
                    </div>
                    <div>
                      <label class="block text-xs font-medium text-slate-600 mb-1">确认新密码</label>
                      <input type="password" id="mobile-unified-confirm-password" class="input-field !text-xs !py-1.5" placeholder="再次输入新密码">
                    </div>
                    <div class="flex justify-end">
                      <button onclick="updateMobileUnifiedPassword()" class="btn btn-primary !py-1 !px-3 text-xs">
                        修改密码
                      </button>
                    </div>
                  </div>
                </div>

                <div class="bg-slate-50 border border-slate-200 rounded-lg p-3 space-y-2">
                  <h5 class="font-semibold text-slate-700 text-xs">
                    双因素认证(2FA)
                  </h5>
                  <div class="mb-2">
                    <p class="text-xs text-slate-600">
                      状态:
                      <span id="mobile-unified-2fa-status">检测中...</span>
                    </p>
                  </div>

                  <div id="mobile-unified-2fa-setup" class="space-y-2 hidden">
                    <div class="bg-white border border-slate-200 rounded p-2 text-center">
                      <canvas id="mobile-unified-2fa-qr" class="mx-auto"></canvas>
                      <p class="text-[10px] text-slate-500 mt-1 break-all">
                        密钥:
                        <span id="mobile-unified-2fa-secret" class="font-mono font-bold"></span>
                      </p>
                    </div>
                    <div>
                      <input type="text" id="mobile-unified-2fa-code" class="input-field !text-xs !py-1.5" placeholder="输入6位验证码" maxlength="6">
                    </div>
                    <div class="flex justify-end">
                      <button onclick="enableMobileUnified2FA()" class="btn btn-primary !py-1 !px-3 text-xs">
                        启用2FA
                      </button>
                    </div>
                  </div>

                  <div id="mobile-unified-2fa-actions" class="flex justify-end">
                    <button onclick="generateMobileUnified2FA()" class="btn btn-primary !py-1 !px-3 text-xs">
                      生成2FA密钥
                    </button>
                  </div>

                  <div id="mobile-unified-2fa-enabled-actions" class="hidden flex justify-end gap-2">
                    <button onclick="disableMobileUnified2FA()" class="btn btn-ghost border border-red-200 text-red-600 !py-1 !px-3 text-xs">
                      关闭2FA
                    </button>
                  </div>
                </div>

                <div class="bg-slate-50 border border-slate-200 rounded-lg p-3 space-y-2">
                  <h5 class="font-semibold text-slate-700 text-xs">主题设置</h5>

                  <div class="space-y-1">
                    <label class="block text-xs font-medium text-slate-600">主题风格</label>
                    <select id="mobile-unified-theme-select" onchange="updateMobileUnifiedTheme()" class="select-field !text-xs !py-1.5">
                      <option value="light">浅色主题</option>
                      <option value="dark">深色主题</option>
                    </select>
                  </div>

                  <div class="space-y-1" id="mobile-unified-theme-style-presets">
                    <label class="block text-xs font-medium text-slate-600">样式预设</label>
                    <div class="grid grid-cols-3 gap-2">
                      <button onclick="setMobileUnifiedThemeStyle('default')" class="btn btn-ghost border border-slate-300 !py-1 !px-1 text-[10px]">
                        默认
                      </button>
                      <button onclick="setMobileUnifiedThemeStyle('theme-anime')" class="btn btn-ghost border border-slate-300 !py-1 !px-1 text-[10px]">
                        二次元
                      </button>
                      <button onclick="setMobileUnifiedThemeStyle('theme-minimalist')" class="btn btn-ghost border border-slate-300 !py-1 !px-1 text-[10px]">
                        简约
                      </button>
                    </div>
                  </div>

                  <div class="space-y-1">
                    <label class="block text-xs font-medium text-slate-600">基础颜色</label>
                    <div class="flex gap-2 items-center">
                      <input type="color" id="mobile-unified-theme_base_color-picker" value="#7dd3fc" class="w-20 h-20 border border-slate-300 rounded cursor-pointer p-0.5 bg-white shadow-sm" onchange="document.getElementById('mobile-unified-theme_base_color').value = this.value; onColorPicked(this.value); saveUnifiedThemeColor(this.value);">

                      <input type="text" id="mobile-unified-theme_base_color" value="#7dd3fc" class="input-field !text-xs !py-1.5 flex-1 font-mono uppercase shadow-inner" placeholder="#7DD3FC" maxlength="7" onchange="if(/^#[0-9A-F]{6}$/i.test(this.value)){ document.getElementById('mobile-unified-theme_base_color-picker').value = this.value; onColorPicked(this.value); saveUnifiedThemeColor(this.value); }">

                      <button onclick="resetBaseColorToDefault('mobile-unified')" class="btn btn-ghost border border-slate-300 !py-1 !px-2 text-xs ml-auto whitespace-nowrap hover:bg-slate-100">
                        恢复默认
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- ========================================
                   会话管理面板 (sessions)
                   查看和管理当前登录会话
                   默认隐藏，通过switchMobileAdminTab切换显示
                   ======================================== -->
            <div id="mobile-multi-admin-sessions-panel" class="hidden space-y-4">
              <h4 class="font-semibold text-sm" style="display: block">
                会话列表
              </h4>
              <div class="flex justify-between items-center">
                <div class="flex items-center gap-2">
                  <div id="mobile-multi-god-mode-toggle" class="items-center gap-1 cursor-pointer flex items-center" style="display: none">
                    <input type="checkbox" id="mobile-multi-god-mode-checkbox" class="w-3 h-3 accent-red-600 rounded">
                    <span class="text-xs font-semibold text-red-600">查看系统中的所有会话</span>
                  </div>
                  <div id="mobile-multi-admin-session-count-display" class="text-xs text-slate-600"></div>
                  <button id="mobile-multi-admin-refresh-sessions" class="btn btn-ghost !py-1 !px-2 text-xs" onclick="loadMobileAdminSessionsList()">
                    刷新
                  </button>
                </div>
              </div>

              <div id="mobile-multi-admin-create-session-container" class="p-3 bg-sky-50 border border-sky-200 rounded-lg">
                <p class="text-xs text-slate-700 mb-2">管理您的所有会话状态</p>
                <button class="w-full py-2 bg-gradient-to-r from-sky-500 to-blue-600 text-white rounded-lg text-xs font-bold shadow-sm active:scale-[0.98] transition-transform flex items-center justify-center gap-1" onclick="createNewSessionFromPicker()">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                  </svg>
                  创建新会话
                </button>
              </div>

              <div id="mobile-multi-admin-sessions-list" class="space-y-2 max-h-auto overflow-y-auto">
                <p class="text-slate-400 text-center py-10 text-xs">
                  加载中...
                </p>
              </div>

              <div class="mt-2 pt-3 border-t border-slate-100 text-center">
                <p class="text-[10px] text-slate-400 flex items-center justify-center gap-1">
                  <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                  长按会话可删除，点击即可切换
                </p>
              </div>
            </div>

            <!-- ========================================
                   留言板面板 (messages)
                   查看和发表留言
                   默认隐藏，通过switchMobileAdminTab切换显示
                   ======================================== -->
            <div id="mobile-multi-admin-messages-panel" class="hidden space-y-3">
              <div class="flex justify-between items-center">
                <h4 class="font-semibold text-sm">留言板</h4>
                <button id="mobile-multi-admin-refresh-messages" class="btn btn-ghost !py-1 !px-2 text-xs" onclick="switchMobileAdminTab('messages', 'mobile-admin-panel-unified')">
                  刷新
                </button>
              </div>
              <!-- 发表留言区域 -->
              <div class="bg-slate-50 border border-slate-200 rounded-lg p-3 space-y-2">
                <!-- 发表留言标题 -->
                <h5 class="font-semibold text-slate-700 text-xs">发表留言</h5>
                <!-- 游客信息输入字段（非登录用户可见） -->
                <div id="mobile-multi-message-guest-fields" class="space-y-2 hidden">
                  <!-- 昵称输入框 -->
                  <input type="text" id="mobile-multi-message-nickname" class="input-field text-xs" placeholder="昵称" maxlength="50">
                  <!-- 邮箱输入框 -->
                  <input type="email" id="mobile-multi-message-email" class="input-field text-xs" placeholder="邮箱">
                </div>
                <!-- 留言内容输入框 -->
                <textarea id="mobile-multi-message-content" class="input-field text-xs" rows="3" placeholder="留言内容（最多1000字）" maxlength="1000"></textarea>
                <!-- 字符计数显示 -->
                <div class="text-xs text-slate-500 text-right">
                  <span id="mobile-multi-message-char-count">0</span> / 1000
                </div>
                <!-- 发表留言按钮 -->
                <button id="mobile-multi-post-message-btn" class="btn btn-primary w-full !py-1 text-xs" onclick="submitMobileMultiMessage()">
                  发表
                </button>
              </div>
              <!-- 留言列表容器 -->
              <!-- 美化后的移动端留言列表：添加背景色、圆角、边框、阴影等视觉效果 -->
              <!-- 使用 max-h-[50vh] 限制最大高度为视口的50%，确保不会占用过多屏幕空间 -->
              <!-- scroll-smooth 提供平滑滚动体验，提升用户交互感受 -->
              <div id="mobile-multi-admin-messages-list" class="space-y-2 max-h-[50vh] overflow-y-auto bg-slate-50 rounded-lg p-3 border border-slate-200 shadow-sm scroll-smooth">
                <!-- 加载占位提示 -->
                <!-- 使用 animate-pulse 添加脉冲动画效果，让加载状态更生动 -->
                <!-- 添加 flex 布局使加载图标和文字居中对齐 -->
                <div class="flex flex-col items-center justify-center py-10 space-y-2">
                  <!-- 加载动画图标：使用 SVG 旋转动画 -->
                  <svg class="animate-spin h-6 w-6 text-slate-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                  </svg>
                  <!-- 加载文字提示 -->
                  <p class="text-slate-400 text-center text-xs animate-pulse">
                    加载中...
                  </p>
                </div>
              </div>
            </div>

            <!-- ========================================
                   IP封禁面板 (ipban)
                   管理IP黑名单和封禁规则
                   默认隐藏，通过switchMobileAdminTab切换显示
                   ======================================== -->
            <div id="mobile-multi-admin-ipban-panel" class="hidden space-y-3">
              <!-- 面板头部：包含标题和刷新按钮 -->
              <div class="flex justify-between items-center">
                <!-- 面板标题 -->
                <h4 class="font-semibold text-sm">IP封禁</h4>
                <!-- 刷新IP封禁列表按钮 -->
                <button id="mobile-multi-admin-refresh-ipban" class="btn btn-ghost !py-1 !px-2 text-xs" onclick="mobileRefreshIPBanList()" aria-label="刷新IP封禁列表">
                  刷新
                </button>
              </div>
              <!-- 现有封禁规则列表区域 -->
              <div class="bg-slate-50 border border-slate-200 rounded-lg p-3">
                <!-- 现有规则标题 -->
                <h5 class="font-semibold text-slate-700 text-xs mb-2">
                  现有规则
                </h5>
                <!-- 封禁规则列表容器 -->
                <div id="mobile-multi-ip-ban-list" class="space-y-2 max-h-[30vh] overflow-y-auto">
                  <!-- 加载占位提示 -->
                  <p class="text-slate-400 text-center py-6 text-xs">
                    加载中...
                  </p>
                </div>
              </div>
              <!-- 添加封禁规则区域 -->
              <div class="bg-blue-50 border border-blue-200 rounded-lg p-3" id="mobile-banip-basicopentic">
                <!-- 添加规则标题 -->
                <h5 class="font-semibold text-blue-900 text-xs mb-2">
                  添加规则
                </h5>
                <!-- 功能说明提示 -->
                <p class="text-xs text-blue-700 mb-2 bg-blue-100/50 p-2 rounded">
                  💡 <strong>提示：</strong> <br>• 单个IP格式：192.168.1.1
                  <br>• IP范围格式：192.168.1.1-192.168.1.100 <br>•
                  封禁后，该IP将无法访问对应功能
                </p>
                <!-- 添加规则表单 -->
                <div class="space-y-2">
                  <!-- 封禁类型选择下拉框 -->
                  <label class="block text-xs font-medium text-blue-800">封禁类型</label>
                  <select id="mobile-multi-ban-type" class="select-field text-xs" onchange="mobileUpdateBanTargetHint()">
                    <option value="ip">单个IP</option>
                    <option value="range">IP范围</option>
                  </select>
                  <!-- 封禁目标输入框 -->
                  <label class="block text-xs font-medium text-blue-800">封禁目标</label>
                  <input type="text" id="mobile-multi-ban-target" class="input-field text-xs" placeholder="例如：192.168.1.1" oninput="mobileValidateIPBanTarget()">
                  <!-- 输入提示和错误信息 -->
                  <p id="mobile-multi-ban-target-hint" class="text-xs text-slate-500">
                    示例: 192.168.1.1
                  </p>
                  <p id="mobile-multi-ban-target-error" class="hidden text-xs text-red-600 font-semibold"></p>
                  <!-- 封禁范围选择下拉框 -->
                  <label class="block text-xs font-medium text-blue-800">封禁范围</label>
                  <select id="mobile-multi-ban-scope" class="select-field text-xs">
                    <option value="all">封禁所有功能</option>
                    <option value="messages_only">仅封禁留言板</option>
                  </select>
                  <!-- 添加封禁规则按钮 -->
                  <button id="mobile-multi-add-ipban-btn" class="btn btn-primary w-full !py-2 text-sm min-h-[44px]" onclick="mobileAddIPBan()" aria-label="添加IP封禁规则">
                    添加封禁规则
                  </button>
                </div>
              </div>
            </div>

            <!-- ========================================
                   短信配置面板 (sms)
                   配置短信服务参数
                   默认隐藏，通过switchMobileAdminTab切换显示
                   ======================================== -->
            <div id="mobile-multi-admin-sms-panel" class="hidden space-y-3">
              <!-- 面板头部：包含标题和刷新按钮 -->
              <div class="flex justify-between items-center">
                <!-- 面板标题 -->
                <h4 class="font-semibold text-sm">短信配置</h4>
                <!-- 刷新短信配置按钮 -->
                <button id="mobile-multi-admin-refresh-sms" class="btn btn-ghost !py-1 !px-2 text-xs">
                  刷新
                </button>
              </div>
              <!-- 短信配置内容容器 -->
              <div id="mobile-multi-admin-sms-content" class="space-y-3">
                <!-- 加载占位提示 -->
                <p class="text-slate-400 text-center py-10 text-xs">
                  加载中...
                </p>
              </div>
            </div>

            <!-- ========================================
                   系统配置面板 (config)
                   管理系统全局配置参数
                   默认隐藏，通过switchMobileAdminTab切换显示
                   ======================================== -->
            <div id="mobile-multi-admin-config-panel" class="hidden space-y-3">
              <!-- 面板头部：包含标题和刷新按钮 -->
              <div class="flex justify-between items-center">
                <!-- 面板标题 -->
                <h4 class="font-semibold text-sm">系统配置</h4>
                <!-- 刷新系统配置按钮 -->
                <button id="mobile-multi-admin-refresh-config" class="btn btn-ghost !py-1 !px-2 text-xs">
                  刷新
                </button>
              </div>
              <!-- 系统配置内容容器 -->
              <div id="mobile-multi-admin-config-content" class="space-y-3">
                <!-- 加载占位提示 -->
                <p class="text-slate-400 text-center py-10 text-xs">
                  加载中...
                </p>
              </div>
            </div>

            <!-- ========================================
                   验证码管理面板 (captcha)
                   配置和管理验证码设置
                   默认隐藏，通过switchMobileAdminTab切换显示
                   ======================================== -->
            <div id="mobile-multi-admin-captcha-panel" class="hidden space-y-3">
              <!-- 面板头部：包含标题和刷新按钮 -->
              <div class="flex justify-between items-center">
                <!-- 面板标题 -->
                <h4 class="font-semibold text-sm">⚙️ 验证码设置</h4>
                <!-- 刷新验证码设置按钮 -->
                <button id="mobile-multi-admin-refresh-captcha" class="btn btn-ghost !py-1 !px-2 text-xs" onclick="mobileLoadCaptchaSettings()">
                  刷新
                </button>
              </div>
              <!-- 验证码说明提示 -->
              <p class="text-xs text-blue-700 bg-blue-50 p-2 rounded">
                💡 <strong>本地验证码生成器：</strong>使用 MicroPixelCaptcha
                生成像素风格验证码，无需第三方API，更稳定安全。
              </p>
              <!-- 验证码设置表单 -->
              <div id="mobile-multi-admin-captcha-list" class="space-y-3">
                <!-- 验证码长度设置 -->
                <div class="bg-white border border-slate-200 rounded-lg p-3">
                  <label class="block text-xs font-semibold text-slate-700 mb-2">
                    验证码长度（3-6字符）
                  </label>
                  <input type="number" id="mobile-captcha-length" min="3" max="6" step="1" value="4" class="input-field text-sm w-full" placeholder="推荐值：4">
                </div>
                <!-- 细分倍数设置 -->
                <div class="bg-white border border-slate-200 rounded-lg p-3">
                  <label class="block text-xs font-semibold text-slate-700 mb-2">
                    细分倍数（2-4）
                  </label>
                  <input type="number" id="mobile-captcha-scale-factor" min="2" max="4" step="1" value="2" class="input-field text-sm w-full" placeholder="推荐值：2或3">
                </div>
                <!-- 噪点比例设置 -->
                <div class="bg-white border border-slate-200 rounded-lg p-3">
                  <label class="block text-xs font-semibold text-slate-700 mb-2">
                    噪点比例（0.00-0.30）
                  </label>
                  <input type="number" id="mobile-captcha-noise-level" min="0" max="0.3" step="0.01" value="0.08" class="input-field text-sm w-full" placeholder="推荐值：0.05-0.15">
                </div>
                <!-- 操作按钮组 -->
                <div class="flex flex-col gap-2">
                  <div class="flex gap-2">
                    <button id="mobile-save-captcha-settings-btn" class="btn btn-primary flex-1 !py-2 text-sm min-h-[44px]" onclick="mobileSaveCaptchaSettings()">
                      💾 保存设置
                    </button>
                    <button id="mobile-test-captcha-btn" class="btn btn-ghost border border-slate-300 flex-1 !py-2 text-sm min-h-[44px]" onclick="mobileTestCaptcha()">
                      🔄 测试生成
                    </button>
                  </div>
                  <button onclick="openMobileCaptchaHistoryModal()" class="btn btn-secondary w-full !py-2 text-sm min-h-[44px]">
                    📜 查看历史记录
                  </button>
                </div>
                <!-- 验证码预览区域 -->
                <div id="mobile-captcha-test-preview" class="hidden bg-white border border-slate-200 rounded-lg p-3 text-center">
                  <p class="text-xs font-semibold text-slate-700 mb-2">
                    预览效果：
                  </p>
                  <div id="mobile-captcha-preview-display" class="flex justify-center my-3"></div>
                  <p class="text-xs text-slate-500">
                    验证码答案：<span id="mobile-captcha-preview-answer" class="font-mono font-bold text-slate-900"></span>
                  </p>
                </div>
              </div>
            </div>

            <!-- ========================================
                   定时提醒面板 (reminders)
                   管理定时任务和提醒设置
                   默认隐藏，通过switchMobileAdminTab切换显示
                   ======================================== -->
            <div id="mobile-multi-admin-reminders-panel" class="hidden space-y-3">
              <!-- 面板头部：包含标题和刷新按钮 -->
              <div class="flex justify-between items-center">
                <!-- 面板标题 -->
                <h4 class="font-semibold text-sm">定时提醒</h4>
                <!-- 操作按钮组 -->
                <div class="flex gap-2">
                  <!-- 添加提醒按钮 -->
                  <button id="mobile-multi-admin-add-reminder" class="btn btn-primary !py-1 !px-2 text-xs" onclick="openMobileReminderEditModal()">
                    + 添加
                  </button>
                  <!-- 刷新定时提醒按钮 -->
                  <button id="mobile-multi-admin-refresh-reminders" class="btn btn-ghost !py-1 !px-2 text-xs" onclick="mobileRefreshReminders()">
                    刷新
                  </button>
                </div>
              </div>
              <!-- 功能说明提示 -->
              <p class="text-xs text-blue-700 bg-blue-50 p-2 rounded">
                💡
                <strong>功能说明：</strong>定时提醒会在设定时间范围内自动弹出提示，支持跨天时间设置。
              </p>
              <!-- 提醒统计信息 -->
              <div class="grid grid-cols-3 gap-2 text-center text-xs">
                <div class="p-2 bg-slate-100 rounded">
                  <div class="text-slate-600">总计</div>
                  <div id="mobile-reminder-stat-total" class="text-base font-semibold">
                    0
                  </div>
                </div>
                <div class="p-2 bg-green-100 rounded">
                  <div class="text-green-700">启用</div>
                  <div id="mobile-reminder-stat-enabled" class="text-base font-semibold text-green-700">
                    0
                  </div>
                </div>
                <div class="p-2 bg-slate-100 rounded">
                  <div class="text-slate-600">禁用</div>
                  <div id="mobile-reminder-stat-disabled" class="text-base font-semibold text-slate-600">
                    0
                  </div>
                </div>
              </div>
              <!-- 定时提醒列表容器 -->
              <!-- 美化后的移动端定时提醒列表：添加背景色、圆角、边框、阴影等视觉效果 -->
              <!-- 使用 max-h-[50vh] 限制最大高度为视口的50%，确保不会占用过多屏幕空间 -->
              <!-- scroll-smooth 提供平滑滚动体验，提升用户交互感受 -->
              <div id="mobile-multi-admin-reminders-content" class="space-y-2 max-h-[50vh] overflow-y-auto bg-slate-50 rounded-lg p-3 border border-slate-200 shadow-sm scroll-smooth">
                <!-- 加载占位提示 -->
                <!-- 使用 animate-pulse 添加脉冲动画效果，让加载状态更生动 -->
                <!-- 添加 flex 布局使加载图标和文字居中对齐 -->
                <div class="flex flex-col items-center justify-center py-10 space-y-2">
                  <!-- 加载动画图标：使用 SVG 旋转动画 -->
                  <svg class="animate-spin h-6 w-6 text-slate-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                  </svg>
                  <!-- 加载文字提示 -->
                  <p class="text-slate-400 text-center text-xs animate-pulse">
                    加载中...
                  </p>
                </div>
              </div>
            </div>

            <!-- ========================================
                   HTTPS设置面板 (ssl)
                   配置SSL/HTTPS证书和相关设置
                   默认隐藏，通过switchMobileAdminTab切换显示
                   ======================================== -->
            <div id="mobile-multi-admin-ssl-panel" class="hidden space-y-3">
              <!-- 面板头部：包含标题和刷新按钮 -->
              <div class="flex justify-between items-center">
                <!-- 面板标题 -->
                <h4 class="font-semibold text-sm">HTTPS设置</h4>
                <!-- 刷新SSL配置按钮 -->
                <button id="mobile-multi-admin-refresh-ssl" class="btn btn-ghost !py-1 !px-2 text-xs">
                  刷新
                </button>
              </div>
              <!-- HTTPS设置内容容器 -->
              <div id="mobile-multi-admin-ssl-content" class="space-y-3">
                <!-- 加载占位提示 -->
                <p class="text-slate-400 text-center py-10 text-xs">
                  加载中...
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- ========================================
           移动端多账号模式界面
           ======================================== -->
        <div id="mobile-multi-account-app" class="space-y-4 hidden">
          <div class="mobile-card py-3" style="display: none">
            <button class="flex items-center gap-2 text-sky-600 font-medium" onclick="exitMobileMultiAccount()" id="multi_exit_account">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
              </svg>
              返回首页
            </button>
          </div>

          <div class="mobile-card" id="mobile-multi-account-panel">
            <div class="flex items-center justify-between mb-5 pb-4 border-b-2 border-purple-200">
              <div class="flex items-center gap-3">
                <div class="flex-shrink-0 w-10 h-10 rounded-full bg-gradient-to-br from-purple-500 to-purple-600 flex items-center justify-center shadow-lg">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05c1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"></path>
                  </svg>
                </div>
                <h3 class="text-2xl font-bold text-purple-700 tracking-tight">
                  账号管理
                </h3>
              </div>
              <div class="text-sm font-bold text-white bg-gradient-to-r from-purple-500 to-purple-600 px-4 py-1.5 rounded-full shadow-md" id="mobile-multi-account-count">
                0 个账号
              </div>
            </div>

            <div class="bg-white rounded-xl shadow-md p-4 mb-5 border border-purple-100">
              <div class="flex items-center gap-2 mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-purple-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z"></path>
                </svg>
                <h4 class="text-base font-bold text-slate-800">➕ 添加账号</h4>
              </div>

              <select id="mobile-multi-config-user-select" class="w-full px-4 py-3 bg-slate-50 border-2 border-slate-200 rounded-lg text-sm font-semibold text-slate-700 focus:ring-2 focus:ring-purple-500 focus:border-purple-500 outline-none transition-all mb-3 shadow-sm">
                <option value="">-- 请选择配置文件 --</option>
              </select>

              <div class="grid grid-cols-3 gap-2">
                <button class="py-2.5 px-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-lg text-sm font-bold hover:from-purple-600 hover:to-purple-700 transition-all shadow-md hover:shadow-lg flex items-center justify-center gap-1" onclick="addMobileSelectedConfig()">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path>
                  </svg>
                  添加选中
                </button>
                <button class="py-2.5 px-3 bg-gradient-to-r from-purple-600 to-purple-700 text-white rounded-lg text-sm font-bold hover:from-purple-700 hover:to-purple-800 transition-all shadow-md hover:shadow-lg flex items-center justify-center gap-1" onclick="addMobileAllConfigs()">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                  </svg>
                  添加全部
                </button>
                <button class="py-2.5 px-3 bg-gradient-to-r from-teal-500 to-teal-600 text-white rounded-lg text-sm font-bold hover:from-teal-600 hover:to-teal-700 transition-all shadow-md hover:shadow-lg flex items-center justify-center gap-1" id="mobile_multi_account_manual_input_button" onclick="openManualAccountModal()">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                  </svg>
                  手动添加
                </button>
              </div>
            </div>

            <div class="bg-gradient-to-r from-purple-50 to-purple-100 rounded-xl p-4 mb-5 border-2 border-purple-200 shadow-sm">
              <div class="flex items-center justify-between">
                <label class="flex items-center gap-3 cursor-pointer">
                  <input type="checkbox" id="mobile-select-all-accounts" class="w-6 h-6 text-purple-600 rounded-md shadow-sm cursor-pointer" onchange="mobileToggleSelectAllAccounts()">
                  <span class="text-sm font-bold text-slate-800">✅ 全选账号</span>
                </label>
                <div class="flex gap-2">
                  <button class="py-2 px-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg text-sm font-bold hover:from-green-600 hover:to-green-700 transition-all shadow-md hover:shadow-lg" onclick="mobileStartSelectedAccounts()">
                    ▶️ 启动
                  </button>
                  <button class="py-2 px-4 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg text-sm font-bold hover:from-red-600 hover:to-red-700 transition-all shadow-md hover:shadow-lg" onclick="mobileStopSelectedAccounts()">
                    ⏹️ 停止
                  </button>
                </div>
              </div>
            </div>

            <div id="mobile-multi-account-list" class="space-y-3 max-h-[100vh] overflow-y-auto pr-2 mb-5">
              <div class="text-center py-12">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-20 h-20 mx-auto text-slate-300 mb-4" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05c1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"></path>
                </svg>
                <p class="text-slate-400 text-sm font-medium">
                  暂无账号，请先添加
                </p>
                <p class="text-slate-300 text-xs mt-1">
                  从上方选择配置文件或手动添加
                </p>
              </div>
            </div>

            <div class="bg-white rounded-xl shadow-md p-4 border border-purple-100">
              <div class="flex items-center gap-2 mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-purple-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path>
                </svg>
                <h4 class="text-base font-bold text-slate-800">🔧 批量操作</h4>
              </div>

              <div class="space-y-2">
                <div class="grid grid-cols-4 gap-2">
                  <button class="py-2.5 px-2 bg-blue-50 text-blue-600 rounded-lg text-xs font-bold hover:bg-blue-100 transition flex flex-col items-center justify-center gap-1 border-2 border-blue-200" onclick="importMobileAccountList()">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"></path>
                    </svg>
                    <span>导入</span>
                  </button>
                  <button class="py-2.5 px-2 bg-green-50 text-green-600 rounded-lg text-xs font-bold hover:bg-green-100 transition flex flex-col items-center justify-center gap-1 border-2 border-green-200" onclick="exportMobileAccountList()">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                    </svg>
                    <span>导出</span>
                  </button>
                  <button class="py-2.5 px-2 bg-amber-50 text-amber-600 rounded-lg text-xs font-bold hover:bg-amber-100 transition flex flex-col items-center justify-center gap-1 border-2 border-amber-200" onclick="downloadMobileAccountTemplate()">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    <span>模板</span>
                  </button>
                  <button class="py-2.5 px-2 bg-slate-50 text-slate-700 rounded-lg text-xs font-bold hover:bg-slate-100 transition flex flex-col items-center justify-center gap-1 border-2 border-slate-200" onclick="mobileRefreshSelectedAccounts()">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                    </svg>
                    <span>刷新</span>
                  </button>
                </div>
                <div class="grid grid-cols-2 gap-2">
                  <button class="py-3 px-4 bg-red-50 text-red-600 rounded-lg text-sm font-bold hover:bg-red-100 transition flex items-center justify-center gap-2 border-2 border-red-200" onclick="deleteMobileSelectedAccounts()">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                    </svg>
                    删除选中
                  </button>
                  <button class="py-3 px-4 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg text-sm font-bold hover:from-red-600 hover:to-red-700 transition-all shadow-md hover:shadow-lg flex items-center justify-center gap-2" onclick="deleteMobileAllAccounts()">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                    </svg>
                    删除全部
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div class="mobile-card" id="mobile-multi-control-panel">
            <div class="flex items-center gap-3 mb-5 pb-4 border-b-2 border-orange-200">
              <div class="flex-shrink-0 w-10 h-10 rounded-full bg-gradient-to-br from-orange-500 to-orange-600 flex items-center justify-center shadow-lg">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                </svg>
              </div>
              <h3 class="text-2xl font-bold text-orange-700 tracking-tight">
                批量控制
              </h3>
            </div>

            <div class="mb-5 p-4 bg-white rounded-xl shadow-md border border-orange-100" id="mobile-multi-global-status-panel">
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-orange-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                  <span class="text-sm font-bold text-slate-700">🎯 全局状态</span>
                </div>
                <span id="mobile-multi-global-status" class="text-sm font-bold px-4 py-1.5 rounded-full bg-gradient-to-r from-slate-100 to-slate-200 text-slate-700 shadow-sm">
                  就绪
                </span>
              </div>
            </div>

            <div class="bg-white rounded-xl shadow-md p-4 mb-5 border border-orange-100">
              <div class="flex items-center gap-2 mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-orange-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <h4 class="text-base font-bold text-slate-800">快速操作</h4>
              </div>

              <div class="grid grid-cols-3 gap-3">
                <button class="py-4 px-3 bg-gradient-to-br from-green-500 to-green-600 text-white rounded-xl text-sm font-bold shadow-lg hover:shadow-xl hover:from-green-600 hover:to-green-700 transition-all duration-200 flex flex-col items-center justify-center gap-2" onclick="mobileStartAllAccounts()">
                  <div class="w-10 h-10 rounded-full bg-white/20 flex items-center justify-center">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"></path>
                    </svg>
                  </div>
                  <span>▶️ 全部启动</span>
                </button>

                <button class="py-4 px-3 bg-gradient-to-br from-red-500 to-red-600 text-white rounded-xl text-sm font-bold shadow-lg hover:shadow-xl hover:from-red-600 hover:to-red-700 transition-all duration-200 flex flex-col items-center justify-center gap-2" onclick="mobileStopAllAccounts()">
                  <div class="w-10 h-10 rounded-full bg-white/20 flex items-center justify-center">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z" clip-rule="evenodd"></path>
                    </svg>
                  </div>
                  <span>⏹️ 全部停止</span>
                </button>

                <button class="py-4 px-3 bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-xl text-sm font-bold shadow-lg hover:shadow-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-200 flex flex-col items-center justify-center gap-2" onclick="mobileRefreshAllAccounts()">
                  <div class="w-10 h-10 rounded-full bg-white/20 flex items-center justify-center">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                    </svg>
                  </div>
                  <span>🔄 全部刷新</span>
                </button>
              </div>
            </div>

            <div class="bg-white rounded-xl shadow-md p-4 mb-5 border border-orange-100" id="mobile-multi-running-stats-panel-2">
              <div class="flex items-center gap-2 mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-orange-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                </svg>
                <h4 class="text-base font-bold text-slate-800">📊 运行统计</h4>
              </div>

              <div class="grid grid-cols-3 gap-3">
                <div class="text-center p-4 bg-gradient-to-br from-green-50 to-green-100 rounded-xl border-2 border-green-200 shadow-sm">
                  <div class="flex items-center justify-center mb-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                    </svg>
                  </div>
                  <div id="mobile-multi-running-count" class="text-2xl font-bold text-green-600 mb-1">
                    0
                  </div>
                  <div class="text-xs text-green-700 font-semibold">运行中</div>
                </div>
                <div class="text-center p-4 bg-gradient-to-br from-yellow-50 to-yellow-100 rounded-xl border-2 border-yellow-200 shadow-sm" style="display: none;">
                  <div class="flex items-center justify-center mb-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-yellow-600" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                    </svg>
                  </div>
                  <div id="mobile-multi-paused-count" class="text-2xl font-bold text-yellow-600 mb-1">
                    0
                  </div>
                  <div class="text-xs text-yellow-700 font-semibold">
                    已暂停
                  </div>
                </div>
                <div class="text-center p-4 bg-gradient-to-br from-slate-50 to-slate-100 rounded-xl border-2 border-slate-200 shadow-sm">
                  <div class="flex items-center justify-center mb-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-slate-600" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z" clip-rule="evenodd"></path>
                    </svg>
                  </div>
                  <div id="mobile-multi-stopped-count" class="text-2xl font-bold text-slate-600 mb-1">
                    0
                  </div>
                  <div class="text-xs text-slate-700 font-semibold">已停止</div>
                </div>
              </div>
            </div>

            <!-- ========== 批量执行选项 ========== -->
            <div class="mt-4 pt-3 border-t border-slate-100 space-y-3">
              <!-- ========== 【问题16修复】随机启动延迟配置 ========== -->
              <div class="p-3 bg-blue-50 rounded-lg space-y-2">
                <label class="flex items-center gap-2 cursor-pointer">
                  <input type="checkbox" id="mobile-multi-random-delay-check" checked="" class="w-4 h-4 accent-orange-600 rounded flex-shrink-0">
                  <span class="text-sm text-slate-700 font-semibold">启用随机启动延迟</span>
                </label>

                <div class="flex items-center gap-2 ml-6">
                  <label class="text-xs text-slate-600 whitespace-nowrap">延迟范围：</label>
                  <div class="flex items-center gap-1 flex-1">
                    <input type="number" id="mobile-multi-random-delay-min" class="input-field !py-1 !text-sm flex-1 min-w-0" placeholder="最小" value="0" min="0" max="300" style="width: 70px">
                    <span class="text-xs text-slate-500">~</span>
                    <input type="number" id="mobile-multi-random-delay-max" class="input-field !py-1 !text-sm flex-1 min-w-0" placeholder="最大" value="300" min="0" max="600" style="width: 70px">
                    <span class="text-xs text-slate-500">秒</span>
                  </div>
                </div>
              </div>

              <label class="flex items-center gap-2 cursor-pointer p-2 bg-amber-50 rounded-lg hover:bg-amber-100 transition">
                <input type="checkbox" id="mobile-multi-only-incomplete-check" checked="" class="w-4 h-4 accent-orange-600 rounded flex-shrink-0">
                <span class="text-sm text-slate-700 font-semibold">仅启动未完成任务</span>
              </label>
            </div>
          </div>

          <!-- ========================================
             【地图面板】
             ======================================== -->
          <div class="mobile-card p-0 overflow-hidden h-screen flex flex-col" id="mobile-multi-map-panel">
            <div id="mobile-multi-map-container" class="w-full flex-1 relative bg-slate-100" style="height: calc(100vh - 60px)">
              <div class="absolute inset-0 flex items-center justify-center text-slate-400">
                <div class="text-center">
                  <svg class="w-12 h-12 mx-auto mb-2 text-slate-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path>
                  </svg>
                  <p class="text-sm">地图加载中...</p>
                </div>
              </div>

              <button id="mobile-multi-map-reset-btn" class="absolute top-4 right-4 p-2 bg-white rounded-lg shadow-lg border border-slate-200 hover:bg-slate-50 transition z-10" style="display: none" onclick="resetMultiMapView()" title="复位视角">
                <svg class="w-5 h-5 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path>
                </svg>
              </button>
            </div>

            <div class="flex gap-2 p-3 bg-slate-50 flex-shrink-0">
              <button class="flex-1 py-2 px-3 bg-white border border-slate-200 text-slate-600 rounded-lg text-xs font-medium hover:bg-slate-50 transition" onclick="mobileMultiZoomIn()">
                放大 +
              </button>
              <button class="flex-1 py-2 px-3 bg-white border border-slate-200 text-slate-600 rounded-lg text-xs font-medium hover:bg-slate-50 transition" onclick="mobileMultiZoomOut()">
                缩小 -
              </button>
              <button class="flex-1 py-2 px-3 bg-white border border-slate-200 text-slate-600 rounded-lg text-xs font-medium hover:bg-slate-50 transition" onclick="mobileMultiFitView()">
                适应 ⊡
              </button>
              <button class="flex-1 py-2 px-3 bg-white border border-slate-200 text-slate-600 rounded-lg text-xs font-medium hover:bg-slate-50 transition" onclick="resetMultiMapView()">
                复位 ⊙
              </button>
            </div>
          </div>

          <!-- ========================================
             【全局参数面板】
             ======================================== -->
          <div class="mobile-card mobile-card-fullscreen hidden" id="mobile-multi-settings-panel">
            <div class="flex items-center gap-2 mb-4 pb-3 border-b border-teal-100">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-teal-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path>
              </svg>
              <h3 class="text-xl font-bold text-teal-700">全局参数</h3>
            </div>

            <!-- ========================================
               【自动签到设置区域】
               用于配置多账号模式下的自动签到相关参数
               包含：开启开关、刷新间隔、随机半径
               ======================================== -->
            <div class="bg-amber-50 border border-amber-200 rounded-lg p-3 mb-3 space-y-3">
              <!-- 标题区域：图标 + 标题文字 -->
              <div class="flex items-center gap-2">
                <!-- 时钟图标：代表自动签到的定时特性 -->
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-amber-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <h4 class="font-semibold text-amber-800 text-sm">
                  自动签到设置
                </h4>
              </div>

              <!-- 开启自动签到开关：使用滑动开关样式 -->
              <div class="flex items-center justify-between">
                <label class="text-sm text-slate-700">开启自动签到</label>
                <!-- 滑动开关容器 -->
                <label class="relative inline-flex items-center cursor-pointer">
                  <!-- 隐藏的checkbox，用于存储实际值 -->
                  <input type="checkbox" id="mobile-multi-auto_attendance_enabled" data-key="auto_attendance_enabled" class="sr-only peer">
                  <!-- 滑动开关的视觉样式，使用Tailwind的peer修饰符实现状态切换效果 -->
                  <div class="w-11 h-6 bg-slate-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-amber-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-amber-500"></div>
                </label>
              </div>

              <!-- 刷新间隔设置：控制自动刷新通知的时间间隔 -->
              <div>
                <label class="block text-xs text-slate-600 mb-1">刷新间隔（秒）</label>
                <input type="number" id="mobile-multi-auto_attendance_refresh_s" data-key="auto_attendance_refresh_s" class="input-field !text-xs !py-1.5 w-full" placeholder="推荐值：60秒以上" min="30" step="30">
                <!-- 说明文字：帮助用户理解参数含义 -->
                <p class="text-[10px] text-slate-400 mt-1">
                  自动刷新通知的间隔时间，建议不低于60秒
                </p>
              </div>

              <!-- 随机半径设置：控制签到位置的随机偏移范围 -->
              <div>
                <label class="block text-xs text-slate-600 mb-1">随机半径（米）</label>
                <input type="number" id="mobile-multi-attendance_user_radius_m" data-key="attendance_user_radius_m" class="input-field !text-xs !py-1.5 w-full" placeholder="0表示精确签到" min="0" step="1">
                <!-- 说明文字：解释随机半径的用途 -->
                <p class="text-[10px] text-slate-400 mt-1">
                  签到位置的随机偏移半径，0为精确签到
                </p>
              </div>
            </div>

            <div id="mobile-multi-global-params-container" class="space-y-3 max-h-[60vh] overflow-y-auto"></div>

            <div class="pt-3 border-t border-teal-100">
              <button class="w-full py-2.5 bg-teal-500 text-white rounded-lg text-sm font-medium hover:bg-teal-600 transition flex items-center justify-center gap-2" onclick="saveMobileMultiGlobalSettings()">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                保存全局设置
              </button>
            </div>
          </div>

          <div class="mobile-card mobile-card-fullscreen hidden" id="mobile-multi-log-panel">
            <div class="flex items-center gap-2 mb-4 pb-3 border-b border-slate-100">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-slate-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
              </svg>
              <h3 class="text-xl font-bold text-slate-700">全局日志</h3>
            </div>

            <div class="flex-1 overflow-hidden rounded-lg p-3">
              <textarea id="mobile-multi-log-text" readonly="" class="w-full h-full bg-white text-slate-800 font-mono text-xs border border-slate-300 rounded-lg resize-none outline-none p-3" placeholder="等待日志输出..."></textarea>
            </div>

            <div class="flex gap-2 mt-4 pt-3 border-t border-slate-100">
              <button class="flex-1 py-2 px-4 bg-red-50 text-red-600 rounded-lg text-sm font-medium hover:bg-red-100 transition flex items-center justify-center gap-1" onclick="clearMobileMultiLog()">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                </svg>
                清空日志
              </button>
              <button class="flex-1 py-2 px-4 bg-slate-100 text-slate-600 rounded-lg text-sm font-medium hover:bg-slate-200 transition flex items-center justify-center gap-1" onclick="scrollMobileMultiLogToBottom()">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
                </svg>
                滚到底部
              </button>
            </div>
          </div>
        </div>
      </main>

      <!-- ========================================
         【移动端模态框区域】
         ======================================== -->

      <div id="mobile-user-details-modal" class="fixed inset-0 hidden mobile-modal z-50" onclick="toggleMobileUserDetails(false)">
        <div class="absolute inset-0 bg-black/40"></div>
        <div class="mobile-modal-content bg-white rounded-t-3xl p-6 space-y-4 max-h-[85vh] overflow-y-auto" onclick="event.stopPropagation()">
          <div class="flex justify-center mb-2">
            <div class="w-12 h-1.5 bg-slate-300 rounded-full"></div>
          </div>
          <div class="flex items-center justify-center gap-2 pb-3 border-b border-slate-200">
            <h3 class="text-xl font-bold text-sky-600 text-center">用户详情</h3>
          </div>
          <div id="mobile-user-details-content" class="text-sm space-y-1 max-h-[60vh] overflow-y-auto"></div>

          <div class="flex justify-between gap-2 pt-2">
            <button class="py-2 px-4 bg-red-50 text-red-600 rounded-lg text-sm font-medium hover:bg-red-100 transition flex items-center gap-1" onclick="toggleMobileUserDetails(false); mobileLogout();">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
              </svg>
              返回登录
            </button>
            <button class="mobile-primary-btn" onclick="toggleMobileUserDetails(false)">
              关闭
            </button>
          </div>
        </div>
      </div>

      <div id="mobile-task-details-modal" class="fixed inset-0 hidden mobile-modal z-50" onclick="toggleMobileTaskDetails(false)">
        <div class="absolute inset-0 bg-black/40"></div>
        <div class="mobile-modal-content bg-white rounded-t-3xl p-6 space-y-4 max-h-[85vh] overflow-y-auto" onclick="event.stopPropagation()">
          <div class="flex justify-center mb-2">
            <div class="w-12 h-1.5 bg-slate-300 rounded-full"></div>
          </div>
          <div class="flex items-center justify-center gap-2 pb-3 border-b border-slate-200">
            <h3 class="text-xl font-bold text-sky-600 text-center">任务详情</h3>
          </div>
          <div id="mobile-task-details-content" class="text-sm space-y-1 max-h-[60vh] overflow-y-auto"></div>
          <div class="flex justify-end pt-2">
            <button class="mobile-primary-btn" onclick="toggleMobileTaskDetails(false)">
              关闭
            </button>
          </div>
        </div>
      </div>

      <!-- ========================================
         【移动端历史记录模态框】
         ======================================== -->
      <div id="mobile-history-modal" class="fixed inset-0 hidden mobile-modal z-50" onclick="closeMobileHistoryModal()">
        <div class="absolute inset-0 bg-black/40"></div>
        <div class="mobile-modal-content bg-white rounded-t-3xl p-6 space-y-4 max-h-[85vh] overflow-y-auto" onclick="event.stopPropagation()">
          <div class="flex justify-center mb-2">
            <div class="w-12 h-1.5 bg-slate-300 rounded-full"></div>
          </div>
          <div class="flex items-center justify-between pb-3 border-b border-slate-200">
            <h3 class="text-xl font-bold text-purple-600">历史记录</h3>
            <span id="mobile-history-task-name" class="text-sm text-slate-600 bg-purple-50 px-3 py-1 rounded-full"></span>
          </div>
          <div id="mobile-history-list-content" class="space-y-2 max-h-[60vh] overflow-y-auto">
            <p class="text-slate-400 text-center py-10">加载中...</p>
          </div>
          <div class="flex justify-end pt-2">
            <button class="mobile-primary-btn" onclick="closeMobileHistoryModal()">
              关闭
            </button>
          </div>
        </div>
      </div>

      <!-- ========================================
         【移动端路径显示模态框】
         ======================================== -->
      <div id="mobile-track-modal" class="fixed inset-0 hidden mobile-modal z-50" onclick="closeMobileTrackModal()">
        <div class="absolute inset-0 bg-black/40"></div>
        <div class="mobile-modal-content bg-white rounded-t-3xl p-6 space-y-4 max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
          <div class="flex justify-center mb-2">
            <div class="w-12 h-1.5 bg-slate-300 rounded-full"></div>
          </div>
          <div class="flex items-center justify-between pb-3 border-b border-slate-200">
            <h3 class="text-xl font-bold text-teal-600">跑步路径</h3>
            <span id="mobile-track-time" class="text-xs text-slate-600 bg-teal-50 px-2 py-1 rounded-full"></span>
          </div>

          <div class="grid grid-cols-3 gap-2" id="mobile-track-summary">
            <div class="p-2 bg-blue-50 rounded-lg text-center">
              <p class="text-xs text-slate-500 mb-1">距离</p>
              <p id="mobile-track-distance" class="font-bold text-sm text-blue-600">
                -- km
              </p>
            </div>
            <div class="p-2 bg-green-50 rounded-lg text-center">
              <p class="text-xs text-slate-500 mb-1">时长</p>
              <p id="mobile-track-duration" class="font-bold text-sm text-green-600">
                --:--
              </p>
            </div>
            <div class="p-2 bg-purple-50 rounded-lg text-center">
              <p class="text-xs text-slate-500 mb-1">配速</p>
              <p id="mobile-track-pace" class="font-bold text-sm text-purple-600">
                --:--
              </p>
            </div>
          </div>

          <div class="bg-slate-100 rounded-xl overflow-hidden border-2 border-slate-200">
            <div id="mobile-track-map-container" class="w-full h-[300px] relative">
              <div class="absolute inset-0 flex items-center justify-center text-slate-400">
                <div class="text-center">
                  <svg class="w-12 h-12 mx-auto mb-2 text-slate-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path>
                  </svg>
                  <p class="text-sm">加载路径中...</p>
                </div>
              </div>
            </div>
          </div>

          <div class="flex gap-2">
            <button class="flex-1 py-2 px-3 bg-white border border-slate-200 text-slate-600 rounded-lg text-xs font-medium hover:bg-slate-50 transition" onclick="mobileTrackZoomIn()">
              放大 +
            </button>
            <button class="flex-1 py-2 px-3 bg-white border border-slate-200 text-slate-600 rounded-lg text-xs font-medium hover:bg-slate-50 transition" onclick="mobileTrackZoomOut()">
              缩小 -
            </button>
            <button class="flex-1 py-2 px-3 bg-white border border-slate-200 text-slate-600 rounded-lg text-xs font-medium hover:bg-slate-50 transition" onclick="mobileTrackFitView()">
              适应 ⊡
            </button>
          </div>

          <div class="flex justify-end pt-2 border-t border-slate-100">
            <button class="mobile-primary-btn" onclick="closeMobileTrackModal()">
              关闭
            </button>
          </div>
        </div>
      </div>

      <div id="mobile-map-attendance-modal" class="fixed inset-0 hidden mobile-modal z-50" onclick="closeMobileMapAttendanceModal()">
        <div class="absolute inset-0 bg-black/50 backdrop-blur-sm"></div>

        <div class="mobile-modal-content bg-white rounded-t-3xl p-6 space-y-4 max-h-[90vh] flex flex-col shadow-2xl" onclick="event.stopPropagation()">
          <div class="flex justify-center mb-2">
            <div class="w-12 h-1.5 bg-slate-300 rounded-full"></div>
          </div>

          <div class="flex items-center justify-between pb-3 border-b-2 border-purple-200">
            <div class="flex items-center gap-2">
              <div class="w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-purple-600 flex items-center justify-center shadow-md">
                <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                  <path stroke-linecap="round" stroke-linejoin="round" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                </svg>
              </div>
              <h3 class="text-xl font-bold text-purple-700">📍 地图选点签到</h3>
            </div>
          </div>

          <div class="bg-purple-50 border-2 border-purple-200 rounded-xl p-3">
            <div class="flex items-start gap-2">
              <svg class="w-5 h-5 text-purple-600 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <div class="flex-1">
                <p class="text-sm font-bold text-purple-900 mb-1">操作提示</p>
                <p class="text-xs text-purple-700">
                  ① 点击地图选择签到位置<br>
                  ② 红色标记为选中位置<br>
                  ③ 点击"确认签到"提交
                </p>
              </div>
            </div>
          </div>

          <div class="bg-slate-50 border border-slate-200 rounded-lg p-3">
            <div class="flex items-center justify-between">
              <span class="text-sm font-bold text-slate-700">选中坐标：</span>
              <span id="mobile-map-attendance-coords" class="text-sm font-mono text-slate-600 bg-white px-3 py-1 rounded-md border border-slate-200">
                未选择
              </span>
            </div>
          </div>

          <div class="flex-1 bg-slate-100 rounded-xl overflow-hidden border-2 border-slate-200 shadow-inner" style="min-height: 300px">
            <div id="mobile-map-attendance-container" class="w-full h-full relative">
              <div class="absolute inset-0 flex items-center justify-center text-slate-400 bg-slate-50">
                <div class="text-center">
                  <svg class="w-16 h-16 mx-auto mb-3 text-slate-300 animate-pulse" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path>
                  </svg>
                  <p class="text-sm font-semibold">加载地图中...</p>
                </div>
              </div>
            </div>
          </div>

          <div class="flex gap-3 pt-3 border-t-2 border-slate-100">
            <button class="flex-1 py-3 px-4 bg-slate-100 text-slate-700 rounded-xl text-sm font-bold hover:bg-slate-200 transition-all border-2 border-slate-200" onclick="closeMobileMapAttendanceModal()">
              取消
            </button>
            <button id="mobile-map-attendance-confirm-btn" class="flex-1 py-3 px-4 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-xl text-sm font-bold hover:from-purple-600 hover:to-purple-700 transition-all shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed" onclick="confirmMobileMapAttendance()" disabled="">
              <span class="flex items-center justify-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path>
                </svg>
                确认签到
              </span>
            </button>
          </div>
        </div>
      </div>

      <!-- ========================================
         【移动端验证码历史记录模态框】
         专用于移动端查看验证码生成和验证历史
         ======================================== -->
      <div id="mobile-captcha-history-modal" class="fixed inset-0 hidden mobile-modal z-50" onclick="closeMobileCaptchaHistoryModal()">
        <!-- 半透明背景遮罩 -->
        <div class="absolute inset-0 bg-black/40"></div>
        <!-- 模态框内容区域 -->
        <div class="mobile-modal-content bg-white rounded-t-3xl p-6 space-y-4 max-h-[85vh] overflow-y-auto" onclick="event.stopPropagation()">
          <!-- 顶部拖动指示器 -->
          <div class="flex justify-center mb-2">
            <div class="w-12 h-1.5 bg-slate-300 rounded-full"></div>
          </div>
          <!-- 标题栏 -->
          <div class="flex items-center justify-between pb-3 border-b border-slate-200">
            <h3 class="text-xl font-bold text-purple-600">📜 验证码历史记录</h3>
            <button class="py-1 px-3 bg-purple-50 text-purple-600 rounded-lg text-sm font-medium hover:bg-purple-100 transition" onclick="loadMobileCaptchaHistoryModal()">
              🔄 刷新
            </button>
          </div>
          <!-- 筛选条件区域 -->
          <div class="flex gap-2 items-center">
            <div class="flex-1">
              <label class="block text-xs text-slate-500 mb-1">选择日期</label>
              <input type="date" id="mobile-captcha-history-modal-date" class="input-field text-sm w-full !py-2">
            </div>
            <div class="flex-1">
              <label class="block text-xs text-slate-500 mb-1">状态筛选</label>
              <select id="mobile-captcha-history-modal-status" class="select-field text-sm w-full !py-2">
                <option value="">全部状态</option>
                <option value="verified_success">✅ 验证成功</option>
                <option value="verified_failed">❌ 验证失败</option>
                <option value="test_generated">🧪 测试生成</option>
                <option value="created">⏳ 待验证</option>
                <option value="expired">⏰ 已过期</option>
              </select>
            </div>
          </div>
          <!-- 历史记录列表 -->
          <div id="mobile-captcha-history-modal-list" class="space-y-2 max-h-[50vh] overflow-y-auto">
            <p class="text-slate-400 text-center py-10 text-sm">
              点击刷新加载数据...
            </p>
          </div>
          <!-- 底部按钮 -->
          <div class="flex justify-end pt-2 border-t border-slate-200">
            <button class="mobile-primary-btn" onclick="closeMobileCaptchaHistoryModal()">
              关闭
            </button>
          </div>
        </div>
      </div>

      <div id="mobile-notifications-modal" class="fixed inset-0 hidden mobile-modal z-50" onclick="toggleMobileNotifications(false)">
        <div class="absolute inset-0 bg-black/40"></div>
        <div class="mobile-modal-content bg-white rounded-t-3xl p-6 space-y-4 max-h-[85vh] overflow-y-auto" onclick="event.stopPropagation()">
          <div class="flex justify-center mb-2">
            <div class="w-12 h-1.5 bg-slate-300 rounded-full"></div>
          </div>
          <div class="flex items-center justify-center gap-2 pb-3 border-b border-slate-200">
            <h3 class="text-xl font-bold text-sky-600 text-center">通知中心</h3>
          </div>
          <div id="mobile-notifications-content" class="text-sm space-y-2 max-h-[60vh] overflow-y-auto pr-2">
            <p class="text-slate-400 text-center py-10">正在加载...</p>
          </div>
          <div class="flex justify-between items-center pt-2">
            <div class="flex gap-2">
              <button id="mobile-refresh-notifications-modal-btn" class="py-2 px-4 bg-sky-50 text-sky-600 rounded-lg text-sm font-medium hover:bg-sky-100 transition">
                刷新
              </button>
              <button id="mobile-mark-all-read-modal-btn" class="py-2 px-4 bg-slate-100 text-slate-600 rounded-lg text-sm font-medium hover:bg-slate-200 transition">
                一键已读
              </button>
            </div>
            <button class="mobile-primary-btn" onclick="toggleMobileNotifications(false)">
              关闭
            </button>
          </div>
        </div>
      </div>

      <div id="mobile-admin-panel-modal" class="fixed inset-0 hidden mobile-modal z-50" onclick="toggleMobileAdminPanel(false)">
        <div class="absolute inset-0 bg-black/40"></div>
        <div class="mobile-modal-content bg-white rounded-t-3xl p-6 space-y-4 max-h-[85vh] overflow-y-auto" onclick="event.stopPropagation()">
          <div class="flex justify-center mb-2">
            <div class="w-12 h-1.5 bg-slate-300 rounded-full"></div>
          </div>
          <div class="flex items-center justify-center gap-2 pb-3 border-b border-slate-200">
            <svg class="w-6 h-6 text-sky-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
            <h3 class="text-xl font-bold text-sky-600 text-center">管理面板</h3>
          </div>
          <div id="mobile-admin-tabs-nav" class="flex border-b-2 border-slate-200 overflow-x-auto gap-1 pb-0 -mx-2 px-2" style="scrollbar-width: none"></div>
          <div id="mobile-admin-panel-content" class="text-sm space-y-2 max-h-[60vh] overflow-y-auto">
            <p class="text-slate-400 text-center py-10">加载中...</p>
          </div>
          <div class="flex justify-end pt-2">
            <button class="mobile-primary-btn" onclick="toggleMobileAdminPanel(false)">
              关闭
            </button>
          </div>
        </div>
      </div>

      <div id="mobile-account-params-modal" class="fixed inset-0 hidden mobile-modal z-50" onclick="closeMobileAccountParams()">
        <div class="absolute inset-0 bg-black/40"></div>
        <div class="mobile-modal-content bg-white rounded-t-3xl p-6 space-y-4 max-h-[85vh] overflow-y-auto" onclick="event.stopPropagation()">
          <div class="flex justify-center mb-2">
            <div class="w-12 h-1.5 bg-slate-300 rounded-full"></div>
          </div>
          <div class="flex items-center justify-center gap-2 pb-3 border-b border-slate-200">
            <h3 id="mobile-account-params-title" class="text-xl font-bold text-sky-600 text-center">
              账号参数设置
            </h3>
          </div>
          <div id="mobile-account-params-container" class="text-sm space-y-2 max-h-[60vh] overflow-y-auto pr-2"></div>
          <div class="flex justify-end gap-3 pt-2">
            <button class="py-2 px-4 bg-slate-100 text-slate-600 rounded-lg text-sm font-medium hover:bg-slate-200 transition" onclick="closeMobileAccountParams()">
              取消
            </button>
            <button id="mobile-save-account-params-btn" class="mobile-primary-btn">
              保存
            </button>
          </div>
        </div>
      </div>

      <div id="mobile-multi-admin-panel-modal" class="fixed inset-0 hidden mobile-modal z-50" onclick="toggleMobileMultiAdminPanel(false)">
        <div class="absolute inset-0 bg-black/40"></div>
        <div class="mobile-modal-content bg-white rounded-t-3xl p-6 space-y-4 max-h-[85vh] overflow-y-auto" onclick="event.stopPropagation()">
          <div class="flex justify-center mb-2">
            <div class="w-12 h-1.5 bg-slate-300 rounded-full"></div>
          </div>

          <div class="flex items-center justify-center gap-2 pb-3 border-b border-slate-200">
            <svg class="w-6 h-6 text-sky-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
            <h3 class="text-xl font-bold text-sky-600 text-center">
              多账号管理面板
            </h3>
          </div>

          <div id="mobile-multi-admin-tabs-nav-panel" class="flex border-b-2 border-slate-200 overflow-x-auto gap-1 pb-0 -mx-2 px-2" style="scrollbar-width: none; -webkit-overflow-scrolling: touch"></div>

          <div id="mobile-multi-admin-panel-content" class="text-sm space-y-2 max-h-[60vh] overflow-y-auto min-h-[300px]">
            <div id="mobile-multi-admin-users-panel" class="space-y-3">
              <div class="flex justify-between items-center">
                <h4 class="font-semibold text-sm">用户列表</h4>
                <div class="flex gap-2">
                  <button id="mobile-multi-admin-create-user" class="btn btn-primary !py-1 !px-2 text-xs">
                    新增
                  </button>
                  <button id="mobile-multi-admin-refresh-users" class="btn btn-ghost !py-1 !px-2 text-xs">
                    刷新
                  </button>
                </div>
              </div>
              <div id="mobile-multi-admin-users-list" class="space-y-2">
                <p class="text-slate-400 text-center py-10 text-xs">
                  加载中...
                </p>
              </div>
            </div>

            <div id="mobile-multi-admin-groups-panel" class="hidden space-y-3">
              <div class="flex justify-between items-center">
                <h4 class="font-semibold text-sm">权限组列表</h4>
                <div class="flex gap-2">
                  <button id="mobile-multi-admin-create-group" class="btn btn-primary !py-1 !px-2 text-xs" onclick="showMobileCreateGroupModal()">
                    新增
                  </button>
                  <button id="mobile-multi-admin-refresh-groups" class="btn btn-ghost !py-1 !px-2 text-xs" onclick="switchMobileAdminTab('groups', 'mobile-multi-admin-panel')">
                    刷新
                  </button>
                </div>
              </div>
              <div id="mobile-multi-admin-groups-list" class="space-y-2">
                <p class="text-slate-400 text-center py-10 text-xs">
                  加载中...
                </p>
              </div>
            </div>

            <div id="mobile-multi-admin-logs-panel" class="hidden space-y-3">
              <div class="flex justify-between items-center">
                <h4 class="font-semibold text-sm">系统日志</h4>
                <button class="btn btn-ghost !py-1 !px-2 text-xs" onclick="switchMobileAdminTab('logs', 'mobile-multi-admin-panel')">
                  刷新
                </button>
              </div>
              <div class="bg-slate-900 text-green-400 rounded-lg p-3 font-mono text-xs overflow-auto max-h-[45vh]">
                <pre id="mobile-multi-admin-logs-content" class="whitespace-pre-wrap">加载中...</pre>
              </div>
            </div>

            <div id="mobile-multi-admin-health-panel" class="hidden space-y-3">
              <div class="flex justify-between items-center">
                <h4 class="font-semibold text-sm">系统状态</h4>
                <button class="btn btn-ghost !py-1 !px-2 text-xs" onclick="switchMobileAdminTab('health', 'mobile-multi-admin-panel')">
                  刷新
                </button>
              </div>
              <div id="mobile-multi-admin-health-content" class="space-y-3">
                <p class="text-slate-400 text-center py-10 text-xs">
                  加载中...
                </p>
              </div>
            </div>

            <div id="mobile-multi-admin-profile-panel" class="hidden space-y-3">
              <div class="flex justify-between items-center">
                <h4 class="font-semibold text-sm">个人信息</h4>
                <button class="btn btn-ghost !py-1 !px-2 text-xs" onclick="switchMobileAdminTab('profile', 'mobile-multi-admin-panel')">
                  刷新
                </button>
              </div>
              <div id="mobile-multi-admin-profile-content" class="space-y-3 text-slate-800">
                <p class="text-slate-400 text-center py-10 text-xs">
                  加载中...
                </p>
              </div>
            </div>

            <div id="mobile-multi-admin-sessions-panel" class="hidden space-y-3">
              <div class="flex justify-between items-center">
                <h4 class="font-semibold text-sm">会话列表</h4>
                <button class="btn btn-ghost !py-1 !px-2 text-xs" onclick="switchMobileAdminTab('sessions', 'mobile-multi-admin-panel')">
                  刷新
                </button>
              </div>
              <div id="mobile-multi-admin-sessions-list" class="space-y-2">
                <p class="text-slate-400 text-center py-10 text-xs">
                  加载中...
                </p>
              </div>
            </div>

            <div id="mobile-multi-admin-messages-panel" class="hidden space-y-3">
              <div class="flex justify-between items-center">
                <h4 class="font-semibold text-sm">留言板</h4>
                <button class="btn btn-ghost !py-1 !px-2 text-xs" onclick="switchMobileAdminTab('messages', 'mobile-multi-admin-panel')">
                  刷新
                </button>
              </div>
              <!-- 留言列表容器 -->
              <!-- 美化后的移动端留言列表：添加背景色、圆角、边框、阴影等视觉效果 -->
              <!-- 使用 max-h-[50vh] 限制最大高度为视口的50%，确保不会占用过多屏幕空间 -->
              <!-- scroll-smooth 提供平滑滚动体验，提升用户交互感受 -->
              <div id="mobile-multi-admin-messages-list" class="space-y-2 max-h-[50vh] overflow-y-auto bg-slate-50 rounded-lg p-3 border border-slate-200 shadow-sm scroll-smooth">
                <!-- 加载占位提示 -->
                <!-- 使用 animate-pulse 添加脉冲动画效果，让加载状态更生动 -->
                <!-- 添加 flex 布局使加载图标和文字居中对齐 -->
                <div class="flex flex-col items-center justify-center py-10 space-y-2">
                  <!-- 加载动画图标：使用 SVG 旋转动画 -->
                  <svg class="animate-spin h-6 w-6 text-slate-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                  </svg>
                  <!-- 加载文字提示 -->
                  <p class="text-slate-400 text-center text-xs animate-pulse">
                    加载中...
                  </p>
                </div>
              </div>
            </div>

            <div id="mobile-multi-admin-ipban-panel" class="hidden space-y-3">
              <div class="flex justify-between items-center">
                <h4 class="font-semibold text-sm">IP封禁</h4>
                <button class="btn btn-ghost !py-1 !px-2 text-xs" onclick="switchMobileAdminTab('ipban', 'mobile-multi-admin-panel')">
                  刷新
                </button>
              </div>
              <div class="bg-slate-50 border border-slate-200 rounded-lg p-3">
                <h5 class="font-semibold text-slate-700 text-xs mb-2">
                  现有规则
                </h5>
                <div id="mobile-multi-ip-ban-list" class="space-y-2">
                  <p class="text-slate-400 text-center py-6 text-xs">
                    加载中...
                  </p>
                </div>
              </div>
            </div>

            <div id="mobile-multi-admin-sms-panel" class="hidden space-y-3">
              <div class="flex justify-between items-center">
                <h4 class="font-semibold text-sm">短信配置</h4>
                <button class="btn btn-ghost !py-1 !px-2 text-xs" onclick="switchMobileAdminTab('sms', 'mobile-multi-admin-panel')">
                  刷新
                </button>
              </div>
              <div id="mobile-multi-admin-sms-content" class="space-y-3">
                <p class="text-slate-400 text-center py-10 text-xs">
                  加载中...
                </p>
              </div>
            </div>

            <div id="mobile-multi-admin-config-panel" class="hidden space-y-3">
              <div class="flex justify-between items-center">
                <h4 class="font-semibold text-sm">系统配置</h4>
                <button class="btn btn-ghost !py-1 !px-2 text-xs" onclick="switchMobileAdminTab('config', 'mobile-multi-admin-panel')">
                  刷新
                </button>
              </div>
              <div id="mobile-multi-admin-config-content" class="space-y-3">
                <p class="text-slate-400 text-center py-10 text-xs">
                  加载中...
                </p>
              </div>
            </div>

            <div id="mobile-multi-admin-captcha-panel" class="hidden space-y-3">
              <div id="mobile-captcha-settings-view">
                <div class="flex justify-between items-center">
                  <h4 class="font-semibold text-sm">验证码设置</h4>
                  <button class="btn btn-ghost !py-1 !px-2 text-xs" onclick="mobileLoadCaptchaSettings()">
                    刷新
                  </button>
                </div>
                <div id="mobile-multi-admin-captcha-list" class="space-y-2">
                  <p class="text-slate-400 text-center py-10 text-xs">
                    加载中...
                  </p>
                </div>
              </div>

              <div id="mobile-captcha-history-view" class="hidden space-y-3">
                <div class="flex justify-between items-center">
                  <div class="flex items-center gap-2">
                    <button onclick="toggleMobileCaptchaView('settings')" class="p-1 rounded hover:bg-slate-100 text-slate-500">
                      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                      </svg>
                    </button>
                    <h4 class="font-semibold text-sm">历史记录</h4>
                  </div>
                  <button class="btn btn-ghost !py-1 !px-2 text-xs" onclick="mobileLoadCaptchaHistory()">
                    刷新
                  </button>
                </div>

                <div class="flex gap-2">
                  <input type="date" id="mobile-captcha-date" class="input-field text-xs flex-1 !py-1">
                  <select id="mobile-captcha-status" class="select-field text-xs flex-1 !py-1">
                    <option value="">全部状态</option>
                    <option value="verified_success">成功</option>
                    <option value="verified_failed">失败</option>
                    <option value="test_generated">测试</option>
                  </select>
                </div>

                <div id="mobile-captcha-history-list" class="space-y-2 max-h-[50vh] overflow-y-auto">
                  <p class="text-slate-400 text-center py-10 text-xs">
                    加载中...
                  </p>
                </div>
              </div>
            </div>

            <div id="mobile-multi-admin-reminders-panel" class="hidden space-y-3">
              <div class="flex justify-between items-center">
                <h4 class="font-semibold text-sm">定时提醒</h4>
                <button class="btn btn-ghost !py-1 !px-2 text-xs" onclick="switchMobileAdminTab('reminders', 'mobile-multi-admin-panel')">
                  刷新
                </button>
              </div>
              <!-- 定时提醒列表容器 -->
              <!-- 美化后的移动端定时提醒列表：添加背景色、圆角、边框、阴影等视觉效果 -->
              <!-- 使用 max-h-[50vh] 限制最大高度为视口的50%，确保不会占用过多屏幕空间 -->
              <!-- scroll-smooth 提供平滑滚动体验，提升用户交互感受 -->
              <div id="mobile-multi-admin-reminders-content" class="space-y-2 max-h-[50vh] overflow-y-auto bg-slate-50 rounded-lg p-3 border border-slate-200 shadow-sm scroll-smooth">
                <!-- 加载占位提示 -->
                <!-- 使用 animate-pulse 添加脉冲动画效果，让加载状态更生动 -->
                <!-- 添加 flex 布局使加载图标和文字居中对齐 -->
                <div class="flex flex-col items-center justify-center py-10 space-y-2">
                  <!-- 加载动画图标：使用 SVG 旋转动画 -->
                  <svg class="animate-spin h-6 w-6 text-slate-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                  </svg>
                  <!-- 加载文字提示 -->
                  <p class="text-slate-400 text-center text-xs animate-pulse">
                    加载中...
                  </p>
                </div>
              </div>
            </div>

            <div id="mobile-multi-admin-ssl-panel" class="hidden space-y-3">
              <div class="flex justify-between items-center">
                <h4 class="font-semibold text-sm">HTTPS设置</h4>
                <button class="btn btn-ghost !py-1 !px-2 text-xs" onclick="switchMobileAdminTab('ssl', 'mobile-multi-admin-panel')">
                  刷新
                </button>
              </div>
              <div id="mobile-multi-admin-ssl-content" class="space-y-3">
                <p class="text-slate-400 text-center py-10 text-xs">
                  加载中...
                </p>
              </div>
            </div>
          </div>

          <div class="flex justify-end pt-2 border-t border-slate-100">
            <button class="mobile-primary-btn" onclick="toggleMobileMultiAdminPanel(false)">
              关闭
            </button>
          </div>
        </div>
      </div>

      <div id="mobile-manual-account-modal" class="fixed inset-0 hidden mobile-modal z-50" onclick="closeManualAccountModal()">
        <div class="absolute inset-0 bg-black/40"></div>
        <div class="mobile-modal-content bg-white rounded-t-3xl p-6 space-y-4 max-h-[85vh] overflow-y-auto" onclick="event.stopPropagation()">
          <div class="flex justify-center mb-2">
            <div class="w-12 h-1.5 bg-slate-300 rounded-full"></div>
          </div>
          <div class="flex items-center justify-center gap-2 pb-3 border-b border-slate-200">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-teal-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
            </svg>
            <h3 class="text-xl font-bold text-teal-600 text-center">
              手动添加账号
            </h3>
          </div>

          <div class="space-y-4">
            <div>
              <label class="block text-sm font-semibold text-slate-700 mb-2">用户名</label>
              <input type="text" id="manual-account-username" class="w-full px-3 py-2 bg-white border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none" placeholder="请输入学校账号用户名" autocomplete="username">
            </div>

            <div>
              <label class="block text-sm font-semibold text-slate-700 mb-2">密码</label>
              <input type="password" id="manual-account-password" class="w-full px-3 py-2 bg-white border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none" placeholder="请输入密码" autocomplete="current-password">
            </div>

            <div class="p-3 bg-teal-50 border border-teal-200 rounded-lg">
              <p class="text-xs text-teal-700">
                <strong>提示：</strong>手动添加的账号将使用默认配置。如需修改配置，请在账号列表中点击"参数设置"。
              </p>
            </div>
          </div>

          <div class="flex gap-3 pt-2">
            <button class="flex-1 py-2 px-4 bg-slate-100 text-slate-600 rounded-lg text-sm font-medium hover:bg-slate-200 transition" onclick="closeManualAccountModal()">
              取消
            </button>
            <button class="flex-1 py-2 px-4 bg-teal-500 text-white rounded-lg text-sm font-medium hover:bg-teal-600 transition" onclick="confirmManualAccountAdd()">
              添加
            </button>
          </div>
        </div>
      </div>

      <div id="mobile-create-user-modal" class="fixed inset-0 hidden mobile-modal z-[60]" onclick="closeMobileCreateUserModal()">
        <div class="absolute inset-0 bg-black/40"></div>
        <div class="mobile-modal-content bg-white rounded-t-3xl p-6 space-y-4 max-h-[85vh] overflow-y-auto" onclick="event.stopPropagation()">
          <div class="flex justify-center mb-2">
            <div class="w-12 h-1.5 bg-slate-300 rounded-full"></div>
          </div>
          <div class="flex items-center justify-center gap-2 pb-3 border-b border-slate-200">
            <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"></path>
            </svg>
            <h3 class="text-xl font-bold text-blue-600 text-center">
              创建新用户
            </h3>
          </div>

          <div class="space-y-4">
            <div>
              <label class="block text-sm font-semibold text-slate-700 mb-2">账号 (必填)</label>
              <input type="text" id="mobile-new-username" class="w-full px-3 py-3 bg-slate-50 border border-slate-200 rounded-xl text-base focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all" placeholder="请输入账号（3-20字符，不含中文）" autocomplete="off">
            </div>

            <div>
              <label class="block text-sm font-semibold text-slate-700 mb-2">密码 (必填)</label>
              <input type="txt" id="mobile-new-password" class="w-full px-3 py-3 bg-slate-50 border border-slate-200 rounded-xl text-base focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all" placeholder="请输入密码（至少6字符）" autocomplete="new-password">
            </div>

            <div>
              <label class="block text-sm font-semibold text-slate-700 mb-2">昵称 (可选)</label>
              <input type="text" id="mobile-new-nickname" class="w-full px-3 py-3 bg-slate-50 border border-slate-200 rounded-xl text-base focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all" placeholder="请输入昵称">
            </div>

            <div>
              <label class="block text-sm font-semibold text-slate-700 mb-2">手机号 (可选)</label>
              <div class="flex items-center w-full bg-slate-50 border border-slate-200 rounded-xl overflow-hidden">
                <span class="pl-3 pr-2 text-slate-500 font-medium">+86</span>
                <input type="tel" id="mobile-new-phone" class="flex-1 px-2 py-3 bg-transparent text-base outline-none" placeholder="请输入手机号" inputmode="numeric" maxlength="11" pattern="[0-9]*">
              </div>
            </div>

            <!-- 验证码输入区域（仅在输入手机号后显示） -->
            <div id="mobile-new-sms-group" style="display: none">
              <label class="block text-sm font-semibold text-slate-700 mb-2">验证码 (可选)</label>
              <div class="flex gap-2">
                <input type="text" id="mobile-new-sms-code" class="flex-1 px-3 py-3 bg-slate-50 border border-slate-200 rounded-xl text-base focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all" placeholder="请输入验证码" inputmode="numeric" maxlength="6" pattern="[0-9]*">
                <button type="button" id="mobile-new-send-code-btn" onclick="sendMobileNewUserCode()" class="px-4 py-3 bg-sky-500 text-white rounded-xl text-sm font-bold whitespace-nowrap">
                  发送
                </button>
              </div>
            </div>

            <div class="p-3 bg-blue-50 border border-blue-100 rounded-lg text-xs text-blue-700">
              <p>💡 管理员创建用户时验证码为可选项，如填写验证码将进行校验。</p>
            </div>
          </div>

          <div class="flex gap-3 pt-2">
            <button class="flex-1 py-3 px-4 bg-slate-100 text-slate-600 rounded-xl text-sm font-bold hover:bg-slate-200 transition" onclick="closeMobileCreateUserModal()">
              取消
            </button>
            <button class="flex-1 py-3 px-4 bg-blue-600 text-white rounded-xl text-sm font-bold hover:bg-blue-700 transition shadow-md shadow-blue-200" onclick="submitMobileCreateUser()" id="mobile-new-user-confirm-btn">
              立即创建
            </button>
          </div>
        </div>
      </div>

      <div id="mobile-more-menu-modal" class="fixed inset-0 hidden mobile-modal z-50" onclick="toggleMobileMoreMenu(false)">
        <div class="absolute inset-0 bg-black/40"></div>
        <div class="mobile-modal-content bg-white rounded-t-3xl p-6 space-y-4" onclick="event.stopPropagation()">
          <div class="flex justify-center mb-2">
            <div class="w-12 h-1.5 bg-slate-300 rounded-full"></div>
          </div>
          <div class="flex items-center justify-center gap-2 pb-3 border-b border-slate-200">
            <h3 class="text-xl font-bold text-slate-700">更多功能</h3>
          </div>
          <div class="space-y-2">
            <button class="w-full flex items-center gap-3 p-4 bg-slate-50 hover:bg-slate-100 rounded-xl transition" onclick="toggleMobileMoreMenu(false); switchMobileSinglePanel('mobile-notification-panel'); setTimeout(() => switchMobileNotifTab('attendance'), 100);">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
              </svg>
              <div class="flex-1 text-left">
                <div class="font-semibold text-slate-700">签到管理</div>
                <div class="text-xs text-slate-500">查看签到任务</div>
              </div>
            </button>

            <button class="w-full flex items-center gap-3 p-4 bg-slate-50 hover:bg-slate-100 rounded-xl transition" onclick="toggleMobileMoreMenu(false); openMobileAdminPanelUnified('single');">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-purple-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
              </svg>
              <div class="flex-1 text-left">
                <div class="font-semibold text-slate-700">管理面板</div>
                <div class="text-xs text-slate-500">系统管理设置</div>
              </div>
            </button>

            <button class="w-full flex items-center gap-3 p-4 bg-slate-50 hover:bg-slate-100 rounded-xl transition" onclick="toggleMobileMoreMenu(false); toggleMobileUserDetails(true);">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
              </svg>
              <div class="flex-1 text-left">
                <div class="font-semibold text-slate-700">我的资料</div>
                <div class="text-xs text-slate-500">查看个人信息</div>
              </div>
            </button>

            <button class="w-full flex items-center gap-3 p-4 bg-red-50 hover:bg-red-100 rounded-xl transition" onclick="toggleMobileMoreMenu(false); mobileLogout();">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
              </svg>
              <div class="flex-1 text-left">
                <div class="font-semibold text-red-700">退出登录</div>
                <div class="text-xs text-red-500">安全退出系统</div>
              </div>
            </button>
          </div>
          <div class="flex justify-center pt-2">
            <button class="w-full py-3 bg-slate-100 text-slate-600 rounded-xl font-medium hover:bg-slate-200 transition" onclick="toggleMobileMoreMenu(false)">
              关闭
            </button>
          </div>
        </div>
      </div>

      <!-- ========================================
         【移动端自定义确认对话框】
         ======================================== -->
      <div id="mobile-confirm-modal" class="fixed inset-0 hidden z-[60] flex items-center justify-center p-4" style="background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(4px)">
        <div class="bg-gradient-to-br from-slate-50 to-white rounded-3xl shadow-2xl max-w-sm w-full transform transition-all" style="
            box-shadow: 12px 12px 24px rgba(0, 0, 0, 0.1),
              -12px -12px 24px rgba(255, 255, 255, 0.9);
          " onclick="event.stopPropagation()">
          <div class="p-6 pb-4 border-b border-slate-200">
            <div class="flex items-center gap-3">
              <div class="w-12 h-12 rounded-full bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center flex-shrink-0" style="
                  box-shadow: 4px 4px 8px rgba(251, 146, 60, 0.3),
                    -2px -2px 8px rgba(255, 255, 255, 0.8);
                ">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                </svg>
              </div>
              <h3 id="mobile-confirm-title" class="text-xl font-bold text-slate-800">
                确认操作
              </h3>
            </div>
          </div>

          <div class="p-6 py-8">
            <p id="mobile-confirm-message" class="text-slate-600 text-base leading-relaxed">
              确定要执行此操作吗？
            </p>
          </div>

          <div class="p-6 pt-0 flex gap-3">
            <button id="mobile-confirm-cancel-btn" class="flex-1 py-3 px-4 rounded-xl font-semibold text-slate-600 bg-slate-100 hover:bg-slate-200 transition-all" style="
                box-shadow: 4px 4px 8px rgba(0, 0, 0, 0.08),
                  -2px -2px 8px rgba(255, 255, 255, 0.9);
              ">
              取消
            </button>
            <button id="mobile-confirm-ok-btn" class="flex-1 py-3 px-4 rounded-xl font-semibold text-white bg-gradient-to-br from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 transition-all" style="
                box-shadow: 4px 4px 12px rgba(239, 68, 68, 0.3),
                  -2px -2px 8px rgba(255, 255, 255, 0.1);
              ">
              确认
            </button>
          </div>
        </div>
      </div>

      <!-- ========================================
         【移动端底部导航栏区域】
         ======================================== -->

      <nav class="mobile-bottom-nav hidden" id="mobile-bottom-nav-single-account" style="display: none">
        <a href="#" class="mobile-nav-btn active" data-nav="control" onclick="switchMobileSinglePanel('mobile-control-panel')">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path>
          </svg>
          <span>控制</span>
        </a>

        <a href="#" class="mobile-nav-btn" data-nav="map" onclick="switchMobileSinglePanel('mobile-map-panel')">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path>
          </svg>
          <span>地图</span>
        </a>

        <a href="#" class="mobile-nav-btn" data-nav="task" onclick="switchMobileSinglePanel('mobile-task-panel')">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z"></path>
          </svg>
          <span>任务</span>
        </a>

        <a href="#" class="mobile-nav-btn" data-nav="notifications" onclick="switchMobileSinglePanel('mobile-notification-panel')">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0"></path>
          </svg>
          <span>通知</span>
        </a>

        <a href="#" class="mobile-nav-btn" data-nav="attendance" onclick="switchMobileSinglePanel('mobile-attendance-panel')">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5m-9-6h.008v.008H12v-.008zM12 15h.008v.008H12V15zm0 2.25h.008v.008H12v-.008zM9.75 15h.008v.008H9.75V15zm0 2.25h.008v.008H9.75v-.008zM7.5 15h.008v.008H7.5V15zm0 2.25h.008v.008H7.5v-.008zm6.75-4.5h.008v.008h-.008v-.008zm0 2.25h.008v.008h-.008V15zm0 2.25h.008v.008h-.008v-.008zm2.25-4.5h.008v.008H16.5v-.008zm0 2.25h.008v.008H16.5V15z"></path>
          </svg>
          <span>签到</span>
        </a>

        <a href="#" class="mobile-nav-btn" data-nav="admin" onclick="openMobileAdminPanelUnified('single')">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"></path>
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
          </svg>
          <span>管理</span>
        </a>

        <a href="#" class="mobile-nav-btn" data-nav="settings" onclick="switchMobileSinglePanel('mobile-settings-panel')">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75"></path>
          </svg>
          <span>设置</span>
        </a>

        <a href="#" class="mobile-nav-btn" data-nav="profile" onclick="toggleMobileUserDetails(true)">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"></path>
          </svg>
          <span>我的</span>
        </a>

        <a href="#" class="mobile-nav-btn" data-nav="back" onclick="mobileLogout()">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
          </svg>
          <span>返回</span>
        </a>
      </nav>

      <nav class="mobile-bottom-nav hidden" id="mobile-bottom-nav-multi-account" style="display: none">
        <a href="#" class="mobile-nav-btn active" data-nav="control" onclick="switchMobilePanel('mobile-multi-control-panel', 'multi')">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
          </svg>
          <span>控制</span>
        </a>

        <a href="#" class="mobile-nav-btn" data-nav="map" onclick="switchMobilePanel('mobile-multi-map-panel', 'multi')">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path>
          </svg>
          <span>地图</span>
        </a>

        <a href="#" class="mobile-nav-btn" data-nav="accounts" onclick="switchMobilePanel('mobile-multi-account-panel', 'multi')">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05c1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"></path>
          </svg>
          <span>账号</span>
        </a>

        <a href="#" class="mobile-nav-btn" data-nav="admin" onclick="openMobileAdminPanelUnified('multi')">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"></path>
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
          </svg>
          <span>管理</span>
        </a>

        <a href="#" class="mobile-nav-btn" data-nav="settings" onclick="switchMobilePanel('mobile-multi-settings-panel', 'multi')">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75"></path>
          </svg>
          <span>设置</span>
        </a>

        <a href="#" class="mobile-nav-btn" data-nav="back" onclick="exitMobileMultiAccount()">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
          </svg>
          <span>返回</span>
        </a>
      </nav>

      <!-- ========================================
         【移动端侧边栏导航区域】
         ======================================== -->

      <div class="mobile-sidebar-backdrop" id="mobile-sidebar-backdrop" onclick="closeMobileSidebar()"></div>

      <nav class="mobile-sidebar w-[200px] hidden" id="mobile-sidebar-single-account">
        <div class="mobile-sidebar-header">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M13.49 5.48c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm-3.6 13.9l1-4.4 2.1 2v6h2v-7.5l-2.1-2 .6-3c1.3 1.5 3.3 2.5 5.5 2.5v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1l-5.2 2.2v4.7h2v-3.4l1.8-.7-1.6 8.1-4.9-1-.4 2 7 1.4z"></path>
          </svg>
          <div class="sidebar-title">跑步助手</div>
        </div>

        <div class="mobile-sidebar-menu">
          <a href="#" class="mobile-sidebar-item" onclick="switchMobileSinglePanel('mobile-control-panel'); closeMobileSidebar(); return false;">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path>
            </svg>
            <span>控制</span>
          </a>

          <a href="#" class="mobile-sidebar-item" onclick="switchMobileSinglePanel('mobile-map-panel'); closeMobileSidebar(); return false;">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path>
            </svg>
            <span>地图</span>
          </a>

          <a href="#" class="mobile-sidebar-item" onclick="switchMobileSinglePanel('mobile-task-panel'); closeMobileSidebar(); return false;">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z"></path>
            </svg>
            <span>任务</span>
          </a>

          <a href="#" class="mobile-sidebar-item" onclick="switchMobileSinglePanel('mobile-task-details-panel'); closeMobileSidebar(); return false;" id="mobile-sidebar-task-details-link">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"></path>
            </svg>
            <span>任务详情</span>
          </a>

          <a href="#" class="mobile-sidebar-item" onclick="switchMobileSinglePanel('mobile-notification-panel'); closeMobileSidebar(); return false;">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0"></path>
            </svg>
            <span>通知</span>
          </a>

          <a href="#" class="mobile-sidebar-item" onclick="switchMobileSinglePanel('mobile-attendance-panel'); closeMobileSidebar(); return false;">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5m-9-6h.008v.008H12v-.008zM12 15h.008v.008H12V15zm0 2.25h.008v.008H12v-.008zM9.75 15h.008v.008H9.75V15zm0 2.25h.008v.008H9.75v-.008zM7.5 15h.008v.008H7.5V15zm0 2.25h.008v.008H7.5v-.008zm6.75-4.5h.008v.008h-.008v-.008zm0 2.25h.008v.008h-.008V15zm0 2.25h.008v.008h-.008v-.008zm2.25-4.5h.008v.008H16.5v-.008zm0 2.25h.008v.008H16.5V15z"></path>
            </svg>
            <span>签到</span>
          </a>

          <a href="#" class="mobile-sidebar-item" onclick="switchMobileSinglePanel('mobile-log-panel'); closeMobileSidebar(); return false;">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
            </svg>
            <span>日志</span>
          </a>

          <a href="#" class="mobile-sidebar-item" onclick="switchMobileSinglePanel('mobile-checkpoints-panel'); closeMobileSidebar(); return false;">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"></path>
              <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"></path>
            </svg>
            <span>打卡点</span>
          </a>

          <a href="#" class="mobile-sidebar-item" onclick="switchMobileSinglePanel('mobile-task-history-panel'); closeMobileSidebar(); return false;">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <span>历史记录</span>
          </a>

          <a href="#" class="mobile-sidebar-item" id="mobile-sidebar-admin-link" onclick="openMobileAdminPanelUnified('single'); closeMobileSidebar(); return false;">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"></path>
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
            <span>管理</span>
          </a>

          <a href="#" class="mobile-sidebar-item" onclick="switchMobileSinglePanel('mobile-settings-panel'); closeMobileSidebar(); return false;">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75"></path>
            </svg>
            <span>设置</span>
          </a>

          <a href="#" class="mobile-sidebar-item hidden" onclick="switchMobileSinglePanel('mobile-profile-panel'); closeMobileSidebar(); return false;">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"></path>
            </svg>
            <span>我的资料</span>
          </a>

          <a href="#" class="mobile-sidebar-item" onclick="switchMobileSinglePanel('mobile-profile-panel'); closeMobileSidebar(); return false;" id="mobile-sidebar-user-details-link">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
            <span>我的</span>
          </a>

          <a href="#" class="mobile-sidebar-item danger" onclick="closeMobileSidebar();showMobileConfirm('退出单账号模式', '确定要退出并返回会话选择吗？', async () => { await exitMobileSingleAccount(); closeMobileSidebar(); }); return false;">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
            </svg>
            <span>返回</span>
          </a>
        </div>
      </nav>

      <nav class="mobile-sidebar hidden" id="mobile-sidebar-multi-account">
        <div class="mobile-sidebar-header">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M13.49 5.48c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm-3.6 13.9l1-4.4 2.1 2v6h2v-7.5l-2.1-2 .6-3c1.3 1.5 3.3 2.5 5.5 2.5v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1l-5.2 2.2v4.7h2v-3.4l1.8-.7-1.6 8.1-4.9-1-.4 2 7 1.4z"></path>
          </svg>
          <div class="sidebar-title">跑步助手</div>
        </div>

        <div class="mobile-sidebar-menu">
          <a href="#" class="mobile-sidebar-item" onclick="switchMobilePanel('mobile-multi-control-panel', 'multi'); closeMobileSidebar(); return false;">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
            </svg>
            <span>控制</span>
          </a>

          <a href="#" class="mobile-sidebar-item" onclick="switchMobilePanel('mobile-multi-map-panel', 'multi'); closeMobileSidebar(); return false;">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path>
            </svg>
            <span>地图</span>
          </a>

          <a href="#" class="mobile-sidebar-item" onclick="switchMobilePanel('mobile-multi-account-panel', 'multi'); closeMobileSidebar(); return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05c1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"></path>
            </svg>
            <span>账号</span>
          </a>

          <a href="#" class="mobile-sidebar-item" onclick="openMobileAdminPanelUnified('multi'); closeMobileSidebar(); return false;" id="mobile_multi_admin_panel_bnt">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"></path>
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
            <span>管理</span>
          </a>

          <a href="#" class="mobile-sidebar-item" onclick="switchMobilePanel('mobile-multi-settings-panel', 'multi'); closeMobileSidebar(); return false;" id="mobile_multi_settings_panel_bnt">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75"></path>
            </svg>
            <span>设置</span>
          </a>

          <a href="#" class="mobile-sidebar-item" onclick="switchMobilePanel('mobile-multi-log-panel', 'multi'); closeMobileSidebar(); return false;" id="mobile_multi_log_panel_bnt">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
            </svg>
            <span>日志</span>
          </a>

          <a href="#" class="mobile-sidebar-item danger" onclick="closeMobileSidebar(); showMobileConfirm('退出多账号模式', '确定要退出多账号模式并返回会话选择吗？', async () => { await exitMobileMultiAccountToSessions(); closeMobileSidebar(); }); return false;">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
            </svg>
            <span>返回</span>
          </a>
        </div>
      </nav>
    </div>

    <div id="mobile-session-picker-modal" class="fixed inset-0 hidden mobile-modal" onclick="closeMobileSessionPicker()">
      <div class="mobile-modal-content bg-white rounded-t-3xl p-6 space-y-4 max-h-[85vh] overflow-y-auto" onclick="event.stopPropagation()">
        <div class="flex justify-center mb-2">
          <div class="w-12 h-1.5 bg-slate-300 rounded-full"></div>
        </div>

        <div class="flex items-center justify-between pb-3 border-b border-slate-200">
          <h3 class="text-xl font-bold text-sky-600">会话管理</h3>
          <div id="mobile-session-picker-count-display" class="text-sm text-slate-600 bg-sky-50 px-3 py-1 rounded-full"></div>
        </div>

        <div class="bg-sky-50 border border-sky-200 rounded-lg p-4">
          <p class="text-sm text-slate-700 mb-3">选择现有会话或创建新会话</p>
          <button class="mobile-primary-btn w-full" onclick="createNewSessionFromPicker()" id="mobile-create-session-picker-btn">
            <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
            </svg>
            创建新会话
          </button>
        </div>

        <div class="space-y-3">
          <div class="flex justify-between items-center">
            <h4 class="font-semibold text-slate-700">现有会话</h4>
            <button class="p-2 hover:bg-slate-100 rounded-lg transition-colors" onclick="refreshMobileSessionPicker()">
              <svg class="w-5 h-5 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
              </svg>
            </button>
          </div>

          <div id="mobile-session-picker-list" class="space-y-2">
            <p class="text-slate-400 text-center py-10">加载中...</p>
          </div>
        </div>

        <div class="border-t pt-4 text-xs text-slate-500 relative">
          <p>
            💡
            提示：每个会话都是独立的学校账号登录状态。您可以创建多个会话来管理不同的账号。
          </p>
        </div>
      </div>
    </div>

    <div id="account-params-modal" class="fixed inset-0 hidden items-center justify-center z-50">
      <div class="absolute inset-0 bg-black/40" onclick="
    const modalElem = this.parentElement;
    modalElem.classList.add('hidden'); 
    modalElem.classList.remove('flex'); 
    document.body.classList.remove('modal-visible');
  "></div>
      <div class="panel rounded-2xl p-6 w-[32rem] space-y-4 relative">
        <h3 id="account-params-title" class="text-xl font-bold text-sky-600 text-center">
          账号参数设置
        </h3>
        <div id="account-params-container" class="text-sm space-y-2 max-h-[60vh] overflow-y-auto pr-2"></div>
        <div class="flex justify-end pt-2 gap-3">
          <button class="btn btn-ghost border border-slate-300" onclick="
        const m = this.closest('#account-params-modal');
        m.classList.add('hidden'); 
        m.classList.remove('flex'); 
        document.body.classList.remove('modal-visible');
      ">
            关闭
          </button>

          <button id="save-account-params-btn" class="btn btn-primary">
            保存
          </button>
        </div>
      </div>
    </div>

    <div id="notifications-modal" class="fixed inset-0 hidden items-center justify-center z-50">
      <div class="absolute inset-0 bg-black/40" onclick="toggleNotifications(false)"></div>
      <div class="panel rounded-2xl p-6 w-[36rem] space-y-4 relative">
        <h3 class="text-xl font-bold text-sky-600 text-center">通知中心</h3>
        <div id="notifications-content" class="text-sm space-y-2 max-h-[70vh] overflow-y-auto pr-2">
          <p class="text-slate-400 text-center py-10">正在加载...</p>
        </div>
        <div class="flex justify-between items-center pt-2">
          <div class="flex gap-2">
            <button id="refresh-notifications-btn" class="btn btn-ghost !py-1 !px-3 text-sky-600">
              刷新
            </button>
            <button id="mark-all-read-btn" class="btn btn-secondary !py-1 !px-3">
              一键已读
            </button>
          </div>
          <button class="btn btn-ghost border border-slate-300" onclick="toggleNotifications(false)">
            关闭
          </button>
        </div>
      </div>
    </div>

    <div id="alert-modal" class="fixed inset-0 flex items-center justify-center hidden z-[50000]">
      <div class="absolute inset-0 bg-black/60" onclick="closeModalAlert()"></div>
      <div class="panel rounded-2xl p-6 w-11/12 md:w-96 space-y-6 relative">
        <h3 id="alert-modal-title" class="text-xl font-bold text-red-600 text-center">
          操作失败
        </h3>
        <p id="alert-modal-message" class="text-sm text-slate-600 text-center py-4">
          这是一个错误提示。
        </p>
        <div class="flex justify-center gap-3 pt-4">
          <button id="alert-modal-close-btn" class="btn btn-primary">
            关闭
          </button>
        </div>
      </div>
    </div>

    <!-- 
    ===================================================================
    管理面板模态框
    ===================================================================
  -->
    <div id="admin-panel-modal" class="fixed inset-0 hidden items-center justify-center z-50">
      <div class="absolute inset-0 bg-gradient-to-br from-black/50 to-slate-900/60 backdrop-blur-sm" onclick="toggleAdminPanel(false)"></div>

      <div class="panel rounded-3xl p-8 w-[65rem] max-h-[85vh] overflow-x-hidden space-y-5 relative flex flex-col shadow-2xl border-2 border-white/20">
        <div class="relative mb-2 text-center flex-shrink-0">
          <div class="flex items-center justify-center gap-3">
            <svg class="w-8 h-8 text-sky-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
            <h3 class="text-3xl font-bold bg-gradient-to-r from-sky-600 to-blue-600 bg-clip-text text-transparent inline-block">
              管理面板
            </h3>
          </div>

          <button id="admin-modal-close-btn" class="absolute top-1/2 right-0 transform -translate-y-1/2 btn btn-ghost !py-2 !px-4 hover:bg-red-50 hover:text-red-600 transition-all duration-200 rounded-xl" onclick="toggleAdminPanel(false)">
            <svg class="w-5 h-5 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
            关闭
          </button>
        </div>

        <div class="flex border-b-2 border-slate-200 flex-shrink-0 overflow-x-auto gap-1 pb-0">
          <button id="admin-tab-users_modal" class="px-5 py-3 font-semibold text-sky-600 border-b-3 border-sky-600 hover:bg-sky-50 transition-all duration-200 rounded-t-lg whitespace-nowrap" style="display: none">
            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
            </svg>
            用户管理
          </button>

          <button id="admin-tab-groups_modal" class="px-5 py-3 font-semibold text-slate-400 border-b-3 border-transparent hover:bg-slate-50 hover:text-slate-600 transition-all duration-200 rounded-t-lg whitespace-nowrap" style="display: none">
            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
            </svg>
            权限组
          </button>

          <button id="admin-tab-logs_modal" class="px-5 py-3 font-semibold text-slate-400 border-b-3 border-transparent hover:bg-slate-50 hover:text-slate-600 transition-all duration-200 rounded-t-lg whitespace-nowrap" style="display: none">
            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
            </svg>
            日志查看
          </button>

          <button id="admin-tab-health_modal" class="px-5 py-3 font-semibold text-slate-400 border-b-3 border-transparent hover:bg-slate-50 hover:text-slate-600 transition-all duration-200 rounded-t-lg whitespace-nowrap" style="display: none">
            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
            </svg>
            系统状态
          </button>

          <button id="admin-tab-profile_modal" class="px-5 py-3 font-semibold text-slate-400 border-b-3 border-transparent hover:bg-slate-50 hover:text-slate-600 transition-all duration-200 rounded-t-lg whitespace-nowrap">
            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
            </svg>
            个人信息
          </button>

          <button id="admin-tab-sessions_modal" class="px-5 py-3 font-semibold text-slate-400 border-b-3 border-transparent hover:bg-slate-50 hover:text-slate-600 transition-all duration-200 rounded-t-lg whitespace-nowrap">
            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            会话管理
          </button>

          <button id="admin-tab-messages_modal" class="px-5 py-3 font-semibold text-slate-400 border-b-3 border-transparent hover:bg-slate-50 hover:text-slate-600 transition-all duration-200 rounded-t-lg whitespace-nowrap">
            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path>
            </svg>
            留言板
          </button>

          <button id="admin-tab-ipban_modal" class="px-5 py-3 font-semibold text-slate-400 border-b-3 border-transparent hover:bg-slate-50 hover:text-slate-600 transition-all duration-200 rounded-t-lg whitespace-nowrap" style="display: none">
            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"></path>
            </svg>
            IP封禁
          </button>

          <button id="admin-tab-sms_modal" class="px-5 py-3 font-semibold text-slate-400 border-b-3 border-transparent hover:bg-slate-50 hover:text-slate-600 transition-all duration-200 rounded-t-lg whitespace-nowrap" style="display: none">
            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
            </svg>
            短信配置
          </button>

          <button id="admin-tab-config_modal" class="px-5 py-3 font-semibold text-slate-400 border-b-3 border-transparent hover:bg-slate-50 hover:text-slate-600 transition-all duration-200 rounded-t-lg whitespace-nowrap" style="display: none">
            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path>
            </svg>
            系统配置
          </button>

          <button id="admin-tab-captcha_modal" class="px-5 py-3 font-semibold text-slate-400 border-b-3 border-transparent hover:bg-slate-50 hover:text-slate-600 transition-all duration-200 rounded-t-lg whitespace-nowrap">
            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
            验证码管理
          </button>

          <button id="admin-tab-reminders_modal" class="px-5 py-3 font-semibold text-slate-400 border-b-3 border-transparent hover:bg-slate-50 hover:text-slate-600 transition-all duration-200 rounded-t-lg whitespace-nowrap" style="display: none">
            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            定时提醒
          </button>

          <button id="admin-tab-ssl_modal" class="px-5 py-3 font-semibold text-slate-400 border-b-3 border-transparent hover:bg-slate-50 hover:text-slate-600 transition-all duration-200 rounded-t-lg whitespace-nowrap" style="display: none">
            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
            </svg>
            HTTPS设置
          </button>
        </div>

        <div class="overflow-x-hidden flex-grow min-h-0">
          <div id="admin-users-panel_modal" class="space-y-4">
            <div class="flex justify-between items-center">
              <h4 class="font-semibold">用户列表</h4>
              <div class="flex gap-2">
                <button id="admin-view-school-accounts_modal" class="btn btn-secondary !py-1 !px-2" style="display: none">
                  查看 School Accounts
                </button>
                <button id="admin-create-user_modal" class="btn btn-primary !py-1 !px-2">
                  新增用户
                </button>
                <button id="admin-refresh-users_modal" class="btn btn-ghost !py-1 !px-2">
                  刷新
                </button>
              </div>
            </div>
            <div id="admin-users-list_modal" class="space-y-2 max-h-[50vh] overflow-y-auto -mr-2 pr-2">
              <p class="text-slate-400 text-center py-10">加载中...</p>
            </div>
          </div>

          <div id="admin-groups-panel_modal" class="hidden space-y-4">
            <div class="flex justify-between items-center">
              <h4 class="font-semibold">权限组列表</h4>
              <div class="flex gap-2">
                <button id="admin-create-group_modal" class="btn btn-primary !py-1 !px-2">
                  新增权限组
                </button>
                <button id="admin-refresh-groups_modal" class="btn btn-ghost !py-1 !px-2">
                  刷新
                </button>
              </div>
            </div>
            <div id="admin-groups-list_modal" class="space-y-2 max-h-[50vh] overflow-y-auto -mr-2 pr-2">
              <p class="text-slate-400 text-center py-10">加载中...</p>
            </div>
          </div>

          <div id="admin-logs-panel_modal" class="hidden space-y-4">
            <div class="flex justify-between items-center">
              <h4 class="font-semibold">系统日志</h4>
              <div class="flex gap-2">
                <select id="log-limit-select_modal" class="text-sm border border-slate-300 rounded px-2 py-1">
                  <option value="100">每页100行</option>
                  <option value="200">每页200行</option>
                  <option value="500">每页500行</option>
                  <option value="1000">每页1000行</option>
                </select>
                <button id="admin-refresh-logs_modal" class="btn btn-ghost !py-1 !px-2">
                  刷新
                </button>
              </div>
            </div>
            <div class="bg-slate-900 text-green-400 rounded-lg p-4 font-mono text-xs overflow-auto max-h-[47vh]">
              <pre id="admin-logs-content_modal" class="whitespace-pre-wrap overflow-visible">加载中...</pre>
            </div>
            <div id="admin-logs-pagination" class="flex justify-between items-center text-sm text-slate-600 pt-2 border-t border-slate-200">
              <button id="log-prev-page" class="btn btn-ghost !py-1 !px-3 disabled:opacity-50 disabled:cursor-not-allowed">
                上一页
              </button>

              <div class="flex items-center gap-2">
                <select id="log-page-select" class="text-sm border border-slate-300 rounded px-2 py-1 bg-white focus:border-sky-500 focus:ring-1 focus:ring-sky-500 focus:outline-none cursor-pointer">
                  <option value="1">第 1 / 1 页</option>
                </select>
                <span id="log-page-total" class="text-sm text-slate-500 whitespace-nowrap">(共 0 行)</span>
              </div>

              <button id="log-next-page" class="btn btn-ghost !py-1 !px-3 disabled:opacity-50 disabled:cursor-not-allowed">
                下一页
              </button>
            </div>
          </div>

          <div id="admin-sessions-panel_modal" class="hidden space-y-4">
            <div class="flex justify-between items-center">
              <h4 class="font-semibold">会话列表</h4>
              <div class="flex items-center gap-3">
                <label id="god-mode-toggle_modal" class="flex items-center gap-2 cursor-pointer" style="display: none">
                  <input type="checkbox" id="god-mode-checkbox_modal" class="w-4 h-4 accent-red-600 rounded cursor-pointer">
                  <span class="text-sm font-semibold text-red-600">查看所有会话</span>
                </label>
                <div id="admin-session-count-display" class="text-sm text-slate-600"></div>
                <button id="admin-refresh-sessions_modal" class="btn btn-ghost !py-1 !px-2">
                  刷新
                </button>
              </div>
            </div>
            <div id="admin-sessions-list_modal" class="space-y-2 max-h-[50vh] overflow-y-auto">
              <p class="text-slate-400 text-center py-10">加载中...</p>
            </div>
          </div>

          <div id="admin-health-panel_modal" class="hidden space-y-4">
            <div class="flex justify-between items-center">
              <h4 class="font-semibold">系统健康状态</h4>
              <div class="flex items-center gap-2">
                <label class="flex items-center gap-2 cursor-pointer">
                  <input type="checkbox" id="health-auto-refresh-toggle" class="w-4 h-4 accent-sky-600 rounded cursor-pointer" checked="">
                  <span class="text-sm text-slate-600">
                    自动刷新(5秒)
                    <span id="health-countdown-display" class="font-semibold text-sky-600"></span>
                  </span>
                </label>
                <button id="admin-refresh-health_modal" class="btn btn-ghost !py-1 !px-2">
                  手动刷新
                </button>
              </div>
            </div>
            <div id="admin-health-content_modal" class="space-y-4">
              <p class="text-slate-400 text-center py-10">加载中...</p>
            </div>
          </div>

          <div id="admin-profile-panel_modal" class="hidden space-y-4">
            <div class="flex justify-between items-center">
              <h4 class="font-semibold">个人信息</h4>
              <button id="admin-refresh-profile_modal" class="btn btn-ghost !py-1 !px-2">
                刷新
              </button>
            </div>

            <div id="admin-profile-content_modal" class="space-y-6 text-slate-800">
              <div class="bg-slate-50 border border-slate-200 rounded-lg p-4 space-y-3">
                <h5 class="font-semibold text-slate-700 mb-2">头像</h5>
                <div class="flex items-center gap-4">
                  <img id="profile-avatar-display" src="" alt="用户头像" class="w-20 h-20 rounded-full border-2 border-slate-200" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22100%22 height=%22100%22%3E%3Crect width=%22100%22 height=%22100%22 fill=%22%23ddd%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 font-size=%2240%22 text-anchor=%22middle%22 dy=%22.3em%22%3E👤%3C/text%3E%3C/svg%3E'">
                  <div class="flex-1 space-y-2">
                    <input type="file" id="profile-avatar-file" accept="image/*" class="hidden" onchange="previewAvatar(event)">

                    <button class="btn btn-ghost border border-slate-300 !py-1.5 !px-3 text-sm" onclick="document.getElementById('profile-avatar-file').click();">
                      <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path>
                      </svg>
                      上传头像
                    </button>
                  </div>
                </div>
              </div>

              <div class="bg-slate-50 border border-slate-200 rounded-lg p-4 space-y-3">
                <h5 class="font-semibold text-slate-700 mb-3">基本信息</h5>
                <div class="space-y-3">
                  <div>
                    <label class="block text-sm font-semibold text-slate-700 mb-1">昵称</label>
                    <input type="text" id="profile-nickname" class="input-field" placeholder="输入昵称">
                  </div>
                  <div>
                    <label class="block text-sm font-semibold text-slate-700 mb-1">手机号</label>
                    <div class="flex gap-2">
                      <div class="phone-input-wrapper flex-1">
                        <span class="phone-prefix">+86 </span>
                        <input type="tel" id="profile-phone" class="input-field" placeholder="未绑定" readonly="" inputmode="numeric">
                      </div>
                      <button onclick="modifyPhone()" id="profile-modify-phone-btn" class="btn btn-ghost border border-slate-300 !py-1.5 !px-3 text-sm whitespace-nowrap">
                        修改手机号
                      </button>
                    </div>
                    <p class="text-xs text-slate-500 mt-1" id="profile-phone-hint">
                      💡 修改手机号需要短信验证
                    </p>
                  </div>
                  <div class="flex justify-end">
                    <button onclick="updateBasicInfo()" class="btn btn-primary">
                      保存基本信息
                    </button>
                  </div>
                </div>
              </div>

              <div class="bg-slate-50 border border-slate-200 rounded-lg p-4 space-y-3">
                <h5 class="font-semibold text-slate-700 mb-3">修改密码</h5>
                <div class="space-y-3">
                  <!-- 当前密码输入区域（密码验证模式） -->
                  <div id="pc-password-verify-section">
                    <label class="block text-sm font-semibold text-slate-700 mb-1">当前密码</label>
                    <input type="password" id="profile-current-password" class="input-field" placeholder="输入当前密码">
                    <!-- 提示用户可以使用短信验证 -->
                    <p class="text-xs text-slate-500 mt-1">
                      忘记原密码？<button type="button" onclick="toggleSmsVerifyMode('pc')" class="text-sky-600 hover:underline" id="pc-sms-toggle-btn">
                        使用短信验证
                      </button>
                    </p>
                  </div>
                  <!-- 短信验证模式区域（默认隐藏） -->
                  <div id="pc-sms-verify-section" class="hidden space-y-2 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                    <p class="text-xs text-blue-700">
                      📱 短信验证模式：验证码将发送到您绑定的手机号
                    </p>
                    <div>
                      <label class="block text-sm font-semibold text-slate-700 mb-1">短信验证码</label>
                      <div class="flex gap-2">
                        <input type="text" id="pc-password-sms-code" class="input-field flex-1" placeholder="请输入验证码" maxlength="6" inputmode="numeric">
                        <button type="button" onclick="sendPasswordResetSmsCode('pc')" id="pc-send-sms-btn" class="btn btn-primary whitespace-nowrap">
                          发送验证码
                        </button>
                      </div>
                    </div>
                    <button type="button" onclick="toggleSmsVerifyMode('pc')" class="text-xs text-slate-500 hover:underline">
                      ← 返回密码验证
                    </button>
                  </div>
                  <div>
                    <label class="block text-sm font-semibold text-slate-700 mb-1">新密码</label>
                    <input type="password" id="profile-new-password" class="input-field" placeholder="输入新密码">
                  </div>
                  <div>
                    <label class="block text-sm font-semibold text-slate-700 mb-1">确认新密码</label>
                    <input type="password" id="profile-confirm-password" class="input-field" placeholder="再次输入新密码">
                  </div>
                  <div class="flex justify-end">
                    <button onclick="updatePassword()" class="btn btn-primary">
                      修改密码
                    </button>
                  </div>
                </div>
              </div>

              <div class="bg-slate-50 border border-slate-200 rounded-lg p-4 space-y-3">
                <h5 class="font-semibold text-slate-700 mb-3">
                  双因素认证(2FA)
                </h5>
                <div id="profile-2fa-status" class="mb-3">
                  <p class="text-sm text-slate-600">
                    状态: <span id="profile-2fa-enabled">检测中...</span>
                  </p>
                </div>
                <div id="profile-2fa-setup" class="space-y-3 hidden">
                  <div class="bg-slate-100 border border-slate-200 rounded-lg p-4 text-center">
                    <canvas id="profile-2fa-qr" class="mx-auto"></canvas>
                    <p class="text-xs text-slate-600 mt-2">
                      密钥:
                      <span id="profile-2fa-secret" class="font-mono"></span>
                    </p>
                    <p class="text-xs text-slate-600 mt-1">
                      请使用Google Authenticator或类似应用扫描此二维码
                    </p>
                  </div>
                  <div>
                    <label class="block text-sm font-semibold text-slate-700 mb-1">验证码</label>
                    <input type="text" id="profile-2fa-code" class="input-field" placeholder="输入6位验证码" maxlength="6">
                  </div>
                  <div class="flex justify-end">
                    <button onclick="enable2FA()" class="btn btn-primary">
                      启用2FA
                    </button>
                  </div>
                </div>
                <div id="profile-2fa-actions" class="space-y-2 flex justify-end">
                  <button onclick="generate2FA()" class="btn btn-primary">
                    生成2FA密钥
                  </button>
                </div>
                <div id="profile-2fa-enabled-actions" class="space-y-2 hidden flex justify-end gap-2">
                  <button onclick="test2FA()" class="btn btn-ghost">
                    测试2FA
                  </button>
                  <button onclick="disable2FA()" class="btn btn-warning">
                    关闭2FA
                  </button>
                </div>
              </div>

              <div class="bg-slate-50 border border-slate-200 rounded-lg p-4 space-y-3">
                <h5 class="font-semibold text-slate-700 mb-3">主题设置</h5>

                <div class="space-y-2">
                  <label class="block text-sm font-semibold text-slate-700">主题风格</label>
                  <select id="profile-theme-select" onchange="updateTheme()" class="select-field">
                    <option value="light">浅色主题</option>
                    <option value="dark">深色主题</option>
                  </select>
                </div>

                <div class="space-y-2">
                  <label class="block text-sm font-semibold text-slate-700">主题样式</label>
                  <div class="grid grid-cols-3 gap-2">
                    <button onclick="setThemeStyle('default')" class="btn btn-ghost !py-2 text-sm border border-slate-300 hover:border-sky-500">
                      默认
                    </button>
                    <button onclick="setThemeStyle('theme-anime')" class="btn btn-ghost !py-2 text-sm border border-slate-300 hover:border-sky-500">
                      二次元
                    </button>
                    <button onclick="setThemeStyle('theme-minimalist')" class="btn btn-ghost !py-2 text-sm border border-slate-300 hover:border-sky-500">
                      简约
                    </button>
                  </div>
                </div>

                <div class="space-y-2">
                  <label class="block text-sm font-semibold text-slate-700">主题基础颜色</label>
                  <div class="flex gap-2 items-center">
                    <input type="color" id="profile-theme_base_color-picker" value="#7dd3fc" class="w-12 h-10 border border-slate-300 rounded cursor-pointer" onchange="document.getElementById('profile-theme_base_color').value = this.value; onColorPicked(this.value); callPythonAPI('update_param', 'theme_base_color', this.value);" title="点击选择颜色">

                    <input type="text" id="profile-theme_base_color" value="#7dd3fc" class="input-field flex-1 font-mono text-sm" placeholder="#7dd3fc" onchange="if(/^#[0-9A-Fa-f]{6}$/i.test(this.value)){ document.getElementById('profile-theme_base_color-picker').value = this.value; onColorPicked(this.value); callPythonAPI('update_param', 'theme_base_color', this.value); }" pattern="^#[0-9A-Fa-f]{6}$" title="输入16进制颜色值，如 #7dd3fc">

                    <button onclick="resetBaseColorToDefault('profile')" class="btn btn-ghost border border-slate-300 !py-2 !px-3 text-sm whitespace-nowrap hover:bg-slate-100" title="恢复为默认颜色 #7dd3fc">
                      恢复默认
                    </button>
                  </div>
                  <p class="text-xs text-slate-500">
                    💡 自定义主题的主要色调，影响按钮、边框等元素颜色
                  </p>
                </div>
              </div>
            </div>
          </div>

          <div id="admin-messages-panel_modal" class="hidden space-y-4">
            <div class="flex justify-between items-center">
              <h4 class="font-semibold">留言板</h4>
              <button id="admin-refresh-messages_modal" class="btn btn-ghost !py-1 !px-2">
                刷新
              </button>
            </div>

            <div class="bg-slate-50 border border-slate-200 rounded-lg p-4 space-y-3">
              <h5 class="font-semibold text-slate-700">发表留言</h5>
              <div id="message-guest-fields" class="space-y-2 hidden">
                <div>
                  <label class="block text-sm font-semibold text-slate-700 mb-1">昵称 <span class="text-red-500">*</span></label>
                  <input type="text" id="message-nickname" class="input-field" placeholder="请输入您的昵称" maxlength="50">
                </div>
                <div>
                  <label class="block text-sm font-semibold text-slate-700 mb-1">邮箱 <span class="text-red-500">*</span></label>
                  <input type="email" id="message-email" class="input-field" placeholder="请输入您的邮箱">
                </div>
              </div>
              <div>
                <label class="block text-sm font-semibold text-slate-700 mb-1">留言内容 <span class="text-red-500">*</span></label>
                <textarea id="message-content" class="input-field" rows="4" placeholder="请输入留言内容（最多1000字）" maxlength="1000"></textarea>
                <div class="text-xs text-slate-500 mt-1 text-right">
                  <span id="message-char-count">0</span> / 1000
                </div>
              </div>
              <button id="post-message-btn" onclick="postMessage()" class="btn btn-primary w-full">
                发表留言
              </button>
            </div>

            <div id="admin-messages-list_modal" class="space-y-3 max-h-[19vh] overflow-y-auto">
              <p class="text-slate-400 text-center py-10">加载中...</p>
            </div>
          </div>

          <!-- ============================================================ -->
          <!-- 用户日志查看l -->
          <!-- ============================================================ -->
          <div id="admin-user-logs-modal" class="hidden space-y-4">
            <h4 class="font-semibold">用户日志查看</h4>

            <div class="bg-sky-50 border border-sky-200 rounded-lg p-3">
              <p class="text-sm text-slate-700">
                当前查看用户:
                <span id="current-log-username" class="font-semibold text-sky-600">N/A</span>
              </p>
            </div>

            <div class="flex border-b border-slate-200">
              <button id="log-tab-login" class="px-4 py-2 font-semibold text-sky-600 border-b-2 border-sky-600">
                登录记录
              </button>
              <button id="log-tab-audit" class="px-4 py-2 font-semibold text-slate-400 border-b-2 border-transparent">
                操作记录
              </button>
            </div>

            <div id="log-login-content" class="space-y-2 max-h-[50vh] overflow-y-auto">
              <p class="text-slate-400 text-center py-10">加载中...</p>
            </div>

            <div id="log-audit-content" class="hidden space-y-2 max-h-[50vh] overflow-y-auto">
              <p class="text-slate-400 text-center py-10">加载中...</p>
            </div>

            <div class="flex justify-end">
              <button onclick="closeUserLogsModal()" class="btn btn-ghost">
                返回
              </button>
            </div>
          </div>

          <!-- ============================================================ -->
          <!-- IP封禁管理 -->
          <!-- ============================================================ -->
          <div id="admin-ip-ban-modal" class="hidden space-y-4">
            <div class="flex justify-between items-center">
              <h4 class="font-semibold text-lg">🚫 IP封禁管理</h4>
              <button id="admin-refresh-ipban_modal" class="btn btn-ghost !py-1 !px-2" onclick="loadIPBans()">
                刷新
              </button>
            </div>

            <div class="bg-gradient-to-br from-slate-50 to-gray-50 border-2 border-slate-200 rounded-lg p-4 shadow-sm">
              <h5 class="font-bold text-base text-slate-800 mb-3">
                📜 现有封禁规则
              </h5>
              <div id="ip-ban-list" class="space-y-2 max-h-[35vh] overflow-y-auto -mr-2 pr-2">
                <p class="text-slate-400 text-center py-10">加载中...</p>
              </div>
            </div>

            <div class="bg-gradient-to-br from-blue-50 to-cyan-50 border-2 border-blue-200 rounded-lg p-4 shadow-sm">
              <h5 class="font-bold text-base text-blue-900 mb-3">
                ➕ 添加封禁规则
              </h5>
              <div class="space-y-3">
                <div>
                  <label class="block text-sm font-medium text-slate-700 mb-1">🏷️ 封禁类型</label>
                  <select id="ban-type" class="select-field">
                    <option value="ip">单个IP</option>
                    <option value="range">IP范围(Range)</option>
                  </select>
                  <p class="mt-1 text-xs text-slate-500">
                    - <strong>单个IP</strong>: 封禁一个特定的IP地址 (例如:
                    1.2.3.4)<br>
                    - <strong>IP范围(Range)</strong>: 封禁一个IP地址范围 (例如:
                    192.168.1.1-192.168.1.100)
                  </p>
                </div>

                <div>
                  <label class="block text-sm font-medium text-slate-700 mb-1">🎯 封禁目标</label>
                  <input type="text" id="ban-target" class="input-field" placeholder="请输入IP地址 (例如: 1.2.3.4)">
                  <p id="ban-target-hint" class="mt-1 text-xs text-slate-500">
                    示例: 1.2.3.4
                  </p>
                  <p id="ban-target-error" class="hidden mt-1 text-xs text-red-600 font-semibold"></p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-3 items-end pt-2 border-t border-blue-100">
                  <div class="md:col-span-2">
                    <label class="block text-sm font-medium text-slate-700 mb-1">🔒 封禁范围</label>
                    <select id="ban-scope" class="select-field">
                      <option value="all">封禁所有功能</option>
                      <option value="messages_only">仅封禁留言板</option>
                    </select>
                  </div>
                  <button onclick="addIPBan()" class="btn btn-primary w-full min-h-[44px]">
                    添加封禁
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- ============短信服务配置============ -->
          <div id="admin-sms-config-modal" class="hidden space-y-4">
            <div class="flex justify-between items-center">
              <h4 class="font-semibold text-lg">📱 短信服务配置</h4>
              <button id="admin-refresh-sms_modal" class="btn btn-ghost !py-1 !px-2" onclick="loadSMSConfig()">
                刷新
              </button>
            </div>

            <div class="space-y-4">
              <!-- ========== 功能开关卡片 ========== -->
              <div class="bg-gradient-to-br from-purple-50 to-pink-50 border-2 border-purple-200 rounded-lg p-4 shadow-sm">
                <div class="flex items-center gap-2 mb-3">
                  <span class="text-2xl">🔌</span>
                  <h5 class="font-bold text-base text-purple-900">功能开关</h5>
                </div>

                <label class="flex items-center gap-3 p-3 bg-white rounded-lg border border-purple-100 shadow-sm hover:shadow-md transition-shadow cursor-pointer">
                  <input type="checkbox" id="sms-enabled" class="w-5 h-5 text-purple-600 rounded focus:ring-purple-500" onchange="handleSmsMainSwitchChange()">
                  <div class="flex-1">
                    <span class="font-semibold text-slate-800 block">启用短信服务</span>
                    <span class="text-xs text-slate-500">关闭此开关将禁用所有短信功能</span>
                  </div>
                </label>

                <div class="ml-8 mt-3 space-y-2 border-l-2 border-purple-200 pl-4">
                  <label class="flex items-center gap-2 cursor-pointer group">
                    <input type="checkbox" id="sms-enable-phone-modification" class="w-4 h-4 text-purple-600 rounded focus:ring-purple-500">
                    <div class="flex-1">
                      <span class="text-sm text-slate-700 group-hover:text-slate-900">允许用户修改手机号</span>
                      <span class="text-xs text-slate-400 block">用户可在个人资料中修改绑定的手机号</span>
                    </div>
                  </label>

                  <label class="flex items-center gap-2 cursor-pointer group">
                    <input type="checkbox" id="sms-enable-phone-login" class="w-4 h-4 text-purple-600 rounded focus:ring-purple-500">
                    <div class="flex-1">
                      <span class="text-sm text-slate-700 group-hover:text-slate-900">允许手机号登录</span>
                      <span class="text-xs text-slate-400 block">用户可使用手机号+密码进行登录</span>
                    </div>
                  </label>

                  <label class="flex items-center gap-2 cursor-pointer group">
                    <input type="checkbox" id="sms-enable-phone-registration-verify" class="w-4 h-4 text-purple-600 rounded focus:ring-purple-500">
                    <div class="flex-1">
                      <span class="text-sm text-slate-700 group-hover:text-slate-900">注册时需要短信验证</span>
                      <span class="text-xs text-slate-400 block">用户注册时必须填写手机号并验证</span>
                    </div>
                  </label>
                </div>
              </div>

              <!-- ==========短信宝配置卡片 ========== -->
              <div class="bg-gradient-to-br from-blue-50 to-cyan-50 border-2 border-blue-200 rounded-lg p-4 shadow-sm">
                <div class="flex items-center gap-2 mb-3">
                  <span class="text-2xl">📧</span>
                  <h5 class="font-bold text-base text-blue-900">短信宝配置</h5>
                </div>

                <div class="space-y-3">
                  <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">
                      <span class="inline-flex items-center gap-1">
                        👤 用户名
                      </span>
                    </label>
                    <input type="text" id="sms-username" class="w-full border-2 border-blue-200 rounded-lg px-3 py-2 focus:border-blue-400 focus:ring-2 focus:ring-blue-200 transition-all" placeholder="请输入短信宝用户名">
                    <p class="text-xs text-slate-500 mt-1">
                      在短信宝官网注册后获取
                    </p>
                  </div>

                  <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">
                      <span class="inline-flex items-center gap-1">
                        🔑 API Key
                      </span>
                    </label>
                    <input type="password" id="sms-apikey" class="w-full border-2 border-blue-200 rounded-lg px-3 py-2 focus:border-blue-400 focus:ring-2 focus:ring-blue-200 transition-all" placeholder="请输入短信宝 API Key">
                    <p class="text-xs text-slate-500 mt-1">
                      在短信宝后台的"API接口"页面获取
                    </p>
                  </div>

                  <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">
                      <span class="inline-flex items-center gap-1">
                        ✍️ 短信签名
                      </span>
                    </label>
                    <input type="text" id="sms-signature" class="w-full border-2 border-blue-200 rounded-lg px-3 py-2 focus:border-blue-400 focus:ring-2 focus:ring-blue-200 transition-all" placeholder="【您的签名】" maxlength="12">
                    <p class="text-xs text-slate-500 mt-1">
                      签名长度3-12字，需在短信宝后台审核通过
                    </p>
                  </div>

                  <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">
                      <span class="inline-flex items-center gap-1">
                        📝 短信模板
                      </span>
                    </label>
                    <textarea id="sms-template" class="w-full border-2 border-blue-200 rounded-lg px-3 py-2 focus:border-blue-400 focus:ring-2 focus:ring-blue-200 transition-all" rows="3" placeholder="您的验证码是：{code}，{minutes}分钟内有效。"></textarea>
                    <p class="text-xs text-slate-500 mt-1">
                      使用 {code} 表示验证码，{minutes} 表示有效期分钟数
                    </p>
                  </div>

                  <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">
                      <span class="inline-flex items-center gap-1">
                        ⏱️ 验证码有效期
                      </span>
                    </label>
                    <div class="flex items-center gap-2">
                      <input type="number" id="sms-code-expire" class="flex-1 border-2 border-blue-200 rounded-lg px-3 py-2 focus:border-blue-400 focus:ring-2 focus:ring-blue-200 transition-all" placeholder="5" min="1" max="60">
                      <span class="text-sm text-slate-600">分钟</span>
                    </div>
                    <p class="text-xs text-slate-500 mt-1">
                      建议设置为5-10分钟，过长不安全，过短体验差
                    </p>
                  </div>
                </div>
              </div>

              <!-- ==========速率限制卡片 ========== -->
              <div class="bg-gradient-to-br from-orange-50 to-amber-50 border-2 border-orange-200 rounded-lg p-4 shadow-sm">
                <div class="flex items-center gap-2 mb-3">
                  <span class="text-2xl">⚡</span>
                  <h5 class="font-bold text-base text-orange-900">速率限制</h5>
                </div>
                <p class="text-xs text-slate-600 mb-3">
                  防止滥用和恶意攻击，保护系统安全
                </p>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                  <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">
                      <span class="inline-flex items-center gap-1">
                        👤 账户限制
                      </span>
                    </label>
                    <div class="flex items-center gap-1">
                      <input type="number" id="sms-limit-account" class="w-full border-2 border-orange-200 rounded-lg px-3 py-2 focus:border-orange-400 focus:ring-2 focus:ring-orange-200 transition-all" placeholder="10" min="1">
                      <span class="text-sm text-slate-600 whitespace-nowrap">条/天</span>
                    </div>
                    <p class="text-xs text-slate-500 mt-1">单个账号每天最多</p>
                  </div>

                  <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">
                      <span class="inline-flex items-center gap-1">
                        🌐 IP限制
                      </span>
                    </label>
                    <div class="flex items-center gap-1">
                      <input type="number" id="sms-limit-ip" class="w-full border-2 border-orange-200 rounded-lg px-3 py-2 focus:border-orange-400 focus:ring-2 focus:ring-orange-200 transition-all" placeholder="20" min="1">
                      <span class="text-sm text-slate-600 whitespace-nowrap">条/天</span>
                    </div>
                    <p class="text-xs text-slate-500 mt-1">单个IP每天最多</p>
                  </div>

                  <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">
                      <span class="inline-flex items-center gap-1">
                        📱 手机号限制
                      </span>
                    </label>
                    <div class="flex items-center gap-1">
                      <input type="number" id="sms-limit-phone" class="w-full border-2 border-orange-200 rounded-lg px-3 py-2 focus:border-orange-400 focus:ring-2 focus:ring-orange-200 transition-all" placeholder="5" min="1">
                      <span class="text-sm text-slate-600 whitespace-nowrap">条/天</span>
                    </div>
                    <p class="text-xs text-slate-500 mt-1">
                      单个手机号每天最多
                    </p>
                  </div>
                </div>
              </div>

              <!-- ========== Webhook配置卡片 ========== -->
              <div class="bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-lg p-4 shadow-sm">
                <div class="flex items-center gap-2 mb-3">
                  <span class="text-2xl">🔗</span>
                  <h5 class="font-bold text-base text-green-900">
                    Webhook 回调地址
                  </h5>
                </div>

                <div>
                  <label class="block text-sm font-medium text-slate-700 mb-1">回调地址</label>
                  <input type="text" id="sms-webhook-url" class="w-full border-2 border-green-200 rounded-lg px-3 py-2 bg-green-50 text-slate-700 font-mono text-sm" readonly="">
                  <p class="text-xs text-slate-600 mt-2 flex items-start gap-1">
                    <span>💡</span>
                    <span>将此URL配置到短信宝后台的"短信回复"功能中，即可接收用户回复的短信</span>
                  </p>
                </div>
              </div>

              <!-- ==========操作区卡片========== -->
              <div class="bg-gradient-to-br from-slate-50 to-gray-50 border-2 border-slate-200 rounded-lg p-4 shadow-sm">
                <div class="flex flex-col sm:flex-row gap-3">
                  <button id="btn-check-sms-balance" onclick="checkSMSBalance()" class="flex-1 btn btn-ghost min-h-[44px] border-2 border-slate-300 hover:border-slate-400 hover:bg-slate-100 transition-all">
                    💰 查询余额
                  </button>
                  <button onclick="saveSMSConfig()" class="flex-1 btn btn-primary min-h-[44px] shadow-md hover:shadow-lg transition-all">
                    💾 保存配置
                  </button>
                </div>

                <div class="flex flex-col sm:flex-row gap-3 mt-3 pt-3 border-t-2 border-slate-200">
                  <button onclick="openSMSHistoryModal()" class="flex-1 btn btn-ghost min-h-[44px] border-2 border-slate-300 hover:border-slate-400 hover:bg-slate-100 transition-all">
                    📋 短信发送历史
                  </button>
                  <button onclick="openVerificationCodesModal()" class="flex-1 btn btn-ghost min-h-[44px] border-2 border-slate-300 hover:border-slate-400 hover:bg-slate-100 transition-all">
                    🔑 验证码管理
                  </button>
                  <button onclick="openSMSTestModal()" class="flex-1 btn btn-ghost min-h-[44px] border-2 border-green-300 hover:border-green-400 hover:bg-green-50 transition-all">
                    🧪 测试发送
                  </button>
                </div>

                <div id="sms-balance-display" class="hidden mt-3 border-2 border-blue-300 bg-blue-50 rounded-lg p-3">
                  <div class="flex items-center justify-between">
                    <div class="flex items-center gap-2">
                      <span class="text-2xl">💵</span>
                      <span class="font-medium text-slate-700">当前余额</span>
                    </div>
                    <div class="flex items-center gap-1">
                      <span id="sms-balance-value" class="text-2xl font-bold text-blue-600">--</span>
                      <span class="text-sm text-slate-600">条</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div id="admin-config-panel_modal" class="hidden space-y-4">
            <div class="flex justify-between items-center">
              <h4 class="font-semibold text-lg">⚙️ 系统配置</h4>
              <div class="flex gap-2">
                <button id="admin-refresh-config_modal" class="btn btn-ghost !py-1 !px-2" onclick="loadSystemConfig()">
                  刷新
                </button>
                <button id="admin-save-config_modal" class="btn btn-primary !py-1 !px-2" onclick="saveSystemConfig()">
                  保存配置
                </button>
              </div>
            </div>
            <p class="text-xs text-amber-700 bg-amber-50 p-2 rounded-md">
              ⚠️
              警告：修改这些配置可能会影响系统稳定性。保存后，部分配置需要**重启程序**才能生效。
            </p>

            <div id="admin-config-form" class="space-y-4 max-h-[50vh] overflow-y-auto pr-2">
              <p class="text-slate-400 text-center py-10">加载中...</p>
            </div>
          </div>

          <div id="admin-captcha-panel_modal" class="hidden space-y-4">
            <div class="flex justify-between items-center">
              <h4 class="font-semibold text-lg">⚙️ 验证码生成设置</h4>
            </div>

            <div class="bg-sky-50 border border-sky-200 rounded-lg p-4 mb-4" style="display: none">
              <p class="text-sm text-slate-600 mb-2">
                <strong>本地验证码生成器</strong>：使用MicroPixelCaptcha生成黑白像素风格验证码，无需第三方API，更稳定、更安全、响应更快。
              </p>
              <p class="text-xs text-slate-500">
                💡
                提示：修改参数后需刷新验证码才能看到效果。建议scale_factor使用2或3，noise_level保持在0.05-0.15之间。
              </p>
            </div>

            <div class="space-y-4">
              <div class="flex items-center gap-4">
                <label for="captcha-length" class="text-sm font-medium text-slate-700 w-32">
                  验证码长度：
                </label>
                <input type="number" id="captcha-length" min="3" max="6" step="1" value="4" class="px-3 py-2 border border-slate-300 rounded-md text-sm w-24 focus:ring-2 focus:ring-sky-500 focus:border-sky-500">
                <span class="text-xs text-slate-500">字符数（3-6），推荐4</span>
              </div>

              <div class="flex items-center gap-4">
                <label for="captcha-scale-factor" class="text-sm font-medium text-slate-700 w-32">
                  细分倍数：
                </label>
                <input type="number" id="captcha-scale-factor" min="2" max="4" step="1" value="2" class="px-3 py-2 border border-slate-300 rounded-md text-sm w-24 focus:ring-2 focus:ring-sky-500 focus:border-sky-500">
                <span class="text-xs text-slate-500">像素细分（2-4），推荐2或3</span>
              </div>

              <div class="flex items-center gap-4">
                <label for="captcha-noise-level" class="text-sm font-medium text-slate-700 w-32">
                  噪点比例：
                </label>
                <input type="number" id="captcha-noise-level" min="0" max="0.3" step="0.01" value="0.08" class="px-3 py-2 border border-slate-300 rounded-md text-sm w-24 focus:ring-2 focus:ring-sky-500 focus:border-sky-500">
                <span class="text-xs text-slate-500">噪点密度（0.0-0.3），推荐0.05-0.15</span>
              </div>

              <div class="flex gap-2 mt-6">
                <button id="save-captcha-settings-btn" class="px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 text-sm font-medium transition-colors duration-200 shadow-sm">
                  💾 保存设置
                </button>
                <button id="test-captcha-btn" class="px-4 py-2 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 text-sm font-medium transition-colors duration-200">
                  🔄 测试生成
                </button>
                <button id="view-captcha-history-btn" class="px-4 py-2 bg-purple-50 text-purple-700 border border-purple-200 rounded-md hover:bg-purple-100 text-sm font-medium transition-colors duration-200 ml-auto">
                  📜 查看历史
                </button>
              </div>

              <div id="captcha-test-preview" class="hidden mt-4 p-4 border border-slate-300 rounded-lg bg-white">
                <p class="text-sm font-medium text-slate-700 mb-2">
                  预览效果：
                </p>
                <div id="captcha-preview-display" class="flex justify-center my-3"></div>
                <p class="text-xs text-slate-500 mt-2">
                  验证码答案：
                  <span id="captcha-preview-answer" class="font-mono font-bold text-slate-900"></span>
                </p>
              </div>
            </div>

            <div class="mt-6 p-4 bg-slate-50 border border-slate-200 rounded-lg">
              <p class="text-sm text-slate-600 font-medium mb-2">
                📖 参数说明：
              </p>
              <ul class="text-xs text-slate-600 space-y-1 list-disc list-inside">
                <li>
                  <strong>验证码长度</strong>：生成的验证码字符数，推荐4个字符（平衡安全性和用户体验）
                </li>
                <li>
                  <strong>细分倍数</strong>：控制像素密度，值越大验证码越精细，但文件也越大。推荐2或3
                </li>
                <li>
                  <strong>噪点比例</strong>：添加随机噪点的比例，增加机器识别难度。0.08表示8%的像素会反转颜色
                </li>
              </ul>
              <p class="text-xs text-slate-500 mt-3">
                ⚠️
                注意：如果验证码太难识别，请降低noise_level或length；如果加载慢，请降低scale_factor。
              </p>
            </div>
          </div>

          <div id="admin-captcha-history-panel_modal" class="hidden space-y-4">
            <div class="flex justify-between items-center">
              <div class="flex items-center gap-3">
                <button id="back-to-captcha-settings-btn" class="p-1 rounded-full hover:bg-slate-100 text-slate-500 transition-colors" title="返回设置">
                  <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                  </svg>
                </button>
                <h4 class="font-semibold text-lg">📜 验证码历史记录</h4>
              </div>
              <div class="flex gap-2 items-center">
                <input type="date" id="captcha-history-date" class="px-3 py-1 border border-slate-300 rounded-md text-sm" value="">
                <select id="captcha-history-status" class="px-3 py-1 border border-slate-300 rounded-md text-sm">
                  <option value="">全部状态</option>
                  <option value="created">待验证</option>
                  <option value="verified_success">验证成功</option>
                  <option value="verified_failed">验证失败</option>
                  <option value="expired">已过期</option>
                  <option value="test_generated">测试生成</option>
                </select>
                <button id="admin-refresh-captcha_modal" class="btn btn-ghost !py-1 !px-2" onclick="loadCaptchaHistory()">
                  刷新
                </button>
              </div>
            </div>

            <div id="admin-captcha-list_modal" class="space-y-2 max-h-[47vh] overflow-y-auto pr-2">
              <p class="text-slate-400 text-center py-10">
                请选择日期并点击刷新按钮查看验证码历史
              </p>
            </div>

            <div id="captcha-stats" class="grid grid-cols-6 gap-2 text-center text-sm">
              <div class="p-2 bg-slate-100 rounded">
                <div class="text-slate-600">总计</div>
                <div id="captcha-stat-total" class="text-lg font-semibold">
                  0
                </div>
              </div>
              <div class="p-2 bg-green-100 rounded">
                <div class="text-green-700">成功</div>
                <div id="captcha-stat-success" class="text-lg font-semibold text-green-700">
                  0
                </div>
              </div>
              <div class="p-2 bg-red-100 rounded">
                <div class="text-red-700">失败</div>
                <div id="captcha-stat-failed" class="text-lg font-semibold text-red-700">
                  0
                </div>
              </div>
              <div class="p-2 bg-yellow-100 rounded">
                <div class="text-yellow-700">待验证</div>
                <div id="captcha-stat-pending" class="text-lg font-semibold text-yellow-700">
                  0
                </div>
              </div>
              <div class="p-2 bg-gray-100 rounded">
                <div class="text-gray-700">已过期</div>
                <div id="captcha-stat-expired" class="text-lg font-semibold text-gray-700">
                  0
                </div>
              </div>
              <div class="p-2 bg-blue-100 rounded">
                <div class="text-blue-700">测试生成</div>
                <div id="captcha-stat-test" class="text-lg font-semibold text-blue-700">
                  0
                </div>
              </div>
            </div>
          </div>

          <div id="admin-reminders-panel_modal" class="hidden space-y-4">
            <div class="flex justify-between items-center">
              <h4 class="font-semibold text-lg">⏰ 定时提醒管理</h4>
              <div class="flex gap-2">
                <button id="admin-refresh-reminders_modal" class="btn btn-ghost !py-1 !px-2" onclick="loadReminders()">
                  刷新
                </button>
                <button id="admin-add-reminder_modal" class="btn btn-primary !py-2 !px-4" onclick="openReminderEditModal()">
                  <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                  </svg>
                  添加提醒
                </button>
              </div>
            </div>

            <p class="text-xs text-blue-700 bg-blue-50 p-3 rounded-md">
              💡 <strong>功能说明：</strong><br>
              • 定时提醒会在设定的时间范围内自动弹出提示<br>
              • 支持跨天时间设置（例如：20:00 到次日 08:00）<br>
              • 禁用的提醒不会显示，但数据会保留<br>
              • 用户打开页面或每分钟检查一次是否有提醒需要显示
            </p>

            <div id="admin-reminders-list_modal" class="space-y-2 max-h-[55vh] overflow-y-auto pr-2">
              <p class="text-slate-400 text-center py-10">
                暂无提醒，点击"添加提醒"创建新提醒
              </p>
            </div>

            <div class="grid grid-cols-3 gap-2 text-center text-sm">
              <div class="p-2 bg-slate-100 rounded">
                <div class="text-slate-600">总计</div>
                <div id="reminder-stat-total" class="text-lg font-semibold">
                  0
                </div>
              </div>
              <div class="p-2 bg-green-100 rounded">
                <div class="text-green-700">启用</div>
                <div id="reminder-stat-enabled" class="text-lg font-semibold text-green-700">
                  0
                </div>
              </div>
              <div class="p-2 bg-slate-100 rounded">
                <div class="text-slate-600">禁用</div>
                <div id="reminder-stat-disabled" class="text-lg font-semibold text-slate-600">
                  0
                </div>
              </div>
            </div>
          </div>

          <div id="admin-ssl-panel_modal" class="hidden space-y-4">
            <div class="flex justify-between items-center">
              <h4 class="font-semibold text-lg">🔒 HTTPS/SSL 设置</h4>
              <div class="flex items-center gap-2"></div>
              <div id="ssl-status-badge" class="px-3 py-1 rounded-full text-sm font-semibold"></div>
              <button id="ssl-refresh-btn" class="btn btn-ghost !py-1 !px-2" onclick="loadSSLInfo()">
                刷新
              </button>
            </div>

            <div class="text-xs text-blue-700 bg-blue-50 p-3 rounded-md">
              💡 <strong>功能说明：</strong><br>
              • 启用HTTPS可以加密客户端与服务器之间的通信，提高安全性<br>
              • 需要上传有效的SSL证书（.pem格式）和私钥文件（.key格式）<br>
              • 修改配置后需要重启服务器才能生效<br>
              • "仅HTTPS"模式会自动将HTTP请求重定向到HTTPS
            </div>

            <div class="space-y-4">
              <div class="flex items-center justify-between p-4 bg-slate-50 rounded-lg">
                <div>
                  <div class="font-semibold text-slate-700">启用 HTTPS</div>
                  <div class="text-xs text-slate-500">使用SSL/TLS加密连接</div>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input type="checkbox" id="ssl-enabled-toggle" class="sr-only peer">
                  <div class="w-11 h-6 bg-slate-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-sky-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-sky-600"></div>
                </label>
              </div>

              <div class="flex items-center justify-between p-4 bg-slate-50 rounded-lg">
                <div>
                  <div class="font-semibold text-slate-700">仅 HTTPS 模式</div>
                  <div class="text-xs text-slate-500">
                    自动重定向HTTP请求到HTTPS
                  </div>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input type="checkbox" id="https-only-toggle" class="sr-only peer">
                  <div class="w-11 h-6 bg-slate-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-sky-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-sky-600"></div>
                </label>
              </div>

              <div id="ssl-cert-info-container" class="p-4 bg-white border border-slate-200 rounded-lg">
                <h5 class="font-semibold text-slate-700 mb-3">📄 证书信息</h5>
                <div id="ssl-cert-info-content" class="space-y-2 text-sm">
                  <p class="text-slate-400 text-center py-4">暂无证书信息</p>
                </div>
              </div>

              <div class="p-4 bg-white border border-slate-200 rounded-lg">
                <h5 class="font-semibold text-slate-700 mb-3">
                  📤 上传SSL证书
                </h5>

                <div class="mb-3">
                  <label class="block text-sm font-medium text-slate-700 mb-2">
                    证书文件 (.pem, .crt)
                  </label>
                  <input type="file" id="ssl-cert-file-input" accept=".pem,.crt" class="block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-sky-50 file:text-sky-700 hover:file:bg-sky-100 cursor-pointer">
                </div>

                <div class="mb-3">
                  <label class="block text-sm font-medium text-slate-700 mb-2">
                    私钥文件 (.key, .pem)
                  </label>
                  <input type="file" id="ssl-key-file-input" accept=".key,.pem" class="block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-sky-50 file:text-sky-700 hover:file:bg-sky-100 cursor-pointer">
                </div>

                <button id="ssl-upload-btn" class="btn btn-primary w-full !py-2" onclick="uploadSSLCertificate()">
                  <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                  </svg>
                  上传证书
                </button>
              </div>

              <div class="flex gap-2">
                <button id="ssl-save-config-btn" class="btn btn-primary flex-1 !py-2" onclick="saveSSLConfig()">
                  <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                  </svg>
                  保存配置
                </button>
              </div>

              <div class="p-3 bg-yellow-50 border border-yellow-200 rounded-lg text-sm text-yellow-800">
                ⚠️
                <strong>重要提示：</strong>修改SSL配置后需要重启服务器才能生效。
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="reminder-edit-modal" class="fixed inset-0 flex items-center justify-center hidden z-[1055]">
      <div class="absolute inset-0 bg-black/70" onclick="closeReminderEditModal()"></div>

      <div class="panel rounded-2xl p-6 w-[90%] max-w-2xl max-h-[85vh] space-y-4 relative overflow-y-auto">
        <div class="flex items-center justify-between">
          <h3 id="reminder-modal-title" class="text-xl font-bold text-sky-600">
            ⏰ 添加定时提醒
          </h3>
          <button onclick="closeReminderEditModal()" class="text-slate-400 hover:text-slate-600 text-2xl leading-none">
            ×
          </button>
        </div>

        <div class="space-y-4">
          <input type="hidden" id="reminder-id-field">

          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-2">
              📌 提醒标题 <span class="text-red-500">*</span>
            </label>
            <input type="text" id="reminder-title-field" class="w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500" placeholder="例如：学校服务器关闭提醒" maxlength="50">
            <p class="text-xs text-slate-500 mt-1">最多50个字符</p>
          </div>

          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-2">
              📝 提醒内容 <span class="text-red-500">*</span>
            </label>
            <textarea id="reminder-message-field" rows="4" class="w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500" placeholder="例如：学校服务器将于20:00关闭，请各位注意时间" maxlength="500"></textarea>
            <p class="text-xs text-slate-500 mt-1">最多500个字符</p>
          </div>

          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-semibold text-slate-700 mb-2">
                ⏰ 开始时间 <span class="text-red-500">*</span>
              </label>
              <input type="time" id="reminder-start-time-field" class="w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500">
              <p class="text-xs text-slate-500 mt-1">24小时制（如 19:00）</p>
            </div>

            <div>
              <label class="block text-sm font-semibold text-slate-700 mb-2">
                ⏰ 结束时间 <span class="text-red-500">*</span>
              </label>
              <input type="time" id="reminder-end-time-field" class="w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500">
              <p class="text-xs text-slate-500 mt-1">24小时制（如 20:00）</p>
            </div>
          </div>

          <div class="bg-blue-50 border-l-4 border-blue-400 p-3 rounded">
            <p class="text-sm text-blue-700">
              💡 <strong>跨天时间说明：</strong><br>
              • 如果结束时间小于开始时间，系统会自动识别为跨天<br>
              • 例如：开始 20:00，结束 08:00 → 表示从晚上20:00到次日早上08:00<br>
              • 正常时间：开始 09:00，结束 17:00 → 表示当天09:00到17:00
            </p>
          </div>

          <div class="flex items-center gap-2">
            <input type="checkbox" id="reminder-enabled-field" class="w-4 h-4 text-sky-600 rounded focus:ring-sky-500" checked="">
            <label for="reminder-enabled-field" class="text-sm font-semibold text-slate-700">
              ✅ 启用此提醒（取消勾选则暂时禁用，不会删除数据）
            </label>
          </div>
        </div>

        <div class="flex gap-3 border-t pt-4">
          <button onclick="closeReminderEditModal()" class="btn btn-ghost flex-1">
            取消
          </button>
          <button onclick="saveReminder()" class="btn btn-primary flex-1">
            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
            保存提醒
          </button>
        </div>
      </div>
    </div>

    <div id="sms-balance-modal" class="fixed inset-0 flex items-center justify-center hidden z-[1055]">
      <div class="absolute inset-0 bg-black/70" onclick="closeSMSBalanceModal()"></div>
      <div class="panel rounded-2xl p-6 w-[90%] max-w-md max-h-[85vh] space-y-4 relative overflow-hidden">
        <div class="flex items-center justify-between">
          <h3 class="text-xl font-bold text-sky-600">💰 短信余额</h3>
          <button onclick="closeSMSBalanceModal()" class="text-slate-400 hover:text-slate-600 text-2xl leading-none">
            ×
          </button>
        </div>

        <div class="space-y-3">
          <div class="text-center">
            <span class="text-sm text-slate-500">剩余条数</span>
            <p id="sms-balance-modal-value" class="text-4xl font-bold text-sky-600">
              --
            </p>
          </div>
          <div class="text-center mt-2">
            <span class="text-sm text-slate-500">今日已发送</span>
            <p id="sms-balance-modal-sent" class="text-2xl font-semibold text-slate-700">
              --
            </p>
          </div>
          <div class="mt-4 text-center">
            <p id="sms-balance-modal-message" class="text-xs text-slate-500 bg-slate-50 p-2 rounded-md">
              查询中...
            </p>
          </div>
        </div>

        <div class="flex justify-end border-t pt-4">
          <button onclick="closeSMSBalanceModal()" class="btn btn-primary w-full">
            关闭
          </button>
        </div>
      </div>
    </div>

    <!-- ========== 短信发送历史 ========== -->
    <div id="sms-history-modal" class="fixed inset-0 flex items-center justify-center hidden z-[1054]">
      <div class="absolute inset-0 bg-black/70" onclick="closeSMSHistoryModal()"></div>
      <div class="panel rounded-2xl p-6 w-[90%] max-w-5xl max-h-[85vh] space-y-4 relative overflow-hidden">
        <div class="flex items-center justify-between">
          <h3 class="text-xl font-bold text-sky-600">📋 短信发送历史</h3>
          <button onclick="closeSMSHistoryModal()" class="text-slate-400 hover:text-slate-600 text-2xl leading-none">
            ×
          </button>
        </div>

        <div class="flex gap-2 items-center">
          <input type="date" id="sms-history-date-filter" class="input-field flex-1" placeholder="按日期过滤">
          <input type="text" id="sms-history-phone-filter" class="input-field flex-1" placeholder="按手机号过滤">
          <button onclick="loadSMSHistory()" class="btn btn-primary whitespace-nowrap">
            🔄 刷新
          </button>
        </div>

        <div id="sms-history-list" class="space-y-2 max-h-[55vh] overflow-y-auto">
          <p class="text-slate-400 text-center py-10">加载中...</p>
        </div>

        <div class="flex justify-end border-t pt-4">
          <button onclick="closeSMSHistoryModal()" class="btn btn-ghost">
            关闭
          </button>
        </div>
      </div>
    </div>

    <!-- ========== 验证码管理 ========== -->
    <div id="verification-codes-modal" class="fixed inset-0 flex items-center justify-center hidden z-[1054]">
      <div class="absolute inset-0 bg-black/70" onclick="closeVerificationCodesModal()"></div>
      <div class="panel rounded-2xl p-6 w-[90%] max-w-4xl max-h-[85vh] space-y-4 relative overflow-hidden">
        <div class="flex items-center justify-between">
          <h3 class="text-xl font-bold text-sky-600">🔑 验证码状态管理</h3>
          <button onclick="closeVerificationCodesModal()" class="text-slate-400 hover:text-slate-600 text-2xl leading-none">
            ×
          </button>
        </div>

        <div class="bg-green-50 border-2 border-green-200 rounded-lg p-4">
          <h5 class="font-semibold mb-3 text-green-900">➕ 手动添加验证码</h5>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
            <div class="phone-input-wrapper">
              <span class="phone-prefix">+86 </span>
              <input type="tel" id="manual-code-phone" class="input-field" placeholder="手机号" pattern="[0-9]*" maxlength="11">
            </div>

            <input type="text" id="manual-code-value" class="input-field" placeholder="验证码（6位数字）" maxlength="6" pattern="[0-9]{6}">
            <button onclick="addManualVerificationCode()" class="btn btn-primary">
              添加验证码
            </button>
          </div>
          <p class="text-xs text-slate-600 mt-2">
            💡 此功能用于测试或紧急情况下手动添加验证码，不会实际发送短信
          </p>
        </div>

        <div class="flex justify-end">
          <button onclick="loadVerificationCodes()" class="btn btn-ghost">
            🔄 刷新列表
          </button>
        </div>

        <div id="verification-codes-list" class="space-y-2 max-h-[45vh] overflow-y-auto">
          <p class="text-slate-400 text-center py-10">加载中...</p>
        </div>

        <div class="flex justify-end border-t pt-4">
          <button onclick="closeVerificationCodesModal()" class="btn btn-ghost">
            关闭
          </button>
        </div>
      </div>
    </div>

    <div id="admin-modify-nickname-modal" class="fixed inset-0 flex items-center justify-center hidden z-[1053]">
      <div class="absolute inset-0 bg-black/60" onclick="closeAdminModifyNicknameModal()"></div>
      <div class="panel rounded-2xl p-6 w-96 space-y-4 relative">
        <div class="flex items-center justify-between">
          <h3 class="text-xl font-bold text-sky-600">修改用户昵称</h3>
          <button onclick="closeAdminModifyNicknameModal()" class="text-slate-400 hover:text-slate-600">
            ×
          </button>
        </div>

        <div class="space-y-3">
          <div>
            <label class="block text-sm font-semibold text-slate-700">用户名</label>
            <input type="text" id="admin-modify-nickname-username" class="input-field mt-1" readonly="">
          </div>

          <div>
            <label class="block text-sm font-semibold text-slate-700">当前昵称</label>
            <input type="text" id="admin-modify-nickname-current" class="input-field mt-1" readonly="">
          </div>

          <div>
            <label class="block text-sm font-semibold text-slate-700">新昵称</label>
            <input type="text" id="admin-modify-nickname-new" class="input-field mt-1" placeholder="请输入新昵称 (可含中文)">
          </div>
        </div>

        <div class="flex justify-end gap-3 pt-4">
          <button onclick="closeAdminModifyNicknameModal()" class="btn btn-ghost border border-slate-300">
            取消
          </button>
          <button onclick="submitAdminModifyNickname()" class="btn btn-primary">
            确认修改
          </button>
        </div>
      </div>
    </div>

    <div id="admin-modify-phone-modal" class="fixed inset-0 flex items-center justify-center hidden z-[1053]">
      <div class="absolute inset-0 bg-black/60" onclick="closeAdminModifyPhoneModal()"></div>
      <div class="panel rounded-2xl p-6 w-96 space-y-4 relative">
        <div class="flex items-center justify-between">
          <h3 class="text-xl font-bold text-sky-600">修改用户手机号</h3>
          <button onclick="closeAdminModifyPhoneModal()" class="text-slate-400 hover:text-slate-600">
            ×
          </button>
        </div>

        <div class="space-y-3">
          <div>
            <label class="block text-sm font-semibold text-slate-700">用户名</label>
            <input type="text" id="admin-modify-phone-username" class="input-field mt-1" readonly="">
          </div>

          <div>
            <label class="block text-sm font-semibold text-slate-700">当前手机号</label>
            <div class="phone-input-wrapper mt-1">
              <span class="phone-prefix">+86 </span>
              <input type="tel" id="admin-modify-phone-current" class="input-field" readonly="">
            </div>
          </div>

          <div>
            <label class="block text-sm font-semibold text-slate-700">新手机号</label>
            <div class="phone-input-wrapper mt-1">
              <span class="phone-prefix">+86 </span>
              <input type="tel" id="admin-modify-phone-new" class="input-field" placeholder="请输入新手机号" inputmode="numeric" pattern="[0-9]*" maxlength="11">
            </div>
          </div>

          <div id="admin-modify-phone-sms-group">
            <label class="block text-sm font-semibold text-slate-700">验证码（可选）</label>
            <div class="flex gap-2 mt-1">
              <input type="text" id="admin-modify-phone-code" class="input-field flex-1" placeholder="验证码" maxlength="6" inputmode="numeric" pattern="[0-9]{6}">
              <button onclick="sendAdminModifyPhoneCode()" id="admin-modify-phone-send-btn" class="btn btn-primary whitespace-nowrap">
                发送验证码
              </button>
            </div>
            <p class="text-xs text-slate-500 mt-1" id="admin-modify-phone-sms-hint">
              管理员修改手机号不强制要求验证码，如填写将进行校验
            </p>
          </div>
        </div>

        <div class="flex justify-end gap-3 pt-4">
          <button onclick="closeAdminModifyPhoneModal()" class="btn btn-ghost border border-slate-300">
            取消
          </button>
          <button onclick="submitAdminModifyPhone()" class="btn btn-primary">
            确认修改
          </button>
        </div>
      </div>
    </div>

    <div id="user-logs-secondary-modal" class="fixed inset-0 flex items-center justify-center hidden z-[1053]">
      <div class="absolute inset-0 bg-black/60" onclick="closeUserLogsSecondaryModal()"></div>
      <div class="panel rounded-2xl p-6 w-[50rem] max-h-[81vh] space-y-4 relative overflow-y-auto">
        <div class="flex items-center justify-between">
          <h3 class="text-xl font-bold text-sky-600">用户日志查看</h3>
          <button onclick="closeUserLogsSecondaryModal()" class="text-slate-400 hover:text-slate-600 text-2xl leading-none">
            ×
          </button>
        </div>

        <div class="bg-sky-50 border border-sky-200 rounded-lg p-3">
          <p class="text-sm text-slate-700">
            当前查看用户:
            <span id="current-log-username-secondary" class="font-semibold text-sky-600">N/A</span>
          </p>
        </div>

        <div class="flex border-b border-slate-200">
          <button id="log-tab-login-secondary" class="px-4 py-2 font-semibold text-sky-600 border-b-2 border-sky-600" onclick="switchUserLogTab('login')">
            登录记录
          </button>
          <button id="log-tab-audit-secondary" class="px-4 py-2 font-semibold text-slate-400 border-b-2 border-transparent" onclick="switchUserLogTab('audit')">
            操作记录
          </button>
        </div>

        <div id="log-login-content-secondary" class="space-y-2 max-h-[50vh] overflow-y-auto">
          <p class="text-slate-400 text-center py-10">加载中...</p>
        </div>

        <div id="log-audit-content-secondary" class="hidden space-y-2 max-h-[50vh] overflow-y-auto">
          <p class="text-slate-400 text-center py-10">加载中...</p>
        </div>

        <div class="flex justify-end">
          <button onclick="closeUserLogsSecondaryModal()" class="btn btn-ghost">
            关闭
          </button>
        </div>
      </div>
    </div>

    <div id="confirm-modal" class="fixed inset-0 flex items-center justify-center hidden z-[50000]">
      <div class="absolute inset-0 bg-black/60"></div>
      <div class="panel rounded-2xl p-6 w-11/12 md:w-96 space-y-6 relative">
        <h3 id="confirm-modal-title" class="text-xl font-bold text-amber-600 text-center">
          请确认
        </h3>
        <p id="confirm-modal-message" class="text-sm text-slate-600 text-center py-4">
          你确定要执行此操作吗？
        </p>
        <div class="flex justify-end gap-3 pt-4">
          <button id="confirm-modal-cancel-btn" class="btn btn-ghost border border-slate-300">
            取消
          </button>
          <button id="confirm-modal-ok-btn" class="btn btn-primary">
            确认
          </button>
        </div>
      </div>
    </div>

    <div id="session-picker-modal" class="fixed inset-0 flex items-center justify-center hidden z-[1052]">
      <div class="absolute inset-0 bg-black/60"></div>
      <div class="panel rounded-2xl p-6 w-[40rem] max-h-[70vh] space-y-4 relative">
        <div class="flex items-center justify-between">
          <h3 class="text-xl font-bold text-sky-600">会话管理</h3>
          <div id="session-count-display" class="text-sm text-slate-600"></div>
        </div>

        <div class="bg-sky-50 border border-sky-200 rounded-lg p-3">
          <p class="text-sm text-slate-700 mb-2">选择现有会话或创建新会话</p>
          <button class="btn btn-primary w-full" onclick="createNewSessionFromPicker()">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
            </svg>
            创建新会话
          </button>
        </div>

        <div class="space-y-2">
          <div class="flex justify-between items-center">
            <h4 class="font-semibold text-slate-700">现有会话</h4>
            <button class="btn btn-ghost !py-1 !px-2" onclick="refreshSessionPicker()">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
              </svg>
              刷新
            </button>
          </div>
          <div id="session-picker-list" class="max-h-[40vh] overflow-y-auto space-y-2">
            <p class="text-slate-400 text-center py-10">加载中...</p>
          </div>
        </div>

        <div class="border-t pt-3 text-xs text-slate-500 relative">
          <p>
            💡
            提示：每个会话都是独立的学校账号登录状态。您可以创建多个会话来管理不同的账号。
          </p>
        </div>
      </div>
    </div>

    <div id="sms-test-modal" class="fixed inset-0 flex items-center justify-center hidden z-[1054]">
      <div class="absolute inset-0 bg-black/60" onclick="closeSMSTestModal()"></div>
      <div class="panel rounded-2xl p-6 w-[35rem] space-y-4 relative">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-xl font-bold text-green-600">🧪 短信测试发送</h3>
          <button onclick="closeSMSTestModal()" class="text-slate-400 hover:text-slate-600 transition-colors">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>

        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
          <p class="text-sm text-blue-800">
            <strong>💡 功能说明：</strong><br>
            • 此功能用于测试短信配置是否正确<br>
            • 可以发送随机验证码，或指定特定的验证码进行测试<br>
            • 验证码将同时显示在界面上，便于您验证短信是否收到<br>
            • 测试记录会保存在短信发送历史中
          </p>
        </div>

        <div class="space-y-2">
          <label class="block text-sm font-semibold text-slate-700">
            <span class="inline-flex items-center gap-1"> 📱 目标手机号 </span>
          </label>
          <input type="tel" id="sms-test-phone" class="w-full border-2 border-green-200 rounded-lg px-4 py-3 focus:border-green-400 focus:ring-2 focus:ring-green-200 transition-all text-lg" placeholder="请输入要测试的手机号（11位）" maxlength="11" inputmode="numeric" pattern="[0-9]*">
          <p class="text-xs text-slate-500">
            ⚠️ 请输入真实有效的手机号，确保能收到短信
          </p>
        </div>

        <div class="space-y-2">
          <label class="block text-sm font-semibold text-slate-700">
            <span class="inline-flex items-center gap-1">
              🔢 验证码（可选）
            </span>
          </label>
          <input type="text" id="sms-test-code-input" class="w-full border-2 border-blue-200 rounded-lg px-4 py-3 focus:border-blue-400 focus:ring-2 focus:ring-blue-200 transition-all text-lg font-mono" placeholder="留空则自动生成随机验证码" maxlength="8" inputmode="numeric">
          <p class="text-xs text-slate-500">
            💡 可输入4-8位数字作为测试验证码，留空则自动生成6位随机验证码
          </p>
        </div>

        <div id="sms-test-result" class="hidden">
          <div class="bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-300 rounded-lg p-4">
            <div class="flex items-start gap-3">
              <div class="text-3xl">✅</div>
              <div class="flex-1">
                <div class="font-semibold text-green-800 mb-2">
                  测试短信发送成功！
                </div>
                <div class="space-y-1 text-sm text-slate-700">
                  <div class="flex items-center gap-2">
                    <span class="font-medium">验证码：</span>
                    <span id="sms-test-code" class="font-mono text-2xl font-bold text-green-600">------</span>
                  </div>
                  <div class="flex items-center gap-2">
                    <span class="font-medium">手机号：</span>
                    <span id="sms-test-phone-display" class="font-mono">-----------</span>
                  </div>
                </div>
                <div class="mt-3 text-xs text-slate-600 bg-white/50 p-2 rounded">
                  💡
                  请检查手机是否收到包含上述验证码的短信。如果收到，说明短信配置正确。
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="flex gap-3 pt-3 border-t">
          <button onclick="closeSMSTestModal()" class="flex-1 btn btn-ghost min-h-[44px]">
            取消
          </button>
          <button id="btn-send-test-sms" onclick="sendTestSMS()" class="flex-1 btn btn-success min-h-[44px]">
            <svg class="w-5 h-5 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
            </svg>
            发送测试短信
          </button>
        </div>

        <div class="text-xs text-slate-500 text-center pt-2 border-t">
          测试记录会自动保存到"短信发送历史"中，场景标记为"admin_test"
        </div>
      </div>
    </div>

    <div id="captcha-detail-modal" class="fixed inset-0 flex items-center justify-center hidden z-[1054]">
      <div class="absolute inset-0 bg-black/60" onclick="closeCaptchaDetailModal()"></div>
      <div class="panel rounded-2xl p-6 w-[40rem] max-h-[80vh] overflow-y-auto space-y-4 relative">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-xl font-bold text-blue-600">🔍 验证码详细信息</h3>
          <button onclick="closeCaptchaDetailModal()" class="text-slate-400 hover:text-slate-600 transition-colors">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>

        <div id="captcha-detail-content" class="space-y-4">
          <div class="bg-gradient-to-br from-blue-50 to-cyan-50 border-2 border-blue-200 rounded-lg p-4">
            <h4 class="font-semibold text-blue-900 mb-3 flex items-center gap-2">
              <span class="text-xl">📋</span>
              基本信息
            </h4>
            <div class="space-y-2 text-sm">
              <div class="flex">
                <span class="text-slate-600 w-24">验证码ID:</span>
                <span id="detail-captcha-id" class="font-mono text-slate-800 flex-1 break-all">-</span>
              </div>
              <div class="flex">
                <span class="text-slate-600 w-24">验证码:</span>
                <span id="detail-code" class="font-mono text-2xl font-bold text-blue-600">-</span>
              </div>
              <div class="flex">
                <span class="text-slate-600 w-24">状态:</span>
                <span id="detail-status" class="px-2 py-1 text-xs rounded">-</span>
              </div>
            </div>
          </div>

          <div class="bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-lg p-4">
            <h4 class="font-semibold text-green-900 mb-3 flex items-center gap-2">
              <span class="text-xl">⏰</span>
              时间信息
            </h4>
            <div class="space-y-2 text-sm">
              <div class="flex">
                <span class="text-slate-600 w-24">创建时间:</span>
                <span id="detail-created-time" class="text-slate-800">-</span>
              </div>
              <div id="detail-verified-time-container" class="flex hidden">
                <span class="text-slate-600 w-24">验证时间:</span>
                <span id="detail-verified-time" class="text-slate-800">-</span>
              </div>
              <div id="detail-expired-time-container" class="flex hidden">
                <span class="text-slate-600 w-24">过期时间:</span>
                <span id="detail-expired-time" class="text-slate-800">-</span>
              </div>
            </div>
          </div>

          <div id="detail-verification-card" class="hidden bg-gradient-to-br from-purple-50 to-pink-50 border-2 border-purple-200 rounded-lg p-4">
            <h4 class="font-semibold text-purple-900 mb-3 flex items-center gap-2">
              <span class="text-xl">✅</span>
              验证信息
            </h4>
            <div class="space-y-2 text-sm">
              <div class="flex">
                <span class="text-slate-600 w-24">用户输入:</span>
                <span id="detail-user-input" class="font-mono font-bold">-</span>
              </div>
              <div class="flex">
                <span class="text-slate-600 w-24">验证结果:</span>
                <span id="detail-verification-result">-</span>
              </div>
            </div>
          </div>

          <div class="bg-gradient-to-br from-orange-50 to-amber-50 border-2 border-orange-200 rounded-lg p-4">
            <h4 class="font-semibold text-orange-900 mb-3 flex items-center gap-2">
              <span class="text-xl">🌐</span>
              客户端信息
            </h4>
            <div class="space-y-2 text-sm">
              <div class="flex">
                <span class="text-slate-600 w-24">IP地址:</span>
                <span id="detail-client-ip" class="font-mono text-slate-800">-</span>
              </div>
              <div class="flex flex-col">
                <span class="text-slate-600 mb-1">User Agent:</span>
                <span id="detail-user-agent" class="text-xs text-slate-600 font-mono bg-white p-2 rounded break-all">-</span>
              </div>
            </div>
          </div>

          <div id="detail-captcha-image-card" class="hidden bg-gradient-to-br from-slate-50 to-gray-50 border-2 border-slate-200 rounded-lg p-4">
            <h4 class="font-semibold text-slate-900 mb-3 flex items-center gap-2">
              <span class="text-xl">🖼️</span>
              验证码图片
            </h4>
            <div id="detail-captcha-html" class="flex items-center justify-center bg-white p-4 rounded-lg border border-slate-200"></div>
          </div>
        </div>

        <div class="pt-4 border-t">
          <button onclick="closeCaptchaDetailModal()" class="w-full btn btn-ghost min-h-[44px]">
            关闭
          </button>
        </div>
      </div>
    </div>

    <div id="create-group-modal" class="fixed inset-0 flex items-center justify-center hidden z-[1054]">
      <div class="absolute inset-0 bg-black/60" onclick="closeCreateGroupModal()"></div>
      <div class="panel rounded-2xl p-6 w-full max-w-[50rem] mx-4 space-y-4 relative max-h-[90vh] overflow-y-auto">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-xl font-bold text-sky-600">创建权限组</h3>
          <button onclick="closeCreateGroupModal()" class="btn btn-ghost !py-1 !px-3">
            关闭
          </button>
        </div>

        <div class="space-y-3">
          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-1">权限组键名</label>
            <input type="text" id="new-group-key" class="input-field w-full" placeholder="例如: custom_group">
            <p class="text-xs text-slate-500 mt-1">
              英文字母、数字、下划线，用于内部标识
            </p>
          </div>
          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-1">权限组名称</label>
            <input type="text" id="new-group-name" class="input-field w-full" placeholder="例如: 自定义权限组">
            <p class="text-xs text-slate-500 mt-1">显示名称，用于界面展示</p>
          </div>
          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-2">权限设置</label>
            <div id="create-group-permissions" class="grid grid-cols-2 gap-2 max-h-[40vh] overflow-y-auto border border-slate-200 rounded-lg p-3"></div>
          </div>
        </div>

        <div class="flex justify-end gap-3 pt-4 border-t">
          <button onclick="closeCreateGroupModal()" class="btn btn-ghost border border-slate-300">
            取消
          </button>
          <button onclick="submitCreateGroup()" class="btn btn-primary">
            创建
          </button>
        </div>
      </div>
    </div>

    <div id="edit-group-permissions-modal" class="fixed inset-0 flex items-center justify-center hidden z-[1054]">
      <div class="absolute inset-0 bg-black/60" onclick="closeEditGroupPermissionsModal()"></div>
      <div class="panel rounded-2xl p-6 w-full max-w-[50rem] mx-4 max-h-[80vh] overflow-y-auto space-y-4 relative">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-xl font-bold text-sky-600">
            编辑权限组: <span id="edit-group-name"></span>
          </h3>
          <button onclick="closeEditGroupPermissionsModal()" class="btn btn-ghost !py-1 !px-3">
            关闭
          </button>
        </div>

        <div class="space-y-3">
          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-2">权限设置</label>
            <div id="edit-group-permissions-list" class="grid grid-cols-2 gap-2 max-h-[50vh] overflow-y-auto border border-slate-200 rounded-lg p-3"></div>
          </div>
        </div>

        <div class="flex justify-end gap-3 pt-4 border-t">
          <button onclick="closeEditGroupPermissionsModal()" class="btn btn-ghost border border-slate-300">
            取消
          </button>
          <button onclick="submitEditGroupPermissions()" class="btn btn-primary">
            保存
          </button>
        </div>
      </div>
    </div>

    <div id="manage-user-permissions-modal" class="fixed inset-0 flex items-center justify-center hidden z-[1054]">
      <div class="absolute inset-0 bg-black/60" onclick="closeManageUserPermissionsModal()"></div>
      <div class="panel rounded-2xl p-6 w-full max-w-[50rem] mx-4 max-h-[80vh] overflow-y-auto space-y-4 relative">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-xl font-bold text-sky-600">
            管理用户权限: <span id="manage-user-name"></span>
          </h3>
          <button onclick="closeManageUserPermissionsModal()" class="btn btn-ghost !py-1 !px-3">
            关闭
          </button>
        </div>

        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4">
          <p class="text-sm text-blue-700">
            <strong>权限组:</strong>
            <span id="user-base-group" class="font-mono"></span>
          </p>
          <p class="text-xs text-slate-600 mt-1">
            💡
            以下为用户相对于权限组的差分化权限。绿色表示额外添加的权限，红色表示移除的权限。
          </p>
        </div>

        <div class="space-y-3">
          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-2">权限调整</label>
            <div id="manage-user-permissions-list" class="grid grid-cols-2 gap-2 max-h-[50vh] overflow-y-auto border border-slate-200 rounded-lg p-3"></div>
          </div>
        </div>

        <div class="flex justify-end gap-3 pt-4 border-t">
          <button onclick="closeManageUserPermissionsModal()" class="btn btn-ghost border border-slate-300">
            取消
          </button>
          <button onclick="submitManageUserPermissions()" class="btn btn-primary">
            保存
          </button>
        </div>
      </div>
    </div>

    <div id="manage-school-accounts-modal" class="fixed inset-0 flex items-center justify-center hidden z-[1054]">
      <div class="absolute inset-0 bg-black/60" onclick="closeManageSchoolAccountsModal()"></div>

      <div class="panel rounded-2xl p-6 w-full max-w-[50rem] mx-4 max-h-[80vh] overflow-y-auto space-y-4 relative">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-xl font-bold text-sky-600">
            管理学校账户:
            <span id="school-accounts-username" class="text-slate-700"></span>
          </h3>
          <button onclick="closeManageSchoolAccountsModal()" class="btn btn-ghost !py-1 !px-3">
            关闭
          </button>
        </div>

        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-sm text-blue-700">
                <strong>账户总数:</strong>
                <span id="school-accounts-count" class="font-mono">0</span>
              </p>
              <p class="text-xs text-slate-600 mt-1">
                💡 您可以查看、编辑或删除此用户的学校账户信息
              </p>
            </div>
            <button onclick="addNewSchoolAccount()" class="btn btn-primary !py-2 !px-4 !text-sm flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
              </svg>
              新增账户
            </button>
          </div>
        </div>

        <div id="school-accounts-list" class="space-y-3 max-h-[50vh] overflow-y-auto"></div>

        <div class="flex justify-end gap-3 pt-4 border-t">
          <button onclick="closeManageSchoolAccountsModal()" class="btn btn-ghost border border-slate-300">
            关闭
          </button>
        </div>
      </div>
    </div>

    <div id="edit-school-account-modal" class="fixed inset-0 flex items-center justify-center hidden z-[1055]">
      <div class="absolute inset-0 bg-black/60" onclick="closeEditSchoolAccountModal()"></div>

      <div class="panel rounded-2xl p-6 w-96 space-y-4 relative">
        <h3 class="text-xl font-bold text-amber-600">编辑学校账户</h3>

        <div class="space-y-2">
          <p class="text-sm text-slate-600">
            认证用户:
            <span id="edit-auth-username" class="font-semibold text-slate-800"></span>
          </p>
          <p class="text-sm text-slate-600">
            学校账户:
            <span id="edit-school-username" class="font-semibold text-slate-800"></span>
          </p>
        </div>

        <div class="space-y-3">
          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-1">密码</label>
            <input type="text" id="edit-school-password" class="input-field" placeholder="输入新密码">
          </div>
          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-1">User-Agent（可选）</label>
            <textarea id="edit-school-ua" class="input-field" rows="3" placeholder="输入User-Agent（可选）"></textarea>
          </div>
        </div>

        <div class="flex justify-end gap-3 pt-4 border-t">
          <button onclick="closeEditSchoolAccountModal()" class="btn btn-ghost border border-slate-300">
            取消
          </button>
          <button onclick="submitEditSchoolAccount()" class="btn btn-primary">
            保存
          </button>
        </div>
      </div>
    </div>

    <div id="set-max-sessions-modal" class="fixed inset-0 flex items-center justify-center hidden z-[1054]">
      <div class="absolute inset-0 bg-black/60" onclick="hideModal('set-max-sessions-modal')"></div>
      <div class="panel rounded-2xl p-6 w-96 space-y-4 relative">
        <h3 class="text-xl font-bold text-sky-600">设置会话限制</h3>

        <div class="space-y-2">
          <p class="text-sm text-slate-600">
            用户:
            <span id="sessions-username" class="font-semibold text-slate-800"></span>
          </p>
          <p class="text-sm text-slate-600">
            当前限制:
            <span id="sessions-current-max" class="font-semibold text-slate-800"></span>
          </p>
        </div>

        <div>
          <label class="block text-sm font-semibold text-slate-700 mb-1">新会话限制</label>
          <input type="number" id="new-max-sessions" min="0" class="input-field" placeholder="输入会话数量">
          <p class="text-xs text-slate-500 mt-1">0 = 无限制</p>
        </div>

        <div class="flex justify-end gap-3 pt-4 border-t">
          <button onclick="hideModal('set-max-sessions-modal')" class="btn btn-ghost border border-slate-300">
            取消
          </button>
          <button onclick="submitSetMaxSessions()" class="btn btn-primary">
            确认
          </button>
        </div>
      </div>
    </div>

    <div id="reset-user-password-modal" class="fixed inset-0 flex items-center justify-center hidden z-[1054]">
      <div class="absolute inset-0 bg-black/60" onclick="hideModal('reset-user-password-modal')"></div>
      <div class="panel rounded-2xl p-6 w-96 space-y-4 relative">
        <h3 class="text-xl font-bold text-amber-600">重置用户密码</h3>

        <div>
          <p class="text-sm text-slate-600">
            目标用户:
            <span id="reset-password-username" class="font-semibold text-slate-800"></span>
          </p>
        </div>

        <div class="space-y-3">
          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-1">新密码</label>
            <input type="password" id="reset-new-password" class="input-field" placeholder="输入新密码">
          </div>
          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-1">确认密码</label>
            <input type="password" id="reset-confirm-password" class="input-field" placeholder="再次输入新密码">
          </div>
        </div>

        <div class="flex justify-end gap-3 pt-4 border-t">
          <button onclick="hideModal('reset-user-password-modal')" class="btn btn-ghost border border-slate-300">
            取消
          </button>
          <button onclick="submitResetUserPassword()" class="btn btn-primary">
            重置密码
          </button>
        </div>
      </div>
    </div>

    <div id="avatar-crop-modal" class="fixed inset-0 flex items-center justify-center hidden z-[1055]">
      <div class="absolute inset-0 bg-black/80" onclick="closeCropModal()"></div>
      <div class="panel rounded-2xl p-6 max-w-2xl w-full mx-4 space-y-4 relative">
        <h3 class="text-xl font-bold text-sky-600">裁剪头像</h3>

        <div class="max-h-96 overflow-hidden bg-slate-100 rounded-lg">
          <img id="crop-image" src="" alt="待裁剪图片" style="max-width: 100%">
        </div>

        <div class="flex gap-2 justify-end">
          <button onclick="closeCropModal()" class="btn btn-ghost border border-slate-300">
            取消
          </button>
          <button onclick="confirmCropAndUpload()" class="btn btn-primary">
            确认并上传
          </button>
        </div>
      </div>
    </div>
    <div id="modify-phone-modal" class="modal">
      <div class="modal-content" style="max-width: 500px">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-bold text-slate-800">修改绑定手机号</h3>
          <button onclick="closeModifyPhoneModal()" class="text-slate-400 hover:text-slate-600">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>

        <div class="space-y-4">
          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-2">当前手机号</label>
            <div class="phone-input-wrapper">
              <span class="phone-prefix">+86 </span>
              <input type="tel" id="modify-phone-current" class="input-field" readonly="">
            </div>
          </div>
          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-2">验证原密码 <span class="text-red-500">*</span></label>
            <input type="password" id="modify-phone-password" class="input-field w-full" placeholder="请输入当前账号密码进行验证" style="min-height: 44px">
          </div>
          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-2">新手机号</label>
            <div class="phone-input-wrapper">
              <span class="phone-prefix">+86 </span>
              <input type="tel" id="modify-phone-new" class="input-field" placeholder="请输入新手机号" inputmode="numeric" pattern="[0-9]*" style="min-height: 44px" maxlength="11">
            </div>
          </div>

          <div>
            <label class="block text-sm font-semibold text-slate-700 mb-2">短信验证码</label>
            <div class="flex gap-2">
              <input type="text" id="modify-phone-code" class="input-field flex-1" placeholder="请输入验证码" maxlength="6" inputmode="numeric" pattern="[0-9]{6}" style="min-height: 44px">
              <button onclick="sendModifyPhoneCode()" id="modify-phone-send-btn" class="btn btn-primary whitespace-nowrap" style="min-height: 44px">
                发送验证码
              </button>
            </div>
          </div>

          <div class="flex gap-3 pt-4">
            <button onclick="confirmModifyPhone()" class="btn btn-success flex-1" style="min-height: 44px">
              确认修改
            </button>
            <button onclick="closeModifyPhoneModal()" class="btn btn-ghost flex-1" style="min-height: 44px">
              取消
            </button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Extracted Script -->
    <script src="scripts/main.js" defer=""></script>
</body>
</html>