# 定时提醒功能使用说明

## 功能简介

定时提醒功能允许管理员设置在特定时间段自动弹出的提醒消息，用于通知用户重要信息（如服务器维护、系统关闭等）。

## 主要特性

### 1. 时间段设置
- 支持设置开始时间和结束时间（HH:MM格式，24小时制）
- **支持跨天时间段**：例如20:00到次日08:00
- 自动识别跨天情况，无需额外配置

### 2. 提醒管理
- **添加提醒**：设置标题、内容、时间范围
- **编辑提醒**：修改现有提醒的任何属性
- **启用/禁用**：临时关闭提醒而不删除数据
- **删除提醒**：永久删除提醒（需确认）

### 3. 自动显示
- 页面加载时立即检查是否有提醒需要显示
- 每分钟自动检查一次
- 使用SweetAlert2美观的模态框显示
- 防止重复显示同一提醒（已显示的不会再次弹出）

## 使用步骤

### 管理员操作

#### 1. 进入管理面板
1. 使用管理员账号登录系统
2. 点击顶部导航栏的"管理"按钮
3. 在管理面板中点击"定时提醒"标签页

#### 2. 添加新提醒
1. 点击"添加提醒"按钮
2. 填写表单：
   - **提醒标题**：简短描述（最多50字符）
   - **提醒内容**：详细信息（最多500字符）
   - **开始时间**：提醒开始显示的时间
   - **结束时间**：提醒停止显示的时间
   - **启用状态**：是否立即启用
3. 点击"保存提醒"按钮

#### 3. 编辑提醒
1. 在提醒列表中找到要编辑的提醒
2. 点击"编辑"按钮
3. 修改需要更改的字段
4. 点击"保存提醒"按钮

#### 4. 启用/禁用提醒
1. 在提醒列表中找到目标提醒
2. 点击"启用"或"禁用"按钮
3. 提醒状态会立即更新

#### 5. 删除提醒
1. 在提醒列表中找到要删除的提醒
2. 点击"删除"按钮
3. 在确认对话框中点击"确认删除"

### 用户体验

- 当用户打开页面时，系统会自动检查当前时间是否有提醒需要显示
- 如果有提醒，会弹出美观的提示框
- 用户点击"知道了"按钮关闭提示框
- 已显示过的提醒不会在同一会话中重复显示

## 配置示例

### 示例1：服务器关闭预警
```
标题：学校服务器关闭提醒
内容：学校服务器将于20:00关闭，请各位注意时间
开始时间：19:00
结束时间：20:00
状态：启用
```
**说明**：在19:00到20:00之间，打开页面就会看到提醒

### 示例2：服务器维护通知（跨天）
```
标题：服务器维护通知
内容：学校服务器按照预期应于20:00关闭，如果出现错误，请在学校服务器运行时间使用。
开始时间：20:00
结束时间：08:00
状态：启用
```
**说明**：从晚上20:00到次日早上08:00，打开页面会看到提醒（跨天）

## 技术细节

### 时间范围判断逻辑

#### 正常时间段（不跨天）
- 条件：开始时间 < 结束时间
- 示例：09:00 - 17:00
- 判断：当前时间 >= 开始时间 且 当前时间 < 结束时间

#### 跨天时间段
- 条件：开始时间 > 结束时间
- 示例：20:00 - 08:00
- 判断：当前时间 >= 开始时间 或 当前时间 < 结束时间

### 数据存储

提醒数据存储在项目根目录的 `reminders.json` 文件中，格式如下：

```json
{
  "reminders": [
    {
      "id": "唯一ID（UUID）",
      "title": "提醒标题",
      "message": "提醒内容",
      "start_time": "19:00",
      "end_time": "20:00",
      "enabled": true,
      "created_at": 1700000000,
      "updated_at": 1700000000
    }
  ]
}
```

### API接口

- `GET /api/reminders/list` - 获取所有提醒（需要管理员权限）
- `POST /api/reminders/add` - 添加新提醒（需要管理员权限）
- `POST /api/reminders/update` - 更新提醒（需要管理员权限）
- `POST /api/reminders/delete` - 删除提醒（需要管理员权限）
- `GET /api/reminders/check` - 检查当前需要显示的提醒（所有用户）

## 安全性

- **权限控制**：只有拥有 `view_logs` 权限的管理员可以管理提醒
- **输入验证**：
  - 标题长度限制：50字符
  - 内容长度限制：500字符
  - 时间格式验证：必须为HH:MM格式
- **XSS防护**：所有用户输入在显示前都经过HTML转义处理

## 注意事项

1. **权限要求**：只有管理员可以管理提醒，普通用户和游客只能看到提醒
2. **时间格式**：必须使用24小时制（HH:MM），例如：09:00、13:30、23:59
3. **跨天识别**：系统自动识别跨天情况，无需特殊设置
4. **防重复显示**：同一提醒在当前浏览器会话中只显示一次
5. **定时检查**：提醒每分钟检查一次，最多有1分钟延迟
6. **数据备份**：建议定期备份 `reminders.json` 文件

## 故障排除

### 提醒没有显示
1. 检查提醒是否启用（enabled = true）
2. 检查当前时间是否在设置的时间范围内
3. 检查浏览器控制台是否有JavaScript错误
4. 刷新页面重新触发检查

### 无法添加/编辑提醒
1. 确认已使用管理员账号登录
2. 检查输入的时间格式是否正确（HH:MM）
3. 检查标题和内容是否超过长度限制

### 跨天提醒不工作
1. 确认开始时间大于结束时间（例如：20:00 > 08:00）
2. 系统会自动识别为跨天，无需额外设置

## 更新日志

### v1.0.0 (2024-11-16)
- ✅ 初始版本发布
- ✅ 支持基本的增删改查功能
- ✅ 支持跨天时间段
- ✅ 自动检查和显示功能
- ✅ 权限控制和安全验证
- ✅ 完整的中文注释和文档
